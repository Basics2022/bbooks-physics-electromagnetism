%% Generated by Sphinx.
\def\sphinxdocclass{jupyterBook}
\documentclass[letterpaper,10pt,english]{jupyterBook}
\ifdefined\pdfpxdimen
   \let\sphinxpxdimen\pdfpxdimen\else\newdimen\sphinxpxdimen
\fi \sphinxpxdimen=.75bp\relax
\ifdefined\pdfimageresolution
    \pdfimageresolution= \numexpr \dimexpr1in\relax/\sphinxpxdimen\relax
\fi
%% let collapsible pdf bookmarks panel have high depth per default
\PassOptionsToPackage{bookmarksdepth=5}{hyperref}
%% turn off hyperref patch of \index as sphinx.xdy xindy module takes care of
%% suitable \hyperpage mark-up, working around hyperref-xindy incompatibility
\PassOptionsToPackage{hyperindex=false}{hyperref}
%% memoir class requires extra handling
\makeatletter\@ifclassloaded{memoir}
{\ifdefined\memhyperindexfalse\memhyperindexfalse\fi}{}\makeatother

\PassOptionsToPackage{warn}{textcomp}

\catcode`^^^^00a0\active\protected\def^^^^00a0{\leavevmode\nobreak\ }
\usepackage{cmap}
\usepackage{fontspec}
\defaultfontfeatures[\rmfamily,\sffamily,\ttfamily]{}
\usepackage{amsmath,amssymb,amstext}
\usepackage{polyglossia}
\setmainlanguage{english}



\setmainfont{FreeSerif}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Italic,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldItalic
]
\setsansfont{FreeSans}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]
\setmonofont{FreeMono}[
  Extension      = .otf,
  UprightFont    = *,
  ItalicFont     = *Oblique,
  BoldFont       = *Bold,
  BoldItalicFont = *BoldOblique,
]



\usepackage[Bjarne]{fncychap}
\usepackage[,numfigreset=1,mathnumfig]{sphinx}

\fvset{fontsize=\small}
\usepackage{geometry}


% Include hyperref last.
\usepackage{hyperref}
% Fix anchor placement for figures with captions.
\usepackage{hypcap}% it must be loaded after hyperref.
% Set up styles of URL: it should be placed after hyperref.
\urlstyle{same}

\addto\captionsenglish{\renewcommand{\contentsname}{Electromagnetism}}

\usepackage{sphinxmessages}



        % Start of preamble defined in sphinx-jupyterbook-latex %
         \usepackage[Latin,Greek]{ucharclasses}
        \usepackage{unicode-math}
        % fixing title of the toc
        \addto\captionsenglish{\renewcommand{\contentsname}{Contents}}
        \hypersetup{
            pdfencoding=auto,
            psdextra
        }
        % End of preamble defined in sphinx-jupyterbook-latex %
        

\title{electromagnetism}
\date{Apr 28, 2025}
\release{}
\author{basics}
\newcommand{\sphinxlogo}{\vbox{}}
\renewcommand{\releasename}{}
\makeindex
\begin{document}

\pagestyle{empty}
\sphinxmaketitle
\pagestyle{plain}
\sphinxtableofcontents
\pagestyle{normal}
\phantomsection\label{\detokenize{intro::doc}}


\sphinxAtStartPar
This material is part of the \sphinxhref{https://basics2022.github.io/bbooks}{\sphinxstylestrong{basics\sphinxhyphen{}books project}}. It is also available as a \DUrole{xref,download,myst}{.pdf document}.
\subsubsection*{Classical electromagnetism}

\sphinxAtStartPar
{\hyperref[\detokenize{ch/experiments:classical-electromagnetism-first-experiments}]{\sphinxcrossref{\DUrole{std,std-ref}{\sphinxstylestrong{Brief history of electromagnetism}}}}}. \sphinxstylestrong{todo}

\sphinxAtStartPar
{\hyperref[\detokenize{ch/principles:classical-electromagnetism-principles}]{\sphinxcrossref{\DUrole{std,std-ref}{\sphinxstylestrong{Principles of classical electromagnetism}}}}}. Principles of electromagnetism (charge conservation, Lorentz’s force and Maxwell’s equations) are first introduced for {\hyperref[\detokenize{ch/principles-vacuum:classical-electromagnetism-principles-free-space}]{\sphinxcrossref{\DUrole{std,std-ref}{electromagentic phenomena in free\sphinxhyphen{}space}}}}, in both differential and integral form. Then, equations governing {\hyperref[\detokenize{ch/principles-matter:classical-electromagnetism-principles-matter}]{\sphinxcrossref{\DUrole{std,std-ref}{electromagnetism in matter}}}} are discussed: free charge and current are distinguished from bound charte and current, resulting from polarization and the magnetization of matter as a response to external fields are described, and introduced into the \sphinxstylestrong{constitutive equations} characterizing the behavior of matter. Integral form of governing equations is provided for both control volumes and arbitrary domains in motion w.r.t. the observer, and this description is used to introduce the {\hyperref[\detokenize{ch/principles-relativity:classical-electromagnetism-principles-low-speed-relativity}]{\sphinxcrossref{\DUrole{std,std-ref}{low\sphinxhyphen{}speed relativity}}}} of physical quantities involved in electromagnetism.

\sphinxAtStartPar
{\hyperref[\detokenize{ch/waves:classical-electromagnetism-waves}]{\sphinxcrossref{\DUrole{std,std-ref}{\sphinxstylestrong{Electromagentic potentials and wave equations}}}}}. {\hyperref[\detokenize{ch/potentials:classical-electromagnetism-potentials}]{\sphinxcrossref{\DUrole{std,std-ref}{Electromagnetic potentials}}}} are introduced, along with gauge conditions. {\hyperref[\detokenize{ch/waves-equation:classical-electromagnetism-waves-wave-equation}]{\sphinxcrossref{\DUrole{std,std-ref}{Wave equations}}}} for physical quantities in electromagnetism are then introduced. {\hyperref[\detokenize{ch/waves-plane:classical-electromagnetism-waves-plane-waves}]{\sphinxcrossref{\DUrole{std,std-ref}{Plane waves}}}} are discussed along with interface phenomena like rifraction and reflecion.

\sphinxAtStartPar
{\hyperref[\detokenize{ch/energy-momentum-balance:classical-electromagnetism-energy}]{\sphinxcrossref{\DUrole{std,std-ref}{\sphinxstylestrong{Force, Moments on charges, Momentum and Energy of the electromagnetic field}}}}}.

\sphinxAtStartPar
{\hyperref[\detokenize{ch/regimes-slow:classical-electromagnetism-regimes}]{\sphinxcrossref{\DUrole{std,std-ref}{\sphinxstylestrong{Regimes}}}}}.

\sphinxAtStartPar
\DUrole{xref,myst}{\sphinxstylestrong{Einstein’s special relativity and electromagnetism}}.
\subsubsection*{Electric Engineering}

\sphinxAtStartPar
\sphinxstylestrong{Electric circuits}.

\sphinxAtStartPar
\sphinxstylestrong{Electromagentic systems}.

\sphinxAtStartPar
\sphinxstylestrong{Electromagneto\sphinxhyphen{}mechanics systems}.

\sphinxstepscope


\part{Electromagnetism}

\sphinxstepscope




\chapter{Brief history of Electromagnetism}
\label{\detokenize{ch/experiments:brief-history-of-electromagnetism}}\label{\detokenize{ch/experiments:classical-electromagnetism-first-experiments}}\label{\detokenize{ch/experiments::doc}}
\sphinxstepscope


\chapter{Principles of Classical Electromagnetism}
\label{\detokenize{ch/principles:principles-of-classical-electromagnetism}}\label{\detokenize{ch/principles:classical-electromagnetism-principles}}\label{\detokenize{ch/principles::doc}}
\sphinxstepscope




\section{Principles of Classical Electromagnetism in Free Space}
\label{\detokenize{ch/principles-vacuum:principles-of-classical-electromagnetism-in-free-space}}\label{\detokenize{ch/principles-vacuum:classical-electromagnetism-principles-free-space}}\label{\detokenize{ch/principles-vacuum::doc}}
\sphinxAtStartPar
The progress in the study of electromagnetic phenomena during the 19th century allowed James Clerk Maxwell to formulate what are now known as \sphinxstyleemphasis{Maxwell’s equations}, which can be considered the first consistent formulation of the principles of classical electromagnetism, together with the charge conservation law and the expression for the Lorentz force on an electric charge immersed in an electromagnetic field.

\sphinxAtStartPar
Principles are introduced here for total charges and the electric and the magnetic field, in the form that is known as \sphinxstylestrong{equations of electromagnetism in vacuum}. Equations of \DUrole{xref,myst}{electromagnetism in matter} (1) separate the contribution of free and bound charges and currents, and (2) introduce \sphinxstylestrong{polarization} and \sphinxstylestrong{magnetization} of matter in constitutive equations representing the macroscopic response of the media as a result of local microscopic charge distribution induced by “external” fields.

\sphinxAtStartPar
Here principles of electromagnetism are first shown in their {\hyperref[\detokenize{ch/principles-vacuum:classical-electromagnetism-principles-differential}]{\sphinxcrossref{\DUrole{std,std-ref}{differential form}}}}: (1) continuity equation of electric charge describes the conservation of electric charge, (2) Maxwell’s equations govern the generation of the electromagnteic field by electric charge and currents, while (3) the differential form of Lorentz’s force gives the expression of the force per unit volume acting on a distribution of electric charge and currents immersed in an electromagnetic field. Then, the more general {\hyperref[\detokenize{ch/principles-vacuum:classical-electromagnetism-principles-integral}]{\sphinxcrossref{\DUrole{std,std-ref}{integral form}}}}%
\begin{footnote}[1]\sphinxAtStartFootnote
As in continuum mechanics, integral equations are the most general form of the equations that governs the global behavior of a system and requires no assumption of regularity of the physical quantities involved. Under the assumptions of regularity, differential equations can be derived from integral equations using theorems of calculus involving differential operators of the fields: differential equations provide local balances. If the fields are piece\sphinxhyphen{}wise regular in different regions of the domain, it’s possible to derive and use differenial equations in each sub\sphinxhyphen{}domain, and link them through jump conditions.
%
\end{footnote} is presented for {\hyperref[\detokenize{ch/principles-vacuum:classical-electromagnetism-principles-integral-control-volume}]{\sphinxcrossref{\DUrole{std,std-ref}{control volume}}}}, at rest w.r.t. the observer \sphinxhyphen{} an inertial one? \sphinxhyphen{} and then derived form {\hyperref[\detokenize{ch/principles-vacuum:classical-electromagnetism-principles-integral-arbitrary-volume}]{\sphinxcrossref{\DUrole{std,std-ref}{arbitrary domains}}}}, using the \sphinxhref{https://basics2022.github.io/bbooks-math-miscellanea/ch/tensor-algebra-calculus/time-derivative-of-integrals.html}{rules for time derivatives of integrals over moving domains}, and this description is used to have a first discussion about relativity in electromagnetism.


\subsection{Principles in Differential Form}
\label{\detokenize{ch/principles-vacuum:principles-in-differential-form}}\label{\detokenize{ch/principles-vacuum:classical-electromagnetism-principles-differential}}
\sphinxAtStartPar
The principles in differential form can be derived from the more general {\hyperref[\detokenize{ch/principles-vacuum:classical-electromagnetism-principles-integral}]{\sphinxcrossref{\DUrole{std,std-ref}{integral form}}}}, provided the fields satisfy the necessary minimal regularity conditions, which can be qualitatively stated as “all operations must make sense.”

\sphinxAtStartPar
\sphinxstylestrong{Conservation of Electric Charge.} Differential form of conservation of electric charge is described by a continuity equation for the electric charge density \(\rho(\vec{r},t)\), with electric current \(\vec{j} = \rho \vec{v}\) as the flux \sphinxhyphen{} where \(\vec{v}(\vec{r},t)\) is the average velocity of the charges in the point \(\vec{r}\) of space at time \(t\)
\begin{equation*}
\begin{split}\partial_t \rho + \nabla \cdot \vec{j} = 0 \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Maxwell’s Equations.} Maxwell’s equations give the relations between the electric charge and current densities, with the electromagnetic field \(\vec{e}(\vec{r}, t)\), \(\vec{b}(\vec{r},t)\),
\begin{equation*}
\begin{split}\begin{cases}
 \nabla \cdot \vec{e} = \frac{\rho}{\varepsilon_0} \\
 \nabla \times \vec{e} + \partial_t \vec{b} = \vec{0} \\ 
 \nabla \cdot \vec{b} = 0 \\
 \nabla \times \vec{b} - \varepsilon_0 \mu_0 \, \partial_t \vec{e} = \mu_0 \vec{j}  \ ,\\
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
with the \sphinxstylestrong{permittivity of free space} \sphinxhyphen{} or the \sphinxstylestrong{dielectric constant of free space} \sphinxhyphen{} \(\varepsilon_0\) and the \sphinxstylestrong{permeability of the free space}, \(\mu_0\)
\begin{equation*}
\begin{split}\begin{aligned}
  \varepsilon_0 & = 8.85 \cdot 10^{-12} \, \text{F}\, \text{m}^{-1} \\
          \mu_0 & = 4 \pi \cdot 10^{-7} \, \text{N}\, \text{A}^{-2} \\
\end{aligned}\end{split}
\end{equation*}


\sphinxAtStartPar
\sphinxstylestrong{Lorentz Force.} The force per unit volume acting on the electric charges at point \(\vec{r}\) and time \(t\) is governed by differential form of Lorent’z force
\begin{equation*}
\begin{split}\begin{aligned}
  \vec{f}(\vec{r},t) & = \rho(\vec{r},t) \, \vec{e}(\vec{r},t) + \vec{j}(\vec{r},t) \times \vec{b}(\vec{r},t) = \\
                           & = \rho(\vec{r},t) \left[ \vec{e}(\vec{r}) + \vec{v}(\vec{r},t) \times \vec{b}(\vec{r},t) \right] =  \\
                           & = \rho^*(\vec{r},t) \, \vec{e}^*(\vec{r},t) 
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having defined \(\rho^*{(\vec{r}), t}\) \(\vec{e}^*(\vec{r}, t)\) as the current desntiy and the electric field \sphinxstylestrong{as seen by the moving charge}


\subsection{Principles in Integral Form: Electromagnetic Equations and Galilean Relativity}
\label{\detokenize{ch/principles-vacuum:principles-in-integral-form-electromagnetic-equations-and-galilean-relativity}}\label{\detokenize{ch/principles-vacuum:classical-electromagnetism-principles-integral}}

\subsubsection{Integral Form on Control Volumes}
\label{\detokenize{ch/principles-vacuum:integral-form-on-control-volumes}}\label{\detokenize{ch/principles-vacuum:classical-electromagnetism-principles-integral-control-volume}}
\sphinxAtStartPar
The integral form of the principles of electromagnetism for fixed volumes \(V\) and surfaces \(S\) in space is obtained by integrating the differential equations over the domains and using the divergence theorem to obtain flux terms, and Stokes’ theorem to obtain circulation terms.

\sphinxAtStartPar
\sphinxstylestrong{Continuity of Electric Charge.}
\begin{equation*}
\begin{split}\begin{aligned}
    \dfrac{d}{dt} \int_{V} \rho + \oint_{\partial V} \vec{j} \cdot \hat{n} & = 0 \\ \\
    \dfrac{d}{dt} Q_V + \Phi_{\partial V}\left( \vec{j} \right) & = 0
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Gauss’s Law for the Field \(\vec{e}(\vec{r},t)\).}
\begin{equation*}
\begin{split}\begin{aligned}
    \oint_{\partial V} \vec{e} \cdot \hat{n} & = \int_{V} \frac{\rho}{\varepsilon_0} \\ \\
    \Phi_{\partial V}(\vec{e}) & = \frac{Q_V}{\varepsilon_0}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Gauss’s Law for the Field \(\vec{b}(\vec{r},t)\).}
\begin{equation*}
\begin{split}\begin{aligned}
    \oint_{\partial V} \vec{b} \cdot \hat{n} & = 0 \\  \\
    \Phi_{\partial V}\left( \vec{b} \right) & = 0
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Faraday–Neumann–Lenz Law for Electromagnetic Induction.}
\begin{equation*}
\begin{split}\begin{aligned}
    \oint_{\partial S} \vec{e} \cdot \hat{t} + \dfrac{d}{dt} \int_{S} \vec{b} \cdot \hat{n} & = 0 \\  \\
    \Gamma_{S} \left( \vec{e} \right) + \dfrac{d}{dt} \Phi_{S} \left( \vec{b} \right) & = 0
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Ampère–Maxwell Law.}
\begin{equation*}
\begin{split}\begin{aligned}
    \oint_{\partial S} \vec{b} \cdot \hat{t} - \dfrac{d}{dt} \int_{S} \varepsilon_0 \mu_0 \, \vec{e} \cdot \hat{n} & = \int_{S} \mu_0 \, \vec{j} \cdot \hat{n} \\ \\
    \Gamma_{\partial S} \left( \vec{b} \right) - \frac{1}{c_0^2} \dfrac{d}{dt} \Phi_{S} \left( \vec{e} \right) & = \mu_0 \Phi_{S} \left( \vec{j} \right) \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having introduced the speed of velocity in free space, \(c_0 = \dfrac{1}{\sqrt{\varepsilon_0 \mu_0}}\).

\begin{sphinxadmonition}{note}{Maxwell’s equations and continuity equation of electric charge are overdetermined}

\sphinxAtStartPar
Introducing (1) the time derivative of Gauss law of the electric field \(\vec{e}(\vec{r},t)\) and (2) the Ampére\sphinxhyphen{}Maxwell law in the continuity equation of the electric charge
\begin{equation*}
\begin{split}\begin{aligned}
  0 & = \dot{Q}_V + \Phi_{\partial V}\big( \vec{j} \big) = && (1) \\
    & = \varepsilon_0 \dot{\Phi}_{\partial V}\big( \vec{e} \big) + \Phi_{\partial V}\big( \vec{j} \big) =\\
    & = \frac{1}{\mu_0} \left[ \mu_0 \varepsilon_0 \dot{\Phi}_{\partial V}\big( \vec{e} \big) + \mu_0 \Phi_{\partial V}\big( \vec{j} \big)\right] =  && (2) \\
    & = \frac{1}{\mu_0} \Gamma_{\partial \partial V} \big( \vec{b} \big) = 0 \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
an identity appears as the contour \(\partial S\) of a closed surface \(S = \partial V\) has zero dimension. Thus, these equations are not linearly independent and the system is over\sphinxhyphen{}determined.
\end{sphinxadmonition}


\subsubsection{Integral Form on Arbitrary Volumes}
\label{\detokenize{ch/principles-vacuum:integral-form-on-arbitrary-volumes}}\label{\detokenize{ch/principles-vacuum:classical-electromagnetism-principles-integral-arbitrary-volume}}
\sphinxAtStartPar
Due to their importance in fundamental applications such as electric motors, and to avoid confusion or leaps in logic when dealing with electromagnetic induction, it is crucial to provide the correct expression of the electromagnetic principles when moving volumes are involved in space. Not only is the form of these principles shown, but also the correct procedure to derive them starting from the fixed\sphinxhyphen{}control\sphinxhyphen{}volume version. This is done using rules for \sphinxhref{https://basics2022.github.io/bbooks-math-miscellanea/ch/tensor-algebra-calculus/time-derivative-of-integrals.html}{time derivative for fundamental integrals over moving domains}, such as the integral of a density function over a volume, the flux of a vector field through a surface, or the circulation along a curve.

\sphinxAtStartPar
These three derivative rules are listed here and proved in the material about \sphinxhref{https://basics2022.github.io/bbooks-math-miscellanea/intro.html}{Mathematics}:Vector and Tensor Algebra and Calculus:\sphinxhref{https://basics2022.github.io/bbooks-math-miscellanea/ch/tensor-algebra-calculus/time-derivative-of-integrals.html}{Time derivatives of integrals over moving domains}
\begin{equation*}
\begin{split}\begin{aligned}
  \dfrac{d}{dt} \int_{v_t} f & = \int_{v_t} \dfrac{\partial f}{\partial t} + \oint_{\partial v_t} f \, \vec{v}_b \cdot \hat{n} && \text{(density)} \\
  \dfrac{d}{dt} \int_{s_t} \vec{f} \cdot \hat{n} & = \int_{s_t} \dfrac{\partial \vec{f}}{\partial t} \cdot \hat{n} + \int_{s_t} \nabla \cdot \vec{f} \, \vec{v}_b \cdot \hat{n} - \oint_{\partial s_t} \vec{v}_b \times \vec{f} \cdot \hat{t} && \text{(flux)} \\
  \dfrac{d}{dt} \int_{\ell_t} \vec{f} \cdot \hat{t} & = \int_{\ell_t} \dfrac{\partial \vec{f}}{\partial t} \cdot \hat{t} + \int_{\ell_t} \nabla \times \vec{f} \, \cdot \, \vec{v}_b \times \hat{t} + \vec{f}_B \cdot \vec{v}_B - \vec{f}_A \cdot \vec{v}_A && \text{(circulation)}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Continuity of Electric Charge.}
\begin{equation*}
\begin{split}\begin{aligned}
   0 & = \dfrac{d}{dt} \int_{V} \rho + \oint_{\partial V} \vec{j} \cdot \hat{n} = \\
   & = \dfrac{d}{dt} \int_{v_t} \rho - \oint_{\partial v_t } \rho \vec{v}_b \cdot \hat{n} + \oint_{\partial v_t} \vec{j} \cdot \hat{n} 
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}
    \dfrac{d}{dt} \int_{v_t} \rho + \oint_{\partial v_t} \underbrace{\rho (\vec{v} - \vec{v}_b)}_{\vec{j}^*} \cdot \hat{n} 
\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Gauss’s Law for the Field \(\vec{d}(\vec{r},t)\).}
\begin{equation*}
\begin{split}
    \oint_{\partial v_t} \vec{d} \cdot \hat{n} = \int_{v_t} \rho
\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Gauss’s Law for the Field \(\vec{b}(\vec{r},t)\).}
\begin{equation*}
\begin{split}
    \oint_{\partial v_t} \vec{b} \cdot \hat{n} = 0
\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Faraday–Neumann–Lenz Law for Electromagnetic Induction.}
\begin{equation*}
\begin{split}\begin{aligned}
   \vec{0} & = \oint_{\partial S} \vec{e} \cdot \hat{t} + \dfrac{d}{dt} \int_{S} \vec{b} \cdot \hat{n} = \\
    & = \oint_{\partial s_t} \vec{e} \cdot \hat{t} + \dfrac{d}{dt} \int_{s_t} \vec{b} \cdot \hat{n} - \int_{s_t} \underbrace{\nabla \cdot \vec{b}}_{=0} \, \vec{v}_b \cdot \hat{n} + \oint_{s_t} \vec{v}_b \times \vec{b} \cdot \hat{t} =  \\
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}
    \oint_{\partial s_t} \vec{e}^* \cdot \hat{t} + \dfrac{d}{dt} \int_{s_t} \vec{b} \cdot \hat{n} \ ,
\end{split}
\end{equation*}
\sphinxAtStartPar
with the definition \(\vec{e}^* := \vec{e} + \vec{v}_b \cdot \vec{b}\), already used in the expression of the Lorentz force law.

\sphinxAtStartPar
\sphinxstylestrong{Ampère–Maxwell Law.}
\begin{equation*}
\begin{split}\begin{aligned}
    \vec{0} & = \oint_{\partial s_t} \vec{h} \cdot \hat{t} - \dfrac{d}{dt} \int_{s_t} \vec{d} \cdot \hat{n} - \int_{s_t} \vec{j} \cdot \hat{n} = \\
    & = \oint_{\partial s_t} \vec{h} \cdot \hat{t} - \dfrac{d}{dt} \int_{s_t} \vec{d} \cdot \hat{n} + \int_{s_t} \underbrace{\nabla \cdot \vec{d}}_{=\rho} \, \vec{v}_b \cdot \hat{n} - \oint_{s_t} \vec{v}_b \times \vec{d} \cdot \hat{t} - \int_{s_t} \vec{j} \cdot \hat{n} =  \\
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}
    \oint_{\partial s_t} \vec{h}^* \cdot \hat{t} - \dfrac{d}{dt} \int_{s_t} \vec{b} \cdot \hat{n} = \int_{s_t} \vec{j}^* \cdot \hat{n} \ ,
\end{split}
\end{equation*}
\sphinxAtStartPar
having defined \(\vec{h}^* := \vec{h} - \vec{v}_b \times \vec{d}\), and using the previously introduced definition \(\vec{j}^* := \vec{j} - \rho \vec{v}_b\).

\sphinxAtStartPar
Adding the definitions:
\begin{equation*}
\begin{split}\begin{aligned}
  \rho^*    &  = \rho  \\
  \vec{d}^* &  = \vec{d}  \\
  \vec{b}^* &  = \vec{b}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
one obtains equations having the same form as those written for stationary domains in space, but which can be applied to moving domains. The definitions:
\begin{equation*}
\begin{split}\begin{aligned}
\rho^* = \rho \qquad & , \qquad \vec{j}^* = \vec{j} - \rho \vec{v}_b \\
\vec{d}^* = \vec{d} \qquad & , \qquad \vec{e}^* = \vec{e} + \vec{v}_b \times \vec{b} \\
\vec{b}^* = \vec{b} \qquad & , \qquad \vec{h}^* = \vec{h} - \vec{v}_b \times \vec{d} \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
are nothing more than the transformation of the fields for two observers in relative motion, and correspond to the low\sphinxhyphen{}speed limit of Lorentz transformations from special relativity for velocities \(|\vec{v}_b| \ll c\): in this procedure, the transformations for low relative speeds are obtained, as no transformation of spatial and temporal dimensions has been considered, unlike Einstein’s theory of relativity.

\sphinxAtStartPar
\sphinxstylestrong{todo} Reference Galilean and Lorentz transformations for relativity in electromagnetism.


\bigskip\hrule\bigskip


\sphinxstepscope




\section{Electromagnetism in Matter}
\label{\detokenize{ch/principles-matter:electromagnetism-in-matter}}\label{\detokenize{ch/principles-matter:classical-electromagnetism-principles-matter}}\label{\detokenize{ch/principles-matter::doc}}
\sphinxAtStartPar
Electromagnetism in matter requires the description of the behavior of the matter involved in the process. In general, a medium immersed in an electromagnetic field may respond with local charge distributions, resulting in {\hyperref[\detokenize{ch/principles-matter:classical-electromagnetism-media-polarization}]{\sphinxcrossref{\DUrole{std,std-ref}{\sphinxstylestrong{polarization}}}}} and {\hyperref[\detokenize{ch/principles-matter:classical-electromagnetism-media-magnetization}]{\sphinxcrossref{\DUrole{std,std-ref}{\sphinxstylestrong{magnetization}}}}}. Total electric \(\vec{e}(\vec{r},t)\) and magnetic field \(\vec{b}(\vec{r},t)\) can be written as the sum of contributions of free charges \(\rho_f\) and currents \(\vec{j}_f\) and bound charges \(\rho_b\) and currents \(\vec{j}_b\).

\sphinxAtStartPar
Bound charge density represents local separation of charges of molecules of dielectric media immersed in electric field, that can be represented as a volume distribution of charge dipole,
\begin{equation*}
\begin{split}\rho = \rho_f + \rho_b = \rho_f + \rho_P \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Bound current density represents two effects: the variation of polarization charge and the orientation of Amperian currents \sphinxhyphen{} “non random” currents in the molecules of the medium, producing net contribution to the magnetic field, and can be represented as a volume distribution of elementary loop currents.
\begin{equation*}
\begin{split}\begin{aligned}
  \vec{j} & = \vec{j}_f + \vec{j}_b 
            = \vec{j}_f + \vec{j}_P + \vec{j}_M  \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
As it will shown below, the bound current can be written as the divergence of the polarization field \(\vec{p}\), representing the volume density fo the dipole distribution, and the magnetization current as the curl of the magnetization field \(\vec{m}\),
\begin{equation*}
\begin{split}\rho_p = - \nabla \cdot \vec{p} \quad , \quad \vec{j}_M = \nabla \times \vec{m} \ .\end{split}
\end{equation*}

\subsection{Equations of electromagnetism in matter}
\label{\detokenize{ch/principles-matter:equations-of-electromagnetism-in-matter}}\label{\detokenize{ch/principles-matter:classical-electromagnetism-media-vacuum-to-matter}}
\sphinxAtStartPar
Introducing the splitting of free and bound charge and current into the equations of the electromagnetism, namely electric charge continuity and Maxwell’s equations,
\begin{equation*}
\begin{split}
\partial_t \rho + \nabla \cdot \vec{j} = 0
\qquad , \qquad
\begin{cases}
\nabla \cdot \vec{e} = \frac{\rho}{\varepsilon_0} \\
\nabla \times \vec{e} + \partial_t \vec{b} = \vec{0} \\
\nabla \cdot \vec{b} = 0 \\
\nabla \times \vec{b} - \mu_0 \varepsilon_0 \partial_t \vec{e} = \mu_0 \vec{j}
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
and more precisely
\begin{itemize}
\item {} 
\sphinxAtStartPar
into Gauss’ law for the electric field
\begin{equation*}
\begin{split}\begin{aligned}
    & 0  = \nabla \cdot \vec{e} - \frac{\rho}{\varepsilon_0} = \nabla \cdot \vec{e} - \frac{\rho_f - \nabla \cdot \vec{p}}{\varepsilon_0}  \\ \\
    & \rightarrow \qquad \nabla \cdot \vec{d} = \rho_f \ ,
  \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
with \(\vec{d} = \varepsilon_0 \vec{e} + \vec{p}\) defined as the \sphinxstylestrong{displacement field}.

\item {} 
\sphinxAtStartPar
into continuity equation
\begin{equation*}
\begin{split}
    0 
    & = \partial_t \rho + \nabla \cdot \vec{j} = \\
    & = \partial_t \rho_f + \nabla \cdot \vec{j}_f + \partial_t \rho_b + \nabla \cdot ( \vec{j}_P + \nabla \times \vec{j}_M ) = \\
  \end{split}
\end{equation*}
\sphinxAtStartPar
since \(\nabla \cdot \nabla \times \vec{m} \equiv 0\), and keeping separated the contributions of free and bound charges,
\begin{equation*}
\begin{split}\begin{aligned}
     & \partial_t \rho_f + \nabla \cdot \vec{j}_f = 0 \\
     & \partial_t \rho_P + \nabla \cdot \vec{j}_P = 0 \\ \\
     & \rightarrow \qquad \vec{j}_P = \partial_t \vec{p} \ .
  \end{aligned}\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
and into Ampére\sphinxhyphen{}Maxwell’s law
\begin{equation*}
\begin{split}\begin{aligned}
    \vec{0}
    & = \nabla \times \vec{b} - \mu_0 \varepsilon_0 \partial_t \vec{e} - \mu_0 \vec{j} = \\
    & = \nabla \times \vec{b} - \mu_0 \, \partial_t \left( \vec{d} - \vec{p} \right) - \mu_0 \vec{j}_f - \mu_0 \partial_t \vec{p} - \mu_0 \nabla \times \vec{m} \\
    & = \nabla \times \left( \vec{b} - \mu_0 \vec{m} \right) - \ mu_0 \, \partial_t \vec{d} - \mu_0 \vec{j}_f \\ \\ 
    & \rightarrow \qquad \nabla \times \vec{h}  - \, \partial_t \vec{d} = \vec{j}_f \ ,
  \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
where \(\vec{h} := \vec{b} - \mu_0 \vec{m}\), the \sphinxstylestrong{magnetic field strength}.

\end{itemize}


\subsection{Continuous Media}
\label{\detokenize{ch/principles-matter:continuous-media}}
\sphinxAtStartPar
In general, some materials respond to an imposed “external” electromagnetic field with polarization and magnetization. In particular, the electric polarization of a material corresponds to a local separation of electric charges, macroscopically equivalent to a volume density of dipoles, \(\vec{p}(\vec{r}_0)\); magnetization corresponds to an orientation of the axes of Amperian current loops, macroscopically equivalent to a density of magnetic moment \(\vec{m}(\vec{r}_0)\).


\subsection{Polarization}
\label{\detokenize{ch/principles-matter:polarization}}\label{\detokenize{ch/principles-matter:classical-electromagnetism-media-polarization}}

\subsubsection{Single Electric Dipole}
\label{\detokenize{ch/principles-matter:single-electric-dipole}}
\sphinxAtStartPar
A discrete electric dipole is formed by two equal and opposite electric charges \(q\), \(-q\), at points \(P_+\), \(P_- = P_+ \vec{l}\), in the limit \(q \rightarrow +\infty\), \(|\vec{l}| \rightarrow 0\) with \(q |\vec{l}|\) finite.

\sphinxAtStartPar
The electric field (stationary \sphinxstylestrong{todo} \sphinxstyleemphasis{check what happens in the non\sphinxhyphen{}stationary case. Perhaps after deriving the general solution to the problem, as a solution to the wave equations in terms of EM potentials}) generated at the point in space \(\vec{r}\) by an electric dipole at the point \(\vec{r}_0\) is calculated as the limit of the electric field generated by two equal and opposite charges \(q^{\mp}\) at the points \(\vec{r}_0 \mp \frac{\vec{l}}{2}\),
\begin{equation*}
\begin{split}\vec{e}(\vec{r}) = -\frac{q}{4 \pi \varepsilon_0} \frac{\vec{r} - \left( \vec{r}_0 - \frac{\vec{l}}{2} \right)}{\left|\vec{r} - \left( \vec{r}_0 - \frac{\vec{l}}{2} \right)\right|^3} + \frac{q}{4 \pi \varepsilon_0} \frac{\vec{r} - \left( \vec{r}_0 + \frac{\vec{l}}{2} \right)}{\left|\vec{r} - \left( \vec{r}_0 + \frac{\vec{l}}{2} \right)\right|^3} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Using the formula for the derivative of the terms
\begin{equation*}
\begin{split}\partial_{\ell_k} \frac{x_i \pm \frac{\ell_i}{2}}{\left|\vec{x} \pm \frac{\vec{l}}{2} \right|^3} = \frac{1}{2} \left[ \pm \frac{\delta_{ik}}{r^3} - 3 r^{-4} \left( \pm \frac{x_k \pm \frac{\ell_k}{2}}{r} \right) \right]\end{split}
\end{equation*}\begin{equation*}
\begin{split}\left. \partial_{\ell_k} \frac{x_i \pm \frac{\ell_i}{2}}{\left|\vec{x} \pm \frac{\vec{l}}{2} \right|^3} \right|_{\vec{l} = \vec{0}} = \mp \frac{1}{2} \left[ - \frac{\delta_{ik}}{|\vec{x}|^3} + 3 \left( \frac{x_k}{r^5} \right) \right] = \mp \frac{1}{2} \partial_{r_{0 k}} \frac{r_i - r_{0 i}}{|\vec{r} - \vec{r}_0|^3} = \mp \frac{1}{2} \nabla_{\vec{r}_0} \frac{\vec{r} - \vec{r}_0}{|\vec{r} - \vec{r}_0|^3} \end{split}
\end{equation*}
\sphinxAtStartPar
we derive the first\sphinxhyphen{}order approximation in \(\vec{l}\) of the two terms
\begin{equation*}
\begin{split}\begin{aligned}
  \frac{\vec{r} - \left( \vec{r}_0 \mp \frac{\vec{l}}{2} \right)}{\left|\vec{r} - \left( \vec{r}_0 \mp \frac{\vec{l}}{2} \right)\right|^3}
  & = \frac{\vec{r} - \vec{r}_0 }{\left|\vec{r} - \vec{r}_0 \right|^3} \pm \vec{l} \cdot \frac{1}{2} \nabla_{\vec{r}_0} \left( \frac{\vec{r} - \vec{r}_0}{|\vec{r} - \vec{r}_0|^3} \right) + o(|\vec{l}|)\\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and, defining the dipole intensity \(\vec{P}_0 := q \vec{l}\) and taking the quantities to the desired limit, that of the electric field
\begin{equation*}
\begin{split}\begin{aligned}
  \vec{e}(\vec{r})
  & = - \frac{1}{4\pi \varepsilon_0} \, \vec{P}_0 \cdot \nabla_{\vec{r}_0}  \left( \frac{\vec{r} - \vec{r}_0}{|\vec{r} - \vec{r}_0|^3} \right)   = \\
  & = - \frac{1}{4\pi \varepsilon_0} \left[ \frac{(\vec{r}-\vec{r}_0)(\vec{r}-\vec{r}_0)}{|\vec{r}-\vec{r}_0|^5} \cdot \vec{P}_0 - \frac{\vec{P}_0}{|\vec{r}-\vec{r}_0|^3} \right] = \\
  & = - \frac{1}{4\pi \varepsilon_0} \left[ \frac{(\vec{r}-\vec{r}_0) \otimes (\vec{r}-\vec{r}_0)}{|\vec{r}-\vec{r}_0|^5} - \frac{\mathbb{I}}{|\vec{r}-\vec{r}_0|^3} \right] \cdot \vec{P}_0 \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{todo} In the general case, it would be necessary to pay attention to the order of the factors in the product between vectors and tensors, but in this case, the symmetry of the second\sphinxhyphen{}order tensor (or of the operations) can be exploited.


\subsubsection{Continuous Distribution of Dipoles}
\label{\detokenize{ch/principles-matter:continuous-distribution-of-dipoles}}
\sphinxAtStartPar
A distribution of dipoles with volume density \(\vec{p}(\vec{r_0})\), which produces the elementary dipole \(\Delta \vec{P}(\vec{r}_0) = \vec{p}(\vec{r}_0) dV_0\) in the volume \(d V_0\), produces the electric field
\begin{equation*}
\begin{split}\vec{e}(\vec{r}) = \int_{\vec{r}_0 \in V_0} \frac{1}{4 \pi \varepsilon_0} \vec{p}(\vec{r}_0) \cdot \nabla_{\vec{r}_0}  \left( \frac{\vec{r} - \vec{r}_0}{|\vec{r} - \vec{r}_0|^3} \right) \ , \end{split}
\end{equation*}
\sphinxAtStartPar
whose expression can be rewritten using the rules of integration by parts
\begin{equation*}
\begin{split}\begin{aligned}
\vec{e}(\vec{r})
  & = \int_{\vec{r}_0 \in V_0} \frac{1}{4 \pi \varepsilon_0} \vec{p}(\vec{r}_0) \cdot \nabla_{\vec{r}_0}  \left( \frac{\vec{r} - \vec{r}_0}{|\vec{r} - \vec{r}_0|^3} \right) = \\
  & = \oint_{\vec{r}_0 \in \partial V_0} \frac{1}{4 \pi \varepsilon_0}  \frac{\vec{r} - \vec{r}_0}{|\vec{r} - \vec{r}_0|^3} \underbrace{ \hat{\vec{n}}(\vec{r}_0) \cdot \vec{p}(\vec{r}_0) }_{ =: \sigma_P(\vec{r}_0)}  + \int_{\vec{r}_0 \in V_0} \frac{1}{4 \pi \varepsilon_0} \frac{\vec{r} - \vec{r}_0}{|\vec{r} - \vec{r}_0|^3} \underbrace{ \left( - \nabla_{\vec{r}_0} \cdot \vec{p}(\vec{r}_0) \right)}_{ =: \rho_P(\vec{r}_0) } \ , \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having defined the surface polarization charge density \(\sigma_P\) and the volume polarization charge density \(\rho_P\) as the intensities of the distributed sources of the electric field, in analogy with the expression of Coulomb’s law.


\subsubsection{Reformulation of Maxwell’s Equations and Charge Continuity}
\label{\detokenize{ch/principles-matter:reformulation-of-maxwell-s-equations-and-charge-continuity}}
\sphinxAtStartPar
Gauss’s equation determines the volume flux density of the electric field \(\vec{e}\),
\begin{equation*}
\begin{split}\nabla \cdot \vec{e} = \frac{\rho}{\varepsilon_0} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
By decomposing the charge density as the sum of \sphinxstylestrong{free charges} \(\rho_f\) and \sphinxstylestrong{polarization charges} \(\rho_P := - \nabla \cdot \vec{p}\), we can rework Gauss’s equation,
\begin{equation*}
\begin{split}\begin{aligned}
 & \nabla \cdot \vec{e} = \frac{\rho_f + \rho_P}{\varepsilon_0} \\
 & \nabla \cdot \left( \varepsilon_0 \vec{e} + \vec{p} \right) = \rho_f \\ \\
 & \nabla \cdot \vec{d} = \rho_f \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having introduced the \sphinxstylestrong{displacement field}, \(\vec{d} := \varepsilon_0 \vec{e} + \vec{p}\).

\sphinxAtStartPar
The decomposition of the electric current as the sum \(\vec{j} = \vec{j}_f + \vec{j}_P\) of the free current \(\vec{j}_f\) and the polarization current \(\vec{j}_P\), allows us to rework the continuity equation of electric charge
\begin{equation*}
\begin{split}\begin{aligned}
  0 & = \partial_t \rho + \nabla \cdot \vec{j} = \\
    & = \partial_t (\rho_f + \rho_P) + \nabla \cdot \left( \vec{j}_f + \vec{j}_P \right) = \\
    & = \partial_t \rho_f + \nabla \cdot  \vec{j}_f + \partial_t \rho_P + \nabla \cdot \vec{j}_P \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and write the continuity equations for the two charge distributions (of different nature, it is assumed that both must satisfy charge continuity independently, if free charges remain free and polarization charges remain polarization charges),
\begin{equation*}
\begin{split}\begin{aligned}
  & \partial_t \rho_f + \nabla \cdot \vec{j}_f = 0 \\
  & \partial_t \rho_P + \nabla \cdot \vec{j}_P = 0 \qquad \rightarrow \qquad 0 = \nabla \cdot (-\partial_t \vec{p} + \vec{j}_P) \qquad \rightarrow \qquad \vec{j}_P = \partial_t \vec{p}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{todo} \sphinxstyleemphasis{justify absence of constant field}


\subsection{Magnetization}
\label{\detokenize{ch/principles-matter:magnetization}}\label{\detokenize{ch/principles-matter:classical-electromagnetism-media-magnetization}}

\subsubsection{Single Magnetic Moment (Limit of an Elementary Loop)}
\label{\detokenize{ch/principles-matter:single-magnetic-moment-limit-of-an-elementary-loop}}
\sphinxAtStartPar
Using the Biot\sphinxhyphen{}Savart law, specialized for a conductor carrying current \(i(\vec{r}_0)\)
\begin{equation*}
\begin{split}\begin{aligned}
  d \vec{b}(\vec{r})
  & = - \frac{\mu}{4 \pi} \frac{\vec{r} - \vec{r}_0}{|\vec{r} - \vec{r}_0|^3} \times \vec{j}(\vec{r}_0) d V_0 = \\
  & = - \frac{\mu}{4 \pi} i(\vec{r}_0) \frac{\vec{r} - \vec{r}_0}{|\vec{r} - \vec{r}_0|^3} \times \hat{\vec{t}}(\vec{r}_0) d \ell_0 \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
we can calculate the magnetic field generated by a loop with path \(\ell_0 = \partial S_0\) using the PSCE
\begin{equation*}
\begin{split}\begin{aligned}
  \vec{b}(\vec{r})
  & = \oint_{\ell_0} d \vec{b}(\vec{r}_0) = \\
  & = - \frac{\mu}{4 \pi} i_0 \oint_{\vec{r}_0 \in \ell_0} \frac{\vec{r} - \vec{r}_0}{|\vec{r} - \vec{r}_0|^3} \times \hat{\vec{t}}(\vec{r}_0)  = \\
  & =   \frac{\mu}{4 \pi} i_0 \int_{\vec{r}_0 \in S_0} \hat{\vec{n}}(\vec{r}_0) \cdot \nabla_{\vec{r}_0} \left( \frac{\vec{r} - \vec{r}_0}{|\vec{r} - \vec{r}_0|^3} \right)
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
The field generated by an elementary loop of surface \(S_0\) with normal \(\hat{\vec{n}}_0\), using the mean value theorem, is
\begin{equation*}
\begin{split}\vec{b}(\vec{r}) = \frac{\mu}{4 \pi} i_0 S_0 \hat{\vec{n}}_0 \cdot \nabla_{\vec{r}_0} \left( \frac{\vec{r} - \vec{r}_0}{|\vec{r} - \vec{r}_0|^3} \right) + o(S_0)\end{split}
\end{equation*}
\sphinxAtStartPar
and as \(i_0 \rightarrow \infty\), \(S_0 \rightarrow 0\) such that \(\vec{M}_0 := i_0 S_0 \hat{\vec{n}}_0\)
\begin{equation*}
\begin{split}\begin{aligned}
 \vec{b}(\vec{r})
  & = \frac{\mu}{4 \pi} \vec{M}_0 \cdot \nabla_{\vec{r}_0} \left( \frac{\vec{r} - \vec{r}_0}{|\vec{r} - \vec{r}_0|^3} \right) \\
  & = - \frac{\mu_0}{4\pi} \left[ \frac{(\vec{r}-\vec{r}_0)(\vec{r}-\vec{r}_0)}{|\vec{r}-\vec{r}_0|^5} \cdot \vec{M}_0 - \frac{\vec{M}_0}{|\vec{r}-\vec{r}_0|^3} \right] = \\
  & = - \frac{\mu_0}{4\pi} \left[ \frac{(\vec{r}-\vec{r}_0) \otimes (\vec{r}-\vec{r}_0)}{|\vec{r}-\vec{r}_0|^5} - \frac{\mathbb{I}}{|\vec{r}-\vec{r}_0|^3} \right] \cdot \vec{M}_0 \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{todo} Analogy with the electric field produced by a distribution of dipoles.
\subsubsection*{Details}
\begin{equation*}
\begin{split}\oint_{\partial S} A \, t_i = \int_S \varepsilon_{ijk} \, n_j \, \partial_k A
\qquad , \qquad
  \oint_{\partial S} A \, \hat{\vec{t}} = \int_S \hat{\vec{n}} \times \nabla A\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
\oint_{\vec{r}_0 \in \ell_0} \frac{\vec{r} - \vec{r}_0}{|\vec{r} - \vec{r}_0|^3} \times \hat{\vec{t}}(\vec{r}_0) d \ell_0
  & = \oint_{\vec{r}_0 \in \ell_0} \varepsilon_{ijk} \frac{r_j - r_{0,j}}{|\vec{r} - \vec{r}_0|^3}  t_k = \\
  & = \int_{\vec{r}_0 \in S_0} \varepsilon_{krs} n_r \partial^0_s \left( \varepsilon_{ijk} \frac{r_j - r_{0,j}}{|\vec{r} - \vec{r}_0|^3} \right) = \\
  & = \int_{\vec{r}_0 \in S_0} \left( \delta_{ir} \delta_{js} - \delta_{is} \delta_{jr} \right) n_r \partial^0_s \left( \frac{r_j - r_{0,j}}{|\vec{r} - \vec{r}_0|^3} \right) = \\
  & = \int_{\vec{r}_0 \in S_0} \left\{ n_i \underbrace{\partial^0_j \left( \frac{r_j - r_{0,j}}{|\vec{r} - \vec{r}_0|^3} \right)}_{=0} - n_j \partial^0_i \left( \frac{r_j - r_{0,j}}{|\vec{r} - \vec{r}_0|^3} \right) \right\} = \\
  & = - \int_{\vec{r}_0 \in S_0} n_j \partial^0_i \left( \frac{r_j - r_{0,j}}{|\vec{r} - \vec{r}_0|^3} \right) \ .
\end{aligned}\end{split}
\end{equation*}

\subsubsection{Continuous Distribution of Magnetic Moment}
\label{\detokenize{ch/principles-matter:continuous-distribution-of-magnetic-moment}}
\sphinxAtStartPar
To calculate the magnetic field generated by a volume distribution of magnetic moment, we can proceed in analogy with what was done to calculate the electric field generated by a distribution of dipoles
\begin{equation*}
\begin{split}\begin{aligned}
\vec{b}(\vec{r})
  & = \int_{\vec{r}_0 \in V_0} \frac{\mu_0}{4 \pi } \vec{m}(\vec{r}_0) \cdot \nabla_{\vec{r}_0}  \left( \frac{\vec{r} - \vec{r}_0}{|\vec{r} - \vec{r}_0|^3} \right) = \\
  & = \oint_{\vec{r}_0 \in \partial V_0} \frac{\mu_0}{4 \pi}  \frac{\vec{r} - \vec{r}_0}{|\vec{r} - \vec{r}_0|^3} \hat{\vec{n}}(\vec{r}_0) \cdot \vec{m}(\vec{r}_0) + \int_{\vec{r}_0 \in V_0} \frac{\mu_0}{4 \pi} \frac{\vec{r} - \vec{r}_0}{|\vec{r} - \vec{r}_0|^3} \,\left( - \nabla_{\vec{r}_0} \cdot \vec{m}(\vec{r}_0) \right) \ , \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
but without obtaining an analogy with the expression of the Biot\sphinxhyphen{}Savart law, which involves the cross product between the term \(\frac{\vec{r}- \vec{r}_0}{|\vec{r} - \vec{r}_0|^3}\) and a current density \(\vec{j}(\vec{r}_0)\).
\subsubsection*{Details}

\sphinxAtStartPar
We can rewrite
\begin{equation*}
\begin{split}\begin{aligned}
  \oint_{\vec{r}_0 \in \partial V_0} & \frac{\vec{r} - \vec{r}_0}{|\vec{r} - \vec{r}_0|^3} \times \left( \hat{\vec{n}}(\vec{r}_0) \times \vec{m}(\vec{r}_0) \right) \\
  & = \oint_{\vec{r}_0 \in \partial V_0} \varepsilon_{ijk} \frac{r_j - r_{0,j}}{|\vec{r}-\vec{r}_0|^3} \varepsilon_{krs} n_r m_s = \\
  & = \int_{\vec{r}_0 \in V_0} \left( \delta_{ir} \delta_{js} - \delta_{is} \delta_{jr} \right) \partial^0_r \left( \frac{r_j - r_{0,j}}{|\vec{r}-\vec{r}_0|^3} m_s \right) = \\
  & = \int_{\vec{r}_0 \in V_0} \left\{ \partial^0_i \left( \frac{r_j - r_{0,j}}{|\vec{r}-\vec{r}_0|^3} m_j \right) - \partial^0_j \left( \frac{r_j - r_{0,j}}{|\vec{r}-\vec{r}_0|^3} m_i \right)  \right\} = \\
  & = \int_{\vec{r}_0 \in V_0}
  \left\{ \partial^0_i \frac{r_j - r_{0,j}}{|\vec{r}-\vec{r}_0|^3} m_j
         + \frac{r_j - r_{0,j}}{|\vec{r}-\vec{r}_0|^3} \partial^0_i m_j
         - \frac{r_j - r_{0,j}}{|\vec{r}-\vec{r}_0|^3} \partial^0_j m_i
         - \underbrace{ \partial^0_j \frac{r_j - r_{0,j}}{|\vec{r}-\vec{r}_0|^3}}_{=0} m_i
  \right\} = \\
  & = \int_{\vec{r}_0 \in V_0}
  \left\{ \partial^0_i \frac{r_j - r_{0,j}}{|\vec{r}-\vec{r}_0|^3} m_j
         + \varepsilon_{ijk} \varepsilon_{krs} \frac{r_j - r_{0,j}}{|\vec{r}-\vec{r}_0|^3} \partial^0_r m_s
  \right\} = \\
  & = \int_{\vec{r}_0 \in V_0}
  \left\{ \nabla_{\vec{r}_0} \frac{\vec{r} - \vec{r}_0}{|\vec{r}-\vec{r}_0|^3} \cdot \vec{m}(\vec{r}_0)
         + \frac{\vec{r} - \vec{r}_0}{|\vec{r}-\vec{r}_0|^3} \times \left( \nabla_{\vec{r}_0} \times \vec{m}(\vec{r}_0) \right)
  \right\} = \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
using vector calculus identities,
\begin{equation*}
\begin{split}\begin{aligned}
  \vec{a} \times (\vec{b} \times \vec{c}) & = \varepsilon_{ijk} a_j \varepsilon_{krs} b_r c_s = \\
  & = (\delta_{ir} \delta_{js} - \delta_{is} \delta_{jr}) a_j b_r c_s = \\
  & = a_j b_i c_j - c_i b_j a_j = \vec{b}(\vec{a} \cdot \vec{c}) - \vec{c} (\vec{a} \cdot \vec{b})
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
 a_j \partial_i m_j - a_j \partial_j m_i
 & = (\delta_{ir} \delta_{js} - \delta_{is} \delta_{jr}) a_j \partial_r m_s = \\
 & = \varepsilon_{ijk} \varepsilon_{krs} a_j \partial_r m_s = \\
 & = \vec{a} \times \left( \nabla \times \vec{m} \right)
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
The magnetic field generated by a distribution of magnetic moment can therefore be rewritten as
\begin{equation*}
\begin{split}\begin{aligned}
\vec{b}(\vec{r})
  & = \int_{\vec{r}_0 \in V_0} \frac{\mu_0}{4 \pi } \vec{m}(\vec{r}_0) \cdot \nabla_{\vec{r}_0}  \left( \frac{\vec{r} - \vec{r}_0}{|\vec{r} - \vec{r}_0|^3} \right) = \\
  & = - \frac{\mu_0}{4\pi} \oint_{\vec{r}_0 \in \partial V_0} \frac{\vec{r} - \vec{r}_0}{|\vec{r} - \vec{r}_0|^3} \times \underbrace{ \left( - \hat{\vec{n}}(\vec{r}_0) \times \vec{m}(\vec{r}_0) \right) }_{\vec{j}^s_M}
  - \frac{\mu_0}{4 \pi} \int_{\vec{r}_0 \in V_0} \frac{\vec{r} - \vec{r}_0}{|\vec{r}-\vec{r}_0|^3} \times \underbrace{ \left(\nabla_{\vec{r}_0} \times \vec{m}(\vec{r}_0) \right)}_{\vec{j}_M} \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having defined the surface magnetization current density \(\vec{j}^s_M\) and the volume magnetization current density \(\vec{j}_M\) as the intensities of the distributed singularities, in analogy with the expression of the Biot\sphinxhyphen{}Savart law.


\subsubsection{Reformulation of Maxwell’s Equations and Charge Continuity}
\label{\detokenize{ch/principles-matter:id1}}
\sphinxAtStartPar
The Ampère\sphinxhyphen{}Maxwell law can be rewritten
\begin{equation*}
\begin{split}\begin{aligned}
 & \nabla \times \vec{b} - \mu_0 \varepsilon_0 \partial_t \vec{e} = \mu_0 \vec{j} \\
 & \nabla \times \vec{b} - \mu_0 \partial_t \left( \vec{d} - \vec{p} \right) = \mu_0 \left( \vec{j}_f + \vec{j}_P + \vec{j}_M \right) \\
 & \nabla \times \underbrace{\left( \vec{b} - \mu_0 \vec{m} \right)}_{=: \mu_0 \vec{h}} - \mu_0 \partial_t \vec{d} + \mu_0 \underbrace{\left( \partial_t \vec{p} - \vec{j}_P \right)}_{= \vec{0}} = \mu_0 \vec{j}_f  \\ \\
 & \nabla \times \vec{h} - \partial_t \vec{d} = \vec{j}_f
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
From the continuity equation of electric current,
\begin{equation*}
\begin{split}\partial_t \rho + \nabla \cdot \vec{j} = 0 \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
we derive the continuity equation for magnetization charges
\begin{equation*}
\begin{split}\begin{aligned}
  0 & = \partial_t \rho_M + \nabla \cdot \vec{j}_M = \\
    & = \partial_t \rho_M + \underbrace{ \nabla \cdot \nabla \times \vec{m}}_{ \equiv \vec{0} } \ .
\end{aligned}\end{split}
\end{equation*}

\subsection{Examples}
\label{\detokenize{ch/principles-matter:examples}}\begin{itemize}
\item {} 
\sphinxAtStartPar
conductors

\item {} 
\sphinxAtStartPar
ferromagnetic and weak magnetism (para\sphinxhyphen{}, dia\sphinxhyphen{}, anti\sphinxhyphen{})

\end{itemize}


\subsection{Jump Conditions}
\label{\detokenize{ch/principles-matter:jump-conditions}}\label{\detokenize{ch/principles-matter:classical-electromagnetism-media-jump}}
\sphinxAtStartPar
Differential form of Maxwell’s equations
\begin{equation*}
\begin{split}\begin{cases}
 \nabla \cdot \vec{d} = \rho_f \\
 \nabla \times \vec{e} + \partial_t \vec{b} = \vec{0} \\
 \nabla \cdot \vec{b} = 0 \\
 \nabla \times \vec{h} - \partial_t \vec{d} = \vec{j}_f
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
Integral form of Maxwell’s equations
\begin{equation*}
\begin{split}\begin{cases}
 \displaystyle \oint_{\partial V} \vec{d} \cdot \hat{\vec{n}} = \int_{V} \rho_f \\
 \displaystyle \oint_{\partial S} \vec{e} \cdot \hat{\vec{t}} + \dfrac{d}{dt} \int_S \vec{b} \cdot \hat{\vec{n}} = 0 \\
 \displaystyle \oint_{\partial V} \vec{b} \cdot \hat{\vec{n}} = 0 \\
 \displaystyle \oint_{\partial S} \vec{h} \cdot \hat{\vec{t}} - \dfrac{d}{dt} \int_S \vec{d} \cdot \hat{\vec{n}} = \int_{S} \vec{j}_f \cdot \hat{\vec{n}} \\
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
Letting \(V\) and \(S\) “collapse on a discontinuity”…
\begin{equation}\label{equation:ch/principles-matter:eq:em-jump}
\begin{split}\begin{cases}
  [ d_n ] = \sigma_f \\
  [ e_t ] = 0 \\
  [ b_n ] = 0 \\
  [ h_t ] = \iota_f \ ,
\end{cases}\end{split}
\end{equation}
\sphinxAtStartPar
being \(\sigma_f\) and \(\iota_f\) surface charge and current density, with physical dimension \(\frac{\text{charge}}{\text{surface}}\), and \(\frac{\text{current}}{\text{surface}}\) respectively. These contributions can be thought of as Dirac delta contributions in volume density, namely
\begin{equation*}
\begin{split}\rho(\vec{r},t) = \rho_0(\vec{r},t) + \sigma(\vec{r}_s,t) \delta_{1}(\vec{r}-\vec{r}_s) \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
being \(\rho(\vec{r},t)\) the regular part of the volume density in all the points of the domain \(\vec{r} \in V\), \(\sigma(\vec{r}_s,t)\) the surface density on 2\sphinxhyphen{}dimensional surfaces \(\vec{r}_s \in S\), \(\delta_1()\) the Dirac’s delta with physical dimension \(\frac{1}{\text{length}}\).

\sphinxAtStartPar
If there’s no free surface charge and currents, jump conditions for linear media become
\begin{equation}\label{equation:ch/principles-matter:eq:em-jump:no-surf-density}
\begin{split}\begin{cases}
  [ d_n ] = 0 \\
  [ e_t ] = 0 \\
  [ b_n ] = 0 \\
  [ h_t ] = 0 \ ,
\end{cases}
\qquad \rightarrow \qquad
\begin{cases}
  d_{n,1} = d_{n,2}  \quad \rightarrow \quad \varepsilon_1 e_{n,1} = \varepsilon_2 e_{n,2} \\
  e_{t,1} = e_{t,2}  \\
  b_{n,1} = b_{n,2}  \\
  h_{t,1} = h_{t,2}  \quad \rightarrow \quad \frac{1}{\mu_1} b_{t,1} = \frac{1}{\mu_2} b_{t,2} \\
\end{cases}
\end{split}
\end{equation}
\sphinxstepscope


\section{Galileian relativity in electromagnetism}
\label{\detokenize{ch/principles-relativity:galileian-relativity-in-electromagnetism}}\label{\detokenize{ch/principles-relativity:classical-electromagnetism-principles-low-speed-relativity}}\label{\detokenize{ch/principles-relativity::doc}}
\sphinxstepscope




\chapter{Electromagnetic waves}
\label{\detokenize{ch/waves:electromagnetic-waves}}\label{\detokenize{ch/waves:classical-electromagnetism-waves}}\label{\detokenize{ch/waves::doc}}
\sphinxstepscope




\section{Electromagnetic Potentials}
\label{\detokenize{ch/potentials:electromagnetic-potentials}}\label{\detokenize{ch/potentials:classical-electromagnetism-potentials}}\label{\detokenize{ch/potentials::doc}}
\sphinxAtStartPar
It is possible to demonstrate that the system of Maxwell’s equations and the charge continuity equation is overdetermined. Specifically, it can be shown that, given the distribution of charge and current density—considered as the generating causes of the electric field—and the constitutive laws of the material, four unknowns are sufficient to define the six unknowns (three components for two vector fields) of the problem. Therefore, the problem can be formulated in terms of a scalar potential \(\varphi\) and a vector potential \(\vec{a}\), along with a gauge condition that eliminates the remaining two arbitrary factors (irrelevant for the calculation of physical fields).


\subsection{Vector Potential and Scalar Potential}
\label{\detokenize{ch/potentials:vector-potential-and-scalar-potential}}
\sphinxAtStartPar
Starting from Maxwell’s equations, the potentials of the electromagnetic field can be defined. Using Gauss’s law for the magnetic field, the vector potential \(\vec{a}(\vec{r},t)\) can be introduced,
\begin{equation*}
\begin{split}0 = \nabla \cdot \vec{b} \qquad \rightarrow \qquad \vec{b} = \nabla \times \vec{a} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
since the divergence of a curl is identically zero. Introducing this relationship into the Faraday\sphinxhyphen{}Neumann\sphinxhyphen{}Lenz equation, assuming sufficient regularity of the fields to allow the inversion of the order of derivatives,
\begin{equation*}
\begin{split}0 = \nabla \times \vec{e} + \partial_t \vec{b} = \nabla \times \vec{e} + \partial_t \nabla \times \vec{a} = \nabla \times (\vec{e} + \partial_t \vec{a}) \qquad \rightarrow \qquad \vec{e} + \partial_t \vec{a} = - \nabla \varphi \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
since the curl of a gradient is identically zero. The “physical” quantities of the electric field \(\vec{e}(\vec{r},t)\) and the magnetic field \(\vec{b}(\vec{r},t)\) can therefore be written using the electromagnetic potentials as
\begin{equation}\label{equation:ch/potentials:eq:potentials}
\begin{split}\begin{aligned}
 \vec{e} & = - \nabla \varphi - \partial_t \vec{a} && (a) \\
 \vec{b} & = \nabla \times \vec{a} && (b) \\
\end{aligned}\end{split}
\end{equation}

\subsection{Gauge Conditions}
\label{\detokenize{ch/potentials:gauge-conditions}}
\sphinxAtStartPar
The potentials are defined up to a gauge condition, an additional condition that eliminates any arbitrariness in the definition. For example, the vector potential is defined up to the gradient of a scalar function, since \(\nabla \times \nabla f \equiv \vec{0}\), and thus the potential \(\tilde{\vec{a}} = \vec{a} + \nabla f\) produces the same magnetic field \(\vec{b}\)
\begin{equation*}
\begin{split}\nabla \times \tilde{\vec{a}} = \nabla \times (\vec{a} + \nabla f) = \nabla \times \vec{a} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Lorentz Gauge Condition.} For reasons that will become clearer in the section on {\hyperref[\detokenize{ch/waves:classical-electromagnetism-waves}]{\sphinxcrossref{\DUrole{std,std-ref}{electromagnetic waves}}}}, a convenient gauge condition is
\begin{equation}\label{equation:ch/potentials:eq:potential:gauge:lorentz}
\begin{split}\nabla \cdot \vec{a} + \frac{1}{c^2} \partial_t \varphi = 0\end{split}
\end{equation}
\sphinxAtStartPar
\sphinxstylestrong{Coulomb Gauge Condition.}
\begin{equation*}
\begin{split}\nabla \cdot \vec{a} = 0\end{split}
\end{equation*}
\sphinxstepscope




\section{Wave Equations in Electromagnetism}
\label{\detokenize{ch/waves-equation:wave-equations-in-electromagnetism}}\label{\detokenize{ch/waves-equation:classical-electromagnetism-waves-wave-equation}}\label{\detokenize{ch/waves-equation::doc}}
\sphinxAtStartPar
Wave equations for physical quantities in electromagnetism are derived from the governing equations for linear local isotropic homogeneous (\(\varepsilon\), \(\mu\) uniform, not function of space) media with constitutive equations
\begin{equation*}
\begin{split}\vec{d} = \varepsilon \vec{e} \qquad , \qquad \vec{b} = \mu \vec{h} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
using \sphinxhref{https://basics2022.github.io/bbooks-math-miscellanea/ch/tensor-algebra-calculus/calculus-identities.html\#equation-eq-identity-laplacian}{vector identity}
\begin{equation*}
\begin{split}\Delta \vec{v} = \nabla ( \nabla \cdot \vec{v} ) - \nabla \times \nabla \times \vec{v} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
If some of the assumptions made above is not true, slight modifications and extra terms in the equations are likely to appear during the manipulation of the equations done below.


\subsection{Electromagnetic Potentials}
\label{\detokenize{ch/waves-equation:electromagnetic-potentials}}\label{\detokenize{ch/waves-equation:classical-electromagnetism-waves-wave-equation-potentials}}



\subsubsection{Vector potential}
\label{\detokenize{ch/waves-equation:vector-potential}}
\sphinxAtStartPar
Wave equation for the vector potential,
\begin{equation*}
\begin{split}\vec{b} = \nabla \times \vec{a} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
is derived taking the curl of its definition,
\begin{equation*}
\begin{split}\begin{aligned}
\vec{0} & = \nabla \times \nabla \times \vec{a} - \nabla \times \vec{b} = && (1.a) \\
 & = - \Delta \vec{a} + \nabla(\nabla \cdot \vec{a})  - \mu \nabla \times \vec{h} = && (2) \\
 & = - \Delta \vec{a} + \nabla(\nabla \cdot \vec{a})  - \mu ( \partial_t \vec{d} + \vec{j}_f )  = && (1.b) \\
 & = - \Delta \vec{a} + \nabla(\nabla \cdot \vec{a})  - \mu ( \varepsilon \partial_t \vec{e} + \vec{j}_f )  = && (3) \\
 & = - \Delta \vec{a} + \nabla(\nabla \cdot \vec{a})  - \mu \varepsilon ( - \partial_t \nabla \varphi - \partial_{tt} \vec{a} ) + \mu \vec{j}_f = \\
 & = - \Delta \vec{a} + \nabla(\nabla \cdot \vec{a})  + \frac{1}{c^2} \partial_t \nabla \varphi + \dfrac{1}{c^2} \partial_{tt} \vec{a} - \mu \vec{j}_f  \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and using (1) the constitutive law for homogeneous isotropic linear media, (2) Ampére\sphinxhyphen{}Maxwell’s equation, (3), and (4) the definition of the electric field \eqref{equation:ch/potentials:eq:potentials}(a)  in terms of the potentials. Using the Lorentz gauge condition \eqref{equation:ch/potentials:eq:potential:gauge:lorentz}
\begin{equation*}
\begin{split}\nabla \cdot \vec{a} + \frac{1}{c^2} \partial_t  \varphi = 0 \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
wave equation for the vector potential reads,
\begin{equation}\label{equation:ch/waves-equation:eq:wave:a}
\begin{split} \dfrac{1}{c^2} \partial_{tt} \vec{a} - \Delta \vec{a}  =  \mu \vec{j}  \ .\end{split}
\end{equation}

\subsubsection{Scalar potential}
\label{\detokenize{ch/waves-equation:scalar-potential}}
\sphinxAtStartPar
Wave equation for the the scalar potential, \(\varphi(\vec{r},t)\), can be derived taking the time derivative of Lorentz’s gauge condition,
\begin{equation*}
\begin{split}\begin{aligned}
 0 & = \partial_t \left(\frac{1}{c^2} \partial_t \varphi + \nabla \cdot \vec{a} \right) = \\
   & = \frac{1}{c^2} \partial_{tt} \varphi + \nabla \cdot \partial_t \vec{a} = && (1) \\
   & = \frac{1}{c^2} \partial_{tt} \varphi - \nabla \cdot \nabla \varphi - \nabla \cdot \vec{e} = && (2) \\
   & = \frac{1}{c^2} \partial_{tt} \varphi - \Delta \varphi - \frac{\rho_f}{\varepsilon} \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
using (1) the definition \eqref{equation:ch/potentials:eq:potentials}(a)  of the electric field as a function of the potentials, and (2) Gauss’ law for the electric field,
\begin{equation}\label{equation:ch/waves-equation:eq:wave:phi}
\begin{split} \frac{1}{c^2} \partial_{tt} \varphi - \Delta \varphi = \frac{\rho_f}{\varepsilon} \ .\end{split}
\end{equation}

\subsection{Electric Field and Magnetic Field}
\label{\detokenize{ch/waves-equation:electric-field-and-magnetic-field}}


\sphinxAtStartPar
Exploiting the linearity \sphinxhyphen{} obviously, if the problem is linear \sphinxhyphen{} wave equations for the electric and the magnetic field can be readily derived from applying the wave operator
\begin{equation*}
\begin{split}\square := \frac{1}{c^2} \partial_{tt} - \Delta \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
to the (1) definitions \eqref{equation:ch/potentials:eq:potentials} of the electric and the magnetic fields as functions of the potentials, (2) swapping the order of the operator \(\square\) with \(\partial_t\) and \(\nabla\), and (3) using the expressions of the wave equations for the vector potential \eqref{equation:ch/waves-equation:eq:wave:a} and the scalar potential \eqref{equation:ch/waves-equation:eq:wave:phi}.


\subsubsection{Electric field}
\label{\detokenize{ch/waves-equation:electric-field}}\begin{equation*}
\begin{split}\begin{aligned}
\square \vec{e} & = && (1) \\
& =\square ( -\nabla \varphi - \partial_t \vec{a}) = && (2) \\
& = - \nabla \square \varphi - \partial_t \square \vec{a} = && (3) \\
& = - \nabla \dfrac{\rho}{\varepsilon} - \mu \partial_t \vec{j}  \ .
\end{aligned}\end{split}
\end{equation*}

\subsubsection{Magnetic field}
\label{\detokenize{ch/waves-equation:magnetic-field}}\begin{equation*}
\begin{split}\begin{aligned}
 \square \vec{b} & = && (1) \\
 & = \square \nabla \times \vec{a} = && (2) \\
 & = \nabla \times \square \vec{a} = && (3) \\
 & = \mu \nabla \times \vec{j}
\end{aligned}\end{split}
\end{equation*}
\sphinxstepscope




\section{Plane Electromagnetic Waves}
\label{\detokenize{ch/waves-plane:plane-electromagnetic-waves}}\label{\detokenize{ch/waves-plane:classical-electromagnetism-waves-plane-waves}}\label{\detokenize{ch/waves-plane::doc}}
\sphinxAtStartPar
Harmonic decomposition of the electromagnetic field. The EM field can be written as the superposition of plane waves (Fourier decomposition)
\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{e}(\mathbf{r},t) & = \mathbf{E} e^{i(\mathbf{k} \cdot \mathbf{r} - \omega t)} \\
  \mathbf{b}(\mathbf{r},t) & = \mathbf{B} e^{i(\mathbf{k} \cdot \mathbf{r} - \omega t)} \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Introducing this decomposition into Maxwell’s equations with no free charge and current
\begin{equation*}
\begin{split}
\begin{cases}
 \nabla \cdot \mathbf{d} = 0 \\
 \nabla \times \mathbf{e} + \partial_t \mathbf{b} = \mathbf{0} \\
 \nabla \cdot \mathbf{b} = 0 \\
 \nabla \times \mathbf{h} - \partial_t \mathbf{d} = \mathbf{0}
\end{cases}
\end{split}
\end{equation*}
\sphinxAtStartPar
we obtain
\begin{equation*}
\begin{split}
\begin{cases}
 i \mathbf{k} \cdot \mathbf{D} = 0 \\
 i \mathbf{k} \times \mathbf{E} - i \omega \mathbf{B} = \mathbf{0} \\
 i \mathbf{k} \cdot \mathbf{B} = 0 \\
 i \mathbf{k} \times \mathbf{H} + i \omega \mathbf{D} = \mathbf{0}
\end{cases}
\quad \rightarrow \quad
\begin{cases}
 i \varepsilon \mathbf{k} \cdot \mathbf{E} = 0 \\
 i \mathbf{k} \times \mathbf{E} - i \omega \mathbf{B} = \mathbf{0} \\
 i \mathbf{k} \cdot \mathbf{B} = 0 \\
 i \dfrac{1}{\mu} \mathbf{k} \times \mathbf{B} + i \omega \varepsilon \mathbf{E} = \mathbf{0}
\end{cases}
\end{split}
\end{equation*}\begin{itemize}
\item {} 
\sphinxAtStartPar
From Gauss’ equations for the electric and the magnetic field
\begin{equation*}
\begin{split}\mathbf{k} \perp \mathbf{E} \quad , \quad \mathbf{k} \perp \mathbf{B}\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
From Faraday and Ampère\sphinxhyphen{}Maxwell equations
\begin{equation*}
\begin{split}\mathbf{B} = \dfrac{\mathbf{k}}{\omega} \times \mathbf{E}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{E} = - \dfrac{1}{\mu \varepsilon}\dfrac{\mathbf{k}}{\omega} \times \mathbf{B}\end{split}
\end{equation*}
\end{itemize}

\sphinxAtStartPar
It follows that:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(\mathbf{k}\), \(\mathbf{E}\), \(\mathbf{B}\) are orthogonal “RHS” set of vectors

\item {} 
\sphinxAtStartPar
Relations between \(\mathbf{E}\), \(\mathbf{B}\), and \(\mathbf{k}\) and the speed of light
\begin{equation*}
\begin{split}\begin{aligned}
      \mathbf{B} & = \dfrac{1}{c} \, \hat{\mathbf{k}} \times \mathbf{E} \\
      \mathbf{E} & = - c \, \hat{\mathbf{k}} \times \mathbf{B} \\
    \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
hold, with speed of light \(c = \dfrac{1}{\sqrt{\mu \varepsilon}} = \dfrac{\omega}{|\mathbf{k}|}\), and unit vector \(\hat{\mathbf{k}} = \dfrac{\mathbf{k}}{|\mathbf{k}|}\).

\end{itemize}
\subsubsection*{Proof using vector algebra identity}

\sphinxAtStartPar
Recalling \(c^2 = \frac{1}{\mu \varepsilon}\) and
\begin{equation*}
\begin{split}\mathbf{B} = \dfrac{\mathbf{k}}{\omega} \times \mathbf{E} = \dfrac{\mathbf{k}}{\omega} \times \left[ - c^2 \dfrac{\mathbf{k}}{\omega} \times \mathbf{B} \right] = - \dfrac{c^2 |\mathbf{k}|^2}{\omega^2} \hat{\mathbf{k}} \times \left( \hat{\mathbf{k}} \times \mathbf{B} \right)\end{split}
\end{equation*}
\sphinxAtStartPar
Vector identity
\begin{equation*}
\begin{split}\mathbf{a} \times (\mathbf{b} \times \mathbf{c}) = \varepsilon_{ijk} a_j \varepsilon_{klm} b_l c_m = \left( \delta_{il} \delta_{jm} - \delta_{im} \delta_{jl} \right) a_j \, b_l \, c_m = b_i a_m c_m - c_i a_m b_m = (\mathbf{a} \cdot \mathbf{c}) \mathbf{b} - (\mathbf{a} \cdot \mathbf{b}) \mathbf{c}\end{split}
\end{equation*}
\sphinxAtStartPar
applied to \(\hat{\mathbf{k}} \times \left( \hat{\mathbf{k}} \times \mathbf{B} \right)\) gives
\begin{equation*}
\begin{split}
  \hat{\mathbf{k}} \times \left( \hat{\mathbf{k}} \times \mathbf{B} \right) = \underbrace{\left( \hat{\mathbf{k}} \dot \mathbf{B} \right)}_{=0 \text{ since $\mathbf{k} \perp \mathbf{B}$}} \hat{\mathbf{k}} - \underbrace{\left( \hat{\mathbf{k}} \cdot \hat{\mathbf{k}} \right)}_{= 1} \mathbf{B} = - \mathbf{B} \ ,
\end{split}
\end{equation*}
\sphinxAtStartPar
and the original relation gives
\begin{equation*}
\begin{split}\mathbf{B} = \mathbf{B} \dfrac{c^2 |\mathbf{k}|^2}{\omega^2} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and the relation between pulsation \(\omega\), wave vector \(\mathbf{k}\) and speed of light (EM radiation) \(c\),
\begin{equation*}
\begin{split}c = \dfrac{\omega}{|\mathbf{k}|} \ .\end{split}
\end{equation*}

\subsection{Snell’s Law at an Interface}
\label{\detokenize{ch/waves-plane:snell-s-law-at-an-interface}}\label{\detokenize{ch/waves-plane:classical-electromagnetism-waves-plane-waves-snell}}
\sphinxAtStartPar
Snell’s law is derived here assuming isotropic linear media, so that
\begin{equation*}
\begin{split}\begin{cases}
  \mathbf{d}(\mathbf{r},t) = \varepsilon \mathbf{e}(\mathbf{r},t) \\
  \mathbf{b}(\mathbf{r},t) = \mu         \mathbf{h}(\mathbf{r},t)
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
and for harmonic plane EM waves
\begin{equation*}
\begin{split}\begin{cases}
 \mathbf{e}(\mathbf{r}, t) = \mathbf{E}_{a} \, e^{i \left( \mathbf{k}_a \cdot \mathbf{r} - \omega t \right)} \\
 \mathbf{b}(\mathbf{r}, t) = \mathbf{B}_{a} \, e^{i \left( \mathbf{k}_a \cdot \mathbf{r} - \omega t \right)} \\
\end{cases}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{B}_a & = \dfrac{1}{c} \, \hat{\mathbf{k}}_a \times \mathbf{E}_a \\
  \mathbf{E}_a & = - c \, \hat{\mathbf{k}}_a \times \mathbf{B}_a \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
being index \(a\) representing the media involved: \(a = 1\) for the medium with incident and reflected waves, \(a = 2\) for the medium with the refracted wave.

\sphinxAtStartPar
{\hyperref[\detokenize{ch/principles-matter:classical-electromagnetism-media-jump}]{\sphinxcrossref{\DUrole{std,std-ref}{Jump conditions of electromagnetic field at an interface}}}} with no charge or current surface density are given by conditions \eqref{equation:ch/principles-matter:eq:em-jump:no-surf-density},
\begin{equation*}
\begin{split}\begin{cases}
  \varepsilon_1 e_{n,1} = \varepsilon_2 e_{n,2} \\
  e_{t_{\alpha},1} = e_{t_{\alpha},2}                                    & \quad , \quad \alpha=1:2 \\
  b_{n,1} = b_{n,2}  \\
  \dfrac{1}{\mu_1} b_{t_{\alpha},1} = \dfrac{1}{\mu_2} b_{t_{\alpha},2}  & \quad , \quad \alpha=1:2 \\
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
Definition of some vectors: \(\hat{\mathbf{n}}\) unit normal vector, \(\mathbf{k}\) wave vector, \(\hat{\mathbf{b}} = \dfrac{\hat{\mathbf{n}} \times \mathbf{k}}{|\hat{\mathbf{n}} \times \mathbf{k}|}\) (singular only for normal incident ray), \(\hat{\mathbf{c}} = \dfrac{\hat{\mathbf{b}} \times \mathbf{k}}{|\hat{\mathbf{b}} \times \mathbf{k}|}\), \(\hat{\mathbf{t}} = \dfrac{\hat{\mathbf{b}} \times \hat{\mathbf{n}}}{|\hat{\mathbf{b}} \times \hat{\mathbf{n}}|}\)

\sphinxAtStartPar
Incident angle \(\theta_{1,i}\) is the angle between \(\hat{\mathbf{n}}\) and \(\mathbf{k}\), s.t. \(\hat{\mathbf{n}} \times \mathbf{k} = \hat{\mathbf{b}} \, k \, \sin \theta_{1,i}\).
\begin{equation*}
\begin{split}\begin{cases}
  \hat{\mathbf{k}} = \quad \cos \theta_{1,i} \hat{\mathbf{n}} + \sin \theta_{1,i} \hat{\mathbf{t}} \\
  \hat{\mathbf{c}} =      -\sin \theta_{1,i} \hat{\mathbf{n}} + \cos \theta_{1,i} \hat{\mathbf{t}}
\end{cases}
\quad , \quad
\begin{cases}
  \hat{\mathbf{n}} = \cos \theta_{1,i} \hat{\mathbf{k}} - \sin \theta_{1,i} \hat{\mathbf{c}} \\
  \hat{\mathbf{t}} = \sin \theta_{1,i} \hat{\mathbf{k}} + \cos \theta_{1,i} \hat{\mathbf{c}}
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
The electromagnetic field can be written as
\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{E} & = E_b \hat{\mathbf{b}} + E_c \hat{\mathbf{c}} = \\
             & = E_b \hat{\mathbf{b}} - E_c \sin \theta_{1,i} \hat{\mathbf{n}} + E_c \cos \theta_{1,i} \hat{\mathbf{t}} \\
  \mathbf{B} & = B_b \hat{\mathbf{b}} + B_c \hat{\mathbf{c}} = \\
             & = \frac{E_c}{c} \hat{\mathbf{b}} - \frac{E_b}{c} \hat{\mathbf{c}} = \\
             & = \frac{E_c}{c} \hat{\mathbf{b}} + \frac{E_b}{c} \sin \theta_{1,i} \hat{\mathbf{n}} - \frac{E_b}{c} \cos \theta_{1,i} \hat{\mathbf{t}} \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
so that jump relations become
\begin{equation*}
\begin{split}\begin{cases}
  b: & \quad E_{b,1} = E_{b,2} \\
  n: & \quad \dots \\
  t: & \quad \dots \\
\end{cases}
\quad , \quad
\begin{cases}
  b: & \quad \dots \\
  n: & \quad \frac{E_{b,1}}{c_1} \sin \theta_{1,i} = \frac{E_{b,2}}{c_2} \sin \theta_{2,i}  \\
  t: & \quad \dots \\
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
thus \sphinxstylestrong{Snell’s law} follows
\begin{equation*}
\begin{split}\frac{\sin \theta_{1,i}}{\sin \theta_{2,t}} = \frac{c_2}{c_1} = \frac{n_1}{n_2} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Incident, Reflected, and Refracted Wave.} The wave at the interface in medium 1 has the contribution of the incoming incident wave and the reflected one.
\begin{equation*}
\begin{split}\begin{aligned}
\mathbf{e}_1(\mathbf{r},t)
& = \mathbf{e}_i(\mathbf{r},t) + \mathbf{e}_r(\mathbf{r},t) = \\
& = \mathbf{E}_{i} e^{i \left( \mathbf{k}_i \cdot \mathbf{r} - \omega t \right)} + \mathbf{E}_{r} e^{i \left( \mathbf{k}_r \cdot \mathbf{r} - \omega t \right)} = \\
& = \left( \mathbf{E}_{i} e^{i \mathbf{k}_i \cdot \mathbf{r}} + \mathbf{E}_{r} e^{i \mathbf{k}_r \cdot \mathbf{r} } \right) e^{-i \omega t}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
with
\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{k}_i & = k_{i,n} \hat{\mathbf{n}} + k_{i,t} \hat{\mathbf{t}} \\
  \mathbf{k}_r & = k_{r,n} \hat{\mathbf{n}} + k_{r,t} \hat{\mathbf{t}} \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
At the interface, \(\mathbf{r}_s \cdot \hat{\mathbf{n}} = 0\), and thus
\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{e}_1(\mathbf{r}_s, t) & = \left( \mathbf{E}_i e^{i k_{i,t} x_t} + \mathbf{E}_r e^{i k_{r,t} x_t} \right) e^{-i\omega t} \\
  \mathbf{e}_2(\mathbf{r}_s, t) & =        \mathbf{E}_t e^{i k_{t,t} x_t} e^{-i \omega t} \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
In order for the boundary conditions to be satisfied at all the points of the interface at each time,
\begin{equation*}
\begin{split}k_{i,t} = k_{r,t} = k_{t,t} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Exploiting the relation between the pulsation, the wave\sphinxhyphen{}length, and the speed of light in media, \(c_a = \frac{\omega}{|\mathbf{k}_a|} = \frac{c}{n_a}\),
\begin{equation*}
\begin{split}|\mathbf{k}_i| = |\mathbf{k}_r| \qquad \rightarrow \qquad k_{r,n} = - k_{i,n}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\frac{|\mathbf{k}_2|}{|\mathbf{k}_1|} = \frac{c_1}{c_2}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\frac{k_{t,t}^2 + k_{t,n}^2}{k_{i,t}^2 + k_{i,n}^2} = \frac{c_1^2}{c_2^2}\end{split}
\end{equation*}\begin{equation*}
\begin{split}
\begin{aligned}
  k_{i,n} & = \ \ \ |\mathbf{k}_i| \, \cos \theta_i \\
  k_{r,n} & = -     |\mathbf{k}_r| \, \cos \theta_r \\
  k_{t,n} & = \ \ \ |\mathbf{k}_t| \, \cos \theta_t \\
\end{aligned}
\quad , \quad
\begin{aligned}
  k_{i,t} & = \ \ \ |\mathbf{k}_i| \, \sin \theta_i \\
  k_{r,t} & = \ \ \ |\mathbf{k}_r| \, \sin \theta_r \\
  k_{t,t} & = \ \ \ |\mathbf{k}_t| \, \sin \theta_t \\
\end{aligned}
\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{cases}
 E_n: & \quad \varepsilon_1   \left( E_{i,c} \sin \theta_i + E_{r,c} \sin \theta_r \right) = \varepsilon_2   E_{t,c} \sin \theta_{t} \\
 E_t: & \quad                        E_{i,c} \cos \theta_i - E_{r,c} \cos \theta_r         =                 E_{t,c} \cos \theta_{t} \\
 E_b: & \quad                        E_{i,b}               + E_{r,b}                       =                 E_{t,b}                 \\
 B_n: & \quad                        B_{i,c} \sin \theta_i + B_{r,c} \sin \theta_r         =                 B_{t,c} \sin \theta_{t} \\
 B_t: & \quad \frac{1}{\mu_1} \left( B_{i,c} \cos \theta_i - B_{r,c} \cos \theta_r \right) = \frac{1}{\mu_2} B_{t,c} \cos \theta_{t} \\
 B_b: & \quad \frac{1}{\mu_1} \left( B_{i,b}               + B_{r,b}               \right) = \frac{1}{\mu_2} B_{t,b}                 \\
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
Writing the magnetic field as a function of the wave\sphinxhyphen{}vector and the magnetic field, it’s possible to write 2 decoupled systems of equations
\begin{equation*}
\begin{split}\begin{cases}
 E_n: & \quad \varepsilon_1   \left( E_{i,c} \sin \theta_i + E_{r,c} \sin \theta_r \right) = \varepsilon_2   E_{t,c} \sin \theta_{t} \\
 E_t: & \quad                        E_{i,c} \cos \theta_i - E_{r,c} \cos \theta_r         =                 E_{t,c} \cos \theta_{t} \\
 B_b: & \quad \frac{1}{\mu_1} \left( \frac{E_{i,c}}{c_1}   + \frac{E_{r,c}}{c_1}   \right) = \frac{1}{\mu_2} \frac{E_{t,c}}{c_2}     \\
\end{cases}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{cases}
 E_b: & \quad                        E_{i,b}               + E_{r,b}                       =                 E_{t,b}                 \\
 B_n: & \quad                        \frac{E_{i,b}}{c_1} \sin \theta_i + \frac{E_{r,b}}{c_1} \sin \theta_r         =                 \frac{E_{t,b}}{c_2} \sin \theta_{t} \\
 B_t: & \quad \frac{1}{\mu_1} \left( \frac{E_{i,b}}{c_1} \cos \theta_i - \frac{E_{r,b}}{c_1} \cos \theta_r \right) = \frac{1}{\mu_2} \frac{E_{t,b}}{c_2} \cos \theta_{t} \\
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
The equations \(E_n\) and \(B_b\) are equivalent; \(E_b\) and \(B_n\) are equivalent as well, because of Snell’s law. Thus, defining
\begin{equation*}
\begin{split}
\begin{aligned}
  r_c & := \dfrac{E_{r,c}}{E_{i,c}} \\
  t_c & := \dfrac{E_{t,c}}{E_{i,c}} \\
\end{aligned}
\quad , \quad
\begin{aligned}
  r_b & := \dfrac{E_{r,b}}{E_{i,b}} \\
  t_b & := \dfrac{E_{t,b}}{E_{i,b}} \\
\end{aligned}
\end{split}
\end{equation*}
\sphinxAtStartPar
and \(\alpha_i := \frac{1}{\mu_i c_i}\). These systems of equations can be written as two uncoupled linear systems of equations,

\sphinxAtStartPar
(for P\sphinxhyphen{}polarization \sphinxstylestrong{todo} *change index from \(c\) to \(p\); for S\sphinxhyphen{}polarization \sphinxstylestrong{todo} \sphinxstyleemphasis{change index from \(b\) to \(s\)})
\begin{equation*}
\begin{split}
& \begin{cases}
 E_t: & \quad  \cos \theta_i -  \cos \theta_r \, r_c = \cos \theta_{t} \, t_c \\
 B_b: & \quad  \alpha_1      +  \alpha_1      \, r_c =  \alpha_2       \, t_c \\
\end{cases}
\\
& \begin{cases}
 E_b: & \quad                          1 +                   r_b =  t_b \\
 B_t: & \quad  \alpha_1 \, \cos \theta_i -  \alpha_1 \, \cos \theta_r \, r_b = \alpha_2 \, \cos \theta_{t} \, t_b \\
\end{cases}
\end{split}
\end{equation*}
\sphinxAtStartPar
Calling \(\theta_i = \theta_r = \theta_1\), \(\theta_2 = \theta_t\), these linear systems can be written using matrix formalism,
\begin{equation*}
\begin{split}
& \begin{bmatrix} -1 & 1 \\ 1 & \frac{\alpha_2}{\alpha_1} \frac{\cos \theta_2}{\cos \theta_1} \end{bmatrix}
 \begin{bmatrix} r_b \\ t_b \end{bmatrix} = \begin{bmatrix} 1 \\ 1 \end{bmatrix}
\\
& \begin{bmatrix} 1 & \frac{\cos \theta_2}{\cos \theta_1} \\ -1 & \frac{\alpha_2}{\alpha_1} \end{bmatrix}
 \begin{bmatrix} r_c \\ t_c \end{bmatrix} = \begin{bmatrix} 1 \\ 1 \end{bmatrix}
\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{todo} \sphinxstyleemphasis{Analysis of the total reflection, forcing \(t_x = 0\). Check signs before}
\begin{equation*}
\begin{split}
\begin{bmatrix} 1 & \frac{\cos \theta_2}{\cos \theta_1} \\ -1 & \frac{\alpha_2}{\alpha_1} \end{bmatrix}
 \begin{bmatrix} r_c \\ t_c \end{bmatrix} = \begin{bmatrix} 1 \\ 1 \end{bmatrix}
\qquad \rightarrow \qquad
\begin{bmatrix} r_c \\ t_c \end{bmatrix} = \dfrac{1}{\frac{\alpha_2}{\alpha_1} + \frac{\cos \theta_2}{\cos \theta_1}} \begin{bmatrix} \frac{\alpha_2}{\alpha_1} & - \frac{\cos \theta_2}{\cos \theta_1} \\ 1 & 1  \end{bmatrix} \begin{bmatrix} 1 \\ 1 \end{bmatrix}
= \begin{bmatrix} \frac{\alpha_2 \cos \theta_1 - \alpha_1 \cos \theta_2}{\alpha_2 \cos \theta_1 + \alpha_1 \cos \theta_2} \\ \frac{2 \alpha_1 \cos \theta_1}{\alpha_2 \cos \theta_1 + \alpha_1 \cos \theta_2} \end{bmatrix}
\end{split}
\end{equation*}\begin{equation*}
\begin{split}
\begin{bmatrix} -1 & 1 \\ 1 & \frac{\alpha_2}{\alpha_1} \frac{\cos \theta_2}{\cos \theta_1} \end{bmatrix}
 \begin{bmatrix} r_b \\ t_b \end{bmatrix} = \begin{bmatrix} 1 \\ 1 \end{bmatrix}
\qquad \rightarrow \qquad
\begin{bmatrix} r_b \\ t_b \end{bmatrix} = \dfrac{1}{-\frac{\alpha_2}{\alpha_1} \frac{\cos \theta_2}{\cos \theta_1} - 1} \begin{bmatrix}  \frac{\alpha_2}{\alpha_1} \frac{\cos \theta_2}{\cos \theta_1} & -1 \\ -1 & -1  \end{bmatrix} \begin{bmatrix} 1 \\ 1 \end{bmatrix}
= \begin{bmatrix} \frac{\alpha_1 \cos \theta_1 - \alpha_2 \cos \theta_2}{\alpha_1 \cos \theta_1 + \alpha_2 \cos \theta_2} \\ \frac{2 \alpha_1 \cos \theta_1}{\alpha_1 \cos \theta_1 + \alpha_2 \cos \theta_2} \end{bmatrix}
\end{split}
\end{equation*}


\sphinxAtStartPar
that can be recast with the wave impedance \(Z\),
\begin{equation*}
\begin{split}\alpha_1 = \frac{1}{\mu_1 c_1} = \frac{\sqrt{\mu_1 \varepsilon_1}}{\mu_1} = \sqrt{\dfrac{\varepsilon_1}{\mu_1}} =: \frac{1}{Z_1} \ ,\end{split}
\end{equation*}\begin{equation*}
\begin{split}
\begin{bmatrix} r_c \\ t_c \end{bmatrix} = \begin{bmatrix} \frac{Z_1 \cos \theta_1 - Z_2 \cos \theta_2}{Z_1 \cos \theta_1 + Z_2 \cos \theta_2} \\ \frac{2 Z_2 \cos \theta_1}{Z_1 \cos \theta_1 + Z_2 \cos \theta_2} \end{bmatrix}
\end{split}
\end{equation*}\begin{equation*}
\begin{split}
\begin{bmatrix} r_b \\ t_b \end{bmatrix} = \begin{bmatrix} \frac{Z_2 \cos \theta_1 - Z_1 \cos \theta_2}{Z_2 \cos \theta_1 + Z_1 \cos \theta_2} \\ \frac{2 Z_2 \cos \theta_1}{Z_2 \cos \theta_1 + Z_1 \cos \theta_2} \end{bmatrix}
\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Energy Balance and Transmission Coefficients.} Energy balance for a domain collapsing on the interface reduces to power flux balance, namely
\begin{equation*}
\begin{split}\oint_{\partial V} \mathbf{s} \cdot \hat{\mathbf{n}} = 0 \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
with \(\mathbf{s} = \mathbf{e} \times \mathbf{h}\) the Poynting vector. For harmonic plane waves,
\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{s}(\mathbf{r},t)
  & = \mathbf{e}(\mathbf{r},t) \times \mathbf{h}(\mathbf{r},t) = \\
  & = \frac{1}{\mu} \left[ \mathbf{E} e^{i(\mathbf{k} \cdot \mathbf{r} - \omega t)} + \mathbf{E}^* e^{-i(\mathbf{k} \cdot \mathbf{r} - \omega t)} \right] \times \left[ \mathbf{B} e^{i(\mathbf{k} \cdot \mathbf{r} - \omega t)} + \mathbf{B}^* e^{-i(\mathbf{k} \cdot \mathbf{r} - \omega t)}  \right] = \\
  & = \frac{1}{\mu} \left[ \, \mathbf{E} \times \mathbf{B} \, e^{i 2(\mathbf{k} \cdot \mathbf{r} - \omega t)} + c.c. \, \right] + \frac{1}{\mu} \left[ \, \mathbf{E} \times \mathbf{B}^* + c.c. \, \right] = \\
  & = \dots + \frac{1}{\mu} \mathbf{E} \times \left( \frac{1}{c} \hat{\mathbf{k}} \times \mathbf{E} \right)^* = \\
  & = \dots + \frac{1}{\mu c} \left( \mathbf{E} \cdot \mathbf{E}^* \right) \hat{\mathbf{k}} = \\
  & = \dots + \frac{1}{\mu c} | \mathbf{E} |^2 \hat{\mathbf{k}} \ .
  & = \dots + \alpha | \mathbf{E} |^2 \hat{\mathbf{k}} \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
For each one of the two polarizations, the following holds (\(\cos \theta\) comes from the dot product \(\hat{k} \cdot \hat{n}\) appearing in the surface integral),
\begin{equation*}
\begin{split}\alpha_1 \cos \theta_1 = \alpha_1 r_x^2 \, \cos \theta_1 + \alpha_2 t_x^2 \, \cos \theta_2 \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
i.e., the sum of reflected and transmitted power equals the incident power.
\subsubsection*{Proof of the power balance, for P\sphinxhyphen{}polarization}

\sphinxAtStartPar
\sphinxstylestrong{todo} Here \(P\) is index \(c\)

\sphinxAtStartPar
Dividing by \(\alpha_1 \cos  \theta_1\)
\begin{equation*}
\begin{split}\begin{aligned}
 & \frac{1}{\alpha_1 \cos \theta_1} \left( \alpha_1 r_p^2 \, \cos \theta_1 + \alpha_2 t_p^2 \, \cos \theta_2 \right) = \\
 & = \frac{\left(\alpha_1 \cos \theta_1 - \alpha_2 \cos \theta_2\right)^2}{\left(\alpha_1 \cos \theta_1 + \alpha_2 \cos \theta_2\right)^2} + \frac{\alpha_2 \cos \theta_2}{\alpha_1 \cos \theta_1} \frac{\left( 2 \alpha_1 \cos \theta_1 \right)^2}{\left( \alpha_1 \cos \theta_1 + \alpha_2 \cos \theta_2 \right)^2} = \\
  & = \dfrac{1}{\left( \alpha_1 \cos \theta_1 + \alpha_2 \cos \theta_2 \right)^2} \left[ \alpha_1^2 \cos^2 \theta_1 - 2 \alpha_1 \alpha_2 \cos \theta_1 \cos \theta_2 + \alpha_2^2 \cos^2 \theta_2 + 4 \alpha_1 \alpha_2 \cos \theta_1 \cos \theta_2 \right] = \\
  & = 1 \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxstepscope


\chapter{Force, moments, energy and momentum in electromagnetism}
\label{\detokenize{ch/energy:force-moments-energy-and-momentum-in-electromagnetism}}\label{\detokenize{ch/energy:classical-electromagnetism-energy}}\label{\detokenize{ch/energy::doc}}
\sphinxstepscope


\section{Energy and momentum balance in linear, local, isotropic, non\sphinxhyphen{}dispersive media}
\label{\detokenize{ch/energy-momentum-balance:energy-and-momentum-balance-in-linear-local-isotropic-non-dispersive-media}}\label{\detokenize{ch/energy-momentum-balance:classical-electromagnetism-energy}}\label{\detokenize{ch/energy-momentum-balance::doc}}\begin{equation*}
\begin{split}\begin{cases}
  \mathbf{d} = \varepsilon_0 \mathbf{e} + \mathbf{p} \\
  \mathbf{h} = \dfrac{1}{\mu_0} \mathbf{b} - \mathbf{m} \ .
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
with
\begin{equation*}
\begin{split}\mathbf{d} = \varepsilon \mathbf{e} \qquad , \qquad \mathbf{h} = \dfrac{\mathbf{b}}{\mu}\end{split}
\end{equation*}
\sphinxAtStartPar
Let \(r\) be mass density, and \(\vec{v}\) be charge velocity field, the equation of motion \sphinxhyphen{} momentum equation \sphinxhyphen{} of electric charges reads
\begin{equation*}
\begin{split}r \frac{D \mathbf{v}}{D t} = \mathbf{f} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and the kinetic energy equation becomes
\begin{equation*}
\begin{split}\mathbf{v} \cdot \mathbf{f} = r \mathbf{v} \cdot \frac{D \mathbf{v}}{D t} = r \dfrac{D}{Dt} \dfrac{|\mathbf{v}|^2}{2} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
or using continuity equation for \(r\), it can be recast in conservative form. The same term can be recast using the expression of Lorentz’s force on electric charges in electromagnetic field (\sphinxstylestrong{is this the right way to evaluate power of bounded charges and currents? check it!})
\begin{equation*}
\begin{split}\mathbf{v} \cdot \mathbf{f} = \mathbf{v} \cdot \left[ \rho ( \mathbf{e} - \mathbf{b} \times \mathbf{v} ) \right] = \rho \mathbf{v} \cdot \mathbf{e} = \mathbf{e} \cdot \mathbf{j} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and furthered manipulated writing \(\mathbf{j} = \mathbf{j}_f + \mathbf{j}_p + \mathbf{j}_m\) and using Maxwell’s equations
\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{e} \cdot \mathbf{j} 
  & = \mathbf{e} \cdot \left( \mathbf{j}_f + \mathbf{j}_p + \mathbf{j}_m \right) = \\
  & = \mathbf{e} \cdot \left( \nabla \times \mathbf{h} - \partial_t \mathbf{d} \right) + \mathbf{e} \cdot \partial_t \mathbf{p} + \mathbf{e} \cdot \nabla \times \mathbf{m} = \\
  & = \mathbf{e} \cdot \nabla \times \left( \mathbf{h} + \mathbf{m} \right) - \mathbf{e} \cdot \partial_t \left( \mathbf{d} - \mathbf{p} \right)  = \\
  & = \dfrac{1}{\mu_0} \mathbf{e} \cdot \nabla \times \mathbf{b} - \varepsilon_0 \mathbf{e} \cdot \partial_t \mathbf{e} = \\
  & = - \dfrac{1}{\mu_0} \nabla \cdot \left( \mathbf{e} \times \mathbf{b} \right) - \dfrac{\mathbf{b}}{\mu_0} \cdot \partial_t \mathbf{b} - \varepsilon_0 \mathbf{e} \cdot \partial_t \mathbf{e} = \\
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{e} \cdot \nabla \times \mathbf{h} = e_i \varepsilon_{ijk} \partial_j h_k = \partial_j \left( \varepsilon_{jki} h_k e_i \right) - \varepsilon_{ijk} h_k \partial_j e_i = - \nabla \cdot (\mathbf{e} \times \mathbf{h} ) + \mathbf{h} \cdot \nabla \times \mathbf{e} = - \nabla \cdot (\mathbf{e} \times \mathbf{h} ) - \mathbf{h} \cdot \partial_t \mathbf{b}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{e} \cdot \mathbf{j}_f & = - \nabla \cdot ( \mathbf{e} \times \mathbf{h} ) - \mathbf{e} \cdot \partial_t \mathbf{d} - \mathbf{h} \cdot \partial_t \mathbf{b}
\end{aligned}\end{split}
\end{equation*}

\subsection{Linear media \sphinxhyphen{} energy}
\label{\detokenize{ch/energy-momentum-balance:linear-media-energy}}
\sphinxAtStartPar
For linear media, the energy of the electromagnetic field per unit volume reads
\begin{equation*}
\begin{split}u = \dfrac{1}{2} \left( \mathbf{e} \cdot \mathbf{d} + \mathbf{h} \cdot \mathbf{b} \right)\end{split}
\end{equation*}
\sphinxAtStartPar
so that the differential balance equation for the eneergy of the electromagnetic field becomes
\begin{equation*}
\begin{split}\begin{aligned}
 \partial_t u + \nabla \cdot \mathbf{s} = - \mathbf{e} \cdot \mathbf{j} \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
with Poynting vector \(\mathbf{s} := \mathbf{e} \times \mathbf{h}\), namely the momentum density of the electromagnetic field.


\subsection{Linear media \sphinxhyphen{} momentum}
\label{\detokenize{ch/energy-momentum-balance:linear-media-momentum}}\begin{equation*}
\begin{split}\partial_t \mathbf{s} = \partial_t s_i = \partial_t \left( \varepsilon_{ijk} e_j h_k \right)\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  \varepsilon_{ijk} \partial_t e_j h_k
  & = \dfrac{1}{\varepsilon} \varepsilon_{ijk} \partial_t d_j h_k \\
  & = \dfrac{1}{\varepsilon} \varepsilon_{ijk} \left(\varepsilon_{jlm} \partial_l h_m - j^f_j \right) h_k \\
  & = - \dfrac{1}{\varepsilon} \varepsilon_{ijk} \, j^f_j \, h_k + \dfrac{1}{\varepsilon} \varepsilon_{ijk} \varepsilon_{jlm} h_k \partial_l h_m \\
  & = - \dfrac{1}{\varepsilon} \varepsilon_{ijk} \, j^f_j \, h_k + \dfrac{1}{\varepsilon} \left( \delta_{im} \delta_{kl} - \delta_{il} \delta_{km} \right) h_k \partial_l h_m =  \\
  & = - \dfrac{1}{\varepsilon} \varepsilon_{ijk} \, j^f_j \, h_k + \dfrac{1}{\varepsilon} \left( h_m \partial_m h_i - h_m \partial_i h_m \right) =  \\
  & = - \dfrac{1}{\varepsilon} \varepsilon_{ijk} \, j^f_j \, h_k + \dfrac{1}{\varepsilon} \left[ \partial_m ( h_m  h_i ) - \partial_m h_m \, h_i - \partial_i \left( \frac{h_m h_m}{2} \right) \right] =  \\
  & = \dfrac{1}{\varepsilon \mu} \varepsilon_{ijk} \, b_j \, j^f_k + \dfrac{1}{\varepsilon \mu} \left[ \partial_m ( b_m  h_i ) - \underbrace{\partial_m b_m}_{=0} \, h_i - \partial_i \left( \frac{h_m b_m}{2} \right) \right] =  \\
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  \varepsilon_{ijk} e_j \partial_t h_k
  & =   \dfrac{1}{\mu} \varepsilon_{ijk} e_j \partial_t b_k = \\
  & = - \dfrac{1}{\mu} \varepsilon_{ijk} e_j \left( \varepsilon_{klm} \partial_l e_m \right) = \\
  & = - \dfrac{1}{\mu} \left( \delta_{il} \delta_{jm} - \delta_{im} \delta_{jl} \right) e_j \partial_l e_m =  \\
  & = - \dfrac{1}{\mu} \left( e_m \partial_i e_m - e_m \partial_m e_i \right) =  \\
  & = - \dfrac{1}{\mu} \left[ \partial_i \left(\frac{e_m e_m}{2}\right) -  \partial_m \left( e_m e_i \right) + \partial_m e_m \, e_i \right] = \\
  & = - \dfrac{1}{\varepsilon \mu} \left[ \partial_i \left(\frac{d_m e_m}{2}\right) - \partial_m \left( d_m e_i \right) + \rho^f \, e_i \right] \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
so that
\begin{equation*}
\begin{split}\partial_t s_i + c^2 \partial_m \left[ \dfrac{1}{2}\left( d_n e_n + h_n b_n \right) \delta_{mi} - \left( h_m b_i + d_m e_i \right) \right] = - c^2 \rho^f e_i + c^2 \varepsilon_{ijk} b_j j_k^f \end{split}
\end{equation*}
\sphinxAtStartPar
or
\begin{equation*}
\begin{split}\partial_t \mathbf{s} + c^2 \nabla \cdot \left[ \, \dfrac{1}{2} \left( \mathbf{d} \cdot \mathbf{e} + \mathbf{h} \cdot \mathbf{b} \right) \mathbb{I} - \left( \mathbf{d} \otimes \mathbf{e} + \mathbf{h} \otimes \mathbf{b} \right) \, \right] = - c^2 \left( \rho^f \mathbf{e} - \mathbf{b} \times \mathbf{j}^f \right)\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{cases}
& \partial_t u + \nabla \cdot \mathbf{s} = - \mathbf{e} \cdot \mathbf{j}^f \\
& \partial_t \mathbf{s} + c^2 \nabla \cdot \left[ \, u \mathbb{I} - \left( \mathbf{d} \otimes \mathbf{e} + \mathbf{h} \otimes \mathbf{b} \right) \, \right] = - c^2 \left( \mathbf{e} \, \rho^f - \mathbf{b} \times \mathbf{j}^f \right)
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{todo} \sphinxstyleemphasis{use this system to derive the 4\sphinxhyphen{}d formulation of special relativity in modern physics}

\sphinxstepscope




\section{Force, moment, and power on elementary charge distributions}
\label{\detokenize{ch/forces-moments-on-charges:force-moment-and-power-on-elementary-charge-distributions}}\label{\detokenize{ch/forces-moments-on-charges:classical-electromagnetism-forces-moments}}\label{\detokenize{ch/forces-moments-on-charges::doc}}

\subsection{Force, moment and power on a point electric charge}
\label{\detokenize{ch/forces-moments-on-charges:force-moment-and-power-on-a-point-electric-charge}}
\sphinxAtStartPar
Point electric charge with charge \(q\) in a point \(\vec{r}_P(t)\) at time \(t\) where electromagnetic field is \(\vec{e}(\vec{r},t)\), \(\vec{b}(\vec{r},t)\):
\begin{itemize}
\item {} 
\sphinxAtStartPar
Lorentz’s force
\begin{equation*}
\begin{split}\vec{F} = q \left( \vec{e}(\vec{r}_P(t), t) - \vec{b}(\vec{r}_P(t),t) \times \vec{v}_P(t) \right) \ ,\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
zero moment, since it has no dimension (and assumed uniform or symmetric or… distribution of electric charge)

\item {} 
\sphinxAtStartPar
power
\begin{equation*}
\begin{split}\begin{aligned}
     P & = \vec{v}_P(t) \cdot \vec{F} = \\
       & = \vec{v}_P(t) \cdot \, q \, \left( \vec{e}(\vec{r}_P(t), t) - \vec{b}(\vec{r}_P(t), t) \times \vec{v}_P(t) \right) = q \, \vec{v}_P(t) \cdot \vec{e}(\vec{r}_P(t),t) \ .
   \end{aligned}\end{split}
\end{equation*}
\end{itemize}


\subsection{Force, moment and power on a electric dipole}
\label{\detokenize{ch/forces-moments-on-charges:force-moment-and-power-on-a-electric-dipole}}
\sphinxAtStartPar
Electric dipole with center \(\vec{r}_C(t)\), axis \(\vec{\ell}\), so that the positive charge \(q\) is in \(P_+ = C + \dfrac{\vec{\ell}}{2}\) and the negative charge is in \(P_- = C - \dfrac{\vec{\ell}}{2}\), with \(q \rightarrow +\infty\), \(|\vec{\ell}| \rightarrow 0\), s.t. \(q|\vec{\ell}| = |\vec{d}|\) finite.

\sphinxAtStartPar
\sphinxstylestrong{Kinematics and expansion of the field}
\begin{equation*}
\begin{split}\vec{v}_{\pm} = \vec{v}_C \pm \vec{\omega} \times \frac{\vec{\ell}}{2}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\vec{e}(P_{\pm}) = \vec{e}\left( C \pm \dfrac{\vec{\ell}}{2} \right) = \vec{e}(C) \pm \dfrac{\vec{\ell}}{2} \cdot \nabla \vec{e}(C) + o(|\vec{\ell}|)\end{split}
\end{equation*}\begin{equation*}
\begin{split}\vec{b}(P_{\pm}) = \vec{b}\left( C \pm \dfrac{\vec{\ell}}{2} \right) = \vec{b}(C) \pm \dfrac{\vec{\ell}}{2} \cdot \nabla \vec{b}(C) + o(|\vec{\ell}|)\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Net force.}
\begin{equation*}
\begin{split}\begin{aligned}
  \vec{F} & = \vec{F}_+ + \vec{F}_- = \\
   & = q \left[ \vec{e}(P_+) - \vec{b}(P_+) \times \vec{v}_{+} \right] - q \left[ \vec{e}(P_-) - \vec{b}(P_-) \times \vec{v}_{-} \right] = \\
   & = q \left[ \vec{e}_C + \dfrac{\vec{\ell}}{2} \cdot \nabla \vec{e}_C - \left( \vec{b}_C + \dfrac{\vec{\ell}}{2} \cdot \nabla \vec{b}_C \right) \times \left( \vec{v}_C + \vec{\omega} \times \dfrac{\vec{\ell}}{2} \right) \right] + \\ 
   & - q \left[ \vec{e}_C - \dfrac{\vec{\ell}}{2} \cdot \nabla \vec{e}_C - \left( \vec{b}_C - \dfrac{\vec{\ell}}{2} \cdot \nabla \vec{b}_C \right) \times \left( \vec{v}_C - \vec{\omega} \times \dfrac{\vec{\ell}}{2} \right) \right] = \\
   & = q \vec{\ell} \cdot \nabla \vec{e}(C) - \left( q \vec{\ell} \cdot \nabla \vec{b}(C) \right) \times \vec{v}_C + \vec{b}(C) \times \left(  \vec{\omega} \times q \vec{\ell} \right) + o(|\vec{\ell}|)
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Net moment, w.r.t. \(C\).}
\begin{equation*}
\begin{split}\begin{aligned}
  \vec{M}_C
   & = \frac{\vec{\ell}}{2} \times \vec{F}_+ - \frac{\vec{\ell}}{2} \times \vec{F}_- = \\
   & = q \frac{\vec{\ell}}{2} \times \left[ \vec{e}(P_+) - \vec{b}(P_+) \times \vec{v}_{+} \right] + q \frac{\vec{\ell}}{2} \times \left[ \vec{e}(P_-) - \vec{b}(P_-) \times \vec{v}_{-} \right] = \\
   & = q \frac{\vec{\ell}}{2} \times \left[ \vec{e}_C + \dfrac{\vec{\ell}}{2} \cdot \nabla \vec{e}_C - \left( \vec{b}_C + \dfrac{\vec{\ell}}{2} \cdot \nabla \vec{b}_C \right) \times \left( \vec{v}_C + \vec{\omega} \times \dfrac{\vec{\ell}}{2} \right) \right] + \\ 
   & + q \frac{\vec{\ell}}{2} \times \left[ \vec{e}_C - \dfrac{\vec{\ell}}{2} \cdot \nabla \vec{e}_C - \left( \vec{b}_C - \dfrac{\vec{\ell}}{2} \cdot \nabla \vec{b}_C \right) \times \left( \vec{v}_C - \vec{\omega} \times \dfrac{\vec{\ell}}{2} \right) \right] = \\
   & = q \vec{\ell} \times \left[ \vec{e}_C - \vec{b}_C \times \vec{v}_C \right] + o(|\vec{\ell}|) \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Power.}
\begin{equation*}
\begin{split}\begin{aligned}
  P & = P_+ + P_- = \\
  & = \vec{F}_+ \cdot \vec{v}_+ + \vec{F}_- \cdot \vec{v}_- = \\
  & = q \, \left[ \vec{e}(P_+) - \vec{b}(P_+) \times \vec{v}_{+}  \right] \cdot \vec{v}_{+} 
    - q \, \left[ \vec{e}(P_-) - \vec{b}(P_-) \times \vec{v}_{-}  \right] \cdot \vec{v}_{-} = \\
  & = q \, \vec{e}(P_+) \cdot \vec{v}_{+} 
    - q \, \vec{e}(P_-) \cdot \vec{v}_{-} = \\
  & = q \, \left[ \vec{e}_C + \dfrac{\vec{\ell}}{2} \cdot \nabla \vec{e}_C  \right] \cdot \left[ \vec{v}_C + \vec{\omega} \times \dfrac{\vec{\ell}}{2} \right] 
    - q \, \left[ \vec{e}_C - \dfrac{\vec{\ell}}{2} \cdot \nabla \vec{e}_C  \right] \cdot \left[ \vec{v}_C - \vec{\omega} \times \dfrac{\vec{\ell}}{2} \right] = \\
  & = \vec{e}_C \cdot \left( \vec{\omega} \times q \vec{\ell} \right) + \left( q \vec{\ell} \cdot \nabla \vec{e}_C \right) \cdot \vec{v}_C + o(|\vec{\ell}|^2) \ .
\end{aligned}\end{split}
\end{equation*}

\subsection{Force, moment and power on a magnetic dipole}
\label{\detokenize{ch/forces-moments-on-charges:force-moment-and-power-on-a-magnetic-dipole}}
\sphinxAtStartPar
On an elementary magnetic dipole, modeled as a “small” circuit with current \(i\) enclosing area \(S\) and center \(C\), with \(S \rightarrow 0\), \(i \rightarrow + \infty\) so that \(i S \hat{n} := \vec{m}\) finite

\sphinxAtStartPar
\sphinxstylestrong{Force.}
\begin{equation*}
\begin{split}\dots\end{split}
\end{equation*}\begin{equation*}
\begin{split}\vec{F} = \nabla \vec{b}(C) \cdot \vec{m}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Moment.}
\begin{equation*}
\begin{split}\dots\end{split}
\end{equation*}\begin{equation*}
\begin{split}\vec{M}_C = \vec{m} \times \vec{b}(C)\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Power.}
\begin{equation*}
\begin{split}P = \vec{v}_C \cdot \nabla \vec{b}(C) \cdot \vec{m} + \vec{\omega} \cdot \vec{m} \times \vec{b}(C) \ .\end{split}
\end{equation*}

\subsection{Energy balance}
\label{\detokenize{ch/forces-moments-on-charges:energy-balance}}
\sphinxAtStartPar
\sphinxstylestrong{todo} \sphinxstyleemphasis{Check and put charges, currents, and dipoles together with the electromagnetic field}

\sphinxAtStartPar
Ispirati dalle dimensioni fisiche dei campi elettromagnetici,
\begin{equation*}
\begin{split}\begin{aligned}
\left[\mathbf{e}\right] = \frac{\text{force}}{\text{charge}} \qquad & , \qquad
[\mathbf{d}] = \frac{\text{charge}}{\text{length}^2} \\
[\mathbf{b}] = \frac{\text{force}\cdot\text{time}}{\text{charge}\cdot\text{length}} \qquad & , \qquad
[\mathbf{h}] = \frac{\text{charge}}{\text{time} \cdot \text{length}}
\end{aligned}\end{split}
\end{equation*}



\begin{equation*}
\begin{split}\begin{aligned}
\left[\mathbf{e} \cdot \mathbf{d}\right] & = \frac{\text{force}}{\text{length}^2} = \frac{\text{energy}}{\text{length}^3} = [u] \\
[\mathbf{b} \cdot \mathbf{h}] & = \frac{\text{force}}{\text{length}^2} = \frac{\text{energy}}{\text{length}^3} = [u]
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
si può costruire la densità di volume di energia  (\sphinxstylestrong{todo} trovare motivazioni più convincenti, non basandosi solo sull’analisi dimensionale ma sul lavoro)
\begin{equation*}
\begin{split}u = \frac{1}{2} \left( \mathbf{e} \cdot \mathbf{d} + \mathbf{b} \cdot \mathbf{h} \right) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Si può calcolare la derivata parziale nel tempo della densità di energia, \(u\), e usare le equazioni di Maxwell per ottenere un’equazione di bilancio dell’energia del campo elettromagnetico. Per un mezzo isotropo lineare, per il quale valgono le equazioni costitutive \(\mathbf{d} = \varepsilon \mathbf{e}\), \(\mathbf{b} = \mu \mathbf{h}\), la derivata parziale nel tempo dell’energia elettromagnetica può essere riscritta sfuttando la regola di derivazione del prodotto e le equazioni di Faraday\sphinxhyphen{}Lenz\sphinxhyphen{}Neumann e Ampére\sphinxhyphen{}Maxwell,
\begin{equation*}
\begin{split}\begin{aligned}
\dfrac{\partial u}{\partial t} & = \dfrac{\partial}{\partial t}\left( \frac{1}{2} \mathbf{e} \cdot \mathbf{d} + \mathbf{b} \cdot \mathbf{h} \right) =  \qquad (...) \\
& = \mathbf{e} \cdot \partial_t \mathbf{d} + \mathbf{h} \cdot \partial_t \mathbf{b} = \\
& = \mathbf{e} \cdot (\nabla \times \mathbf{h} - \mathbf{j}) - \mathbf{h} \cdot \nabla \times \mathbf{e} \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
L’ultimo termine può essere ulteriormente manipolato, usando l’identità vettoriale
\begin{equation*}
\begin{split}\begin{aligned}
\mathbf{e} \cdot \nabla \times \mathbf{h} - \mathbf{h} \cdot \nabla \times \mathbf{e} & = e_i \varepsilon_{ijk} \partial_j h_k - h_i \varepsilon_{ijk} \partial_j e_k = \qquad (i \rightarrow k, k \rightarrow i)\\
& = e_i \varepsilon_{ijk} \partial_j h_k - h_k \varepsilon_{kji} \partial_j e_i = \\
& = e_i \varepsilon_{ijk} \partial_j h_k + h_k \varepsilon_{ijk} \partial_j e_i = \\
& =  \partial_j (\varepsilon_{ijk} e_i  h_k ) = \\
& =  \partial_j (\varepsilon_{jki} e_i  h_k ) = \\
& = \nabla \cdot (\mathbf{h} \times \mathbf{e}) = - \nabla \cdot (\mathbf{e} \times \mathbf{h})
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
che permette di scrivere l’equazione del bilancio di energia elettromagnetica come,
\begin{equation*}
\begin{split}\frac{\partial u }{\partial t} + \nabla \cdot \mathbf{s} = - \mathbf{e} \cdot \mathbf{j} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
dove è stato definito il \sphinxstylestrong{vettore di Poynting}, o meglio il campo vettoriale di Poynting,
\begin{equation*}
\begin{split}\mathbf{s}(\mathbf{r},t) := \mathbf{e}(\mathbf{r},t) \times \mathbf{h}(\mathbf{r},t) \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
che può essere identificato come un flusso di potenza per unità di superficie, comparendo sotto l’operatore di divergenza nel bilnacio di energia.

\sphinxAtStartPar
\sphinxstylestrong{todo.} Rimandare a una sezione in cui si mostra questa ultima affermazione passando dal bilancio differenziale al bilancio integrale e si usa il teorema della divergenza, \(\int_V \nabla \cdot \mathbf{s} = \oint_{\partial V} \mathbf{s} \cdot \hat{\mathbf{n}}\).
\subsubsection*{Bilancio di energia di cariche nel vuoto, o i materiali senza polarizzazione o magnetizzazione}

\sphinxAtStartPar
\sphinxstylestrong{Moto di cariche puntiformi.}
L’equazione del moto di carica puntiforme \(q_k\) nella posizione \(\mathbf{r}_k(t)\) al tempo \(t\) è
\begin{equation*}
\begin{split}m_k \ddot{\mathbf{r}}_k = \mathbf{f}_k + \mathbf{f}_k^{em} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
avendo riconosciuto i contributi di forza dovuti al campo elettromagnetico come \(\mathbf{f}_k^{em}\) dagli altri. L’espressione della forza dovuta al campo elettromagnetico sulla carica \(k\) è data dalla forza di Lorentz,
\begin{equation*}
\begin{split}\mathbf{f}_k^{em}(t) = q_k \left[ \mathbf{e}(\mathbf{r_k}(t), t) - \mathbf{b}(\mathbf{r}_k(t), t) \times \dot{\mathbf{r}}_k(t) \right]\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Continuità della carica elettrica.} La densità di carica e di corrente elettrica di un insieme di cariche libere puntiformi macroscopiche può essere scritta come
\begin{equation*}
\begin{split}\begin{aligned}
  \rho(\mathbf{r},t) & = \sum_k q_k \delta(\mathbf{r} - \mathbf{r}_k(t)) \\
  \mathbf{j}(\mathbf{r},t) & = \sum_k q_k \dot{\mathbf{r}}_k(t) \delta(\mathbf{r} - \mathbf{r}_k(t)) \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
L’equazione di continuità della carica, \(\partial_t \rho + \nabla \cdot \mathbf{j} = 0\), risulta quindi soddisfatta,
\begin{equation*}
\begin{split}\begin{aligned}
  \partial_t \rho &  = - \sum_k q_k \, \partial_i \delta(\mathbf{r} - \mathbf{r}_k(t)) \, \dot{r}_{k,i} \\
  \partial_i j_i  &  =   \sum_k q_k \, \dot{r}_{k,i} \, \partial_i \delta(\mathbf{r} - \mathbf{r}_k(t)) \\
\end{aligned}\end{split}
\end{equation*}\subsubsection*{Procedimento alternativo (e più generale?)}

\sphinxAtStartPar
\sphinxstylestrong{todo} \sphinxstyleemphasis{In caso questo procedimento sia più generale, o più corretto, sostituire il procedimento precedente.}

\sphinxAtStartPar
La carica elementare in un volumetto \(\Delta V\) è data da dal prodotto tra il volume e la densità volumetrica di carica, \(\rho \Delta V\); la velocità media locale della carica elettrica è \(\mathbf{v}\); la forza agente sulla carica elementare immersa in un campo elettromagnetico è determinata dalla formula di Lorentz, \(\mathbf{f} \Delta V = \Delta V \rho \left( \mathbf{e} - \mathbf{b} \times \mathbf{v} \right)\). La potenza di questa forza è il prodotto scalare con la velocità media delle cariche, \(\Delta V \mathbf{f} \cdot \mathbf{v}\)

\sphinxAtStartPar
La potenza del campo elettromagnetico sul moto della carica elettrica per unità di volume è quindi
\begin{equation*}
\begin{split}\mathbf{v} \cdot \mathbf{f} = \rho \mathbf{v} \cdot \left( \mathbf{e} - \mathbf{b} \times \mathbf{v} \right) = \rho \mathbf{v} \cdot \mathbf{e} = \mathbf{j} \cdot \mathbf{e} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{todo}
\begin{itemize}
\item {} 
\sphinxAtStartPar
discutere questo termine del bilancio di energia cinetica nel moto della carica elettrica

\item {} 
\sphinxAtStartPar
questo termine compare con segno opposto nel bilancio dell’energia elettromagnetica del sistema

\item {} 
\sphinxAtStartPar
dove compare la non\sphinxhyphen{}conservatività del problema in presenza di materiali dissipativi (come resistenza elettrica con \(\mathbf{e} = \rho_R \mathbf{j}\)?

\end{itemize}

\sphinxAtStartPar
Il termine \(\mathbf{e} \cdot \mathbf{j}\) può essere manipolato usando le equazioni di Maxwell, e le relazioni
\begin{equation*}
\begin{split}\begin{cases}
  \mathbf{d} = \varepsilon_0 \mathbf{e} + \mathbf{p} \\
  \mathbf{h} = \frac{\mathbf{b}}{\mu_0} - \mathbf{m} \\
\end{cases}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{e} \cdot \mathbf{j} 
    & = \mathbf{e} \cdot \left( \nabla \times \mathbf{h} - \partial_t \mathbf{d} \right) = \\
    & = - \nabla \cdot \left( \mathbf{e} \times \mathbf{h} \right) + \mathbf{h} \cdot \nabla \times \mathbf{e} - \mathbf{e} \cdot \partial_t \mathbf{d} = \\
    & = - \nabla \cdot \left( \mathbf{e} \times \mathbf{h} \right) - \mathbf{h} \cdot \partial_t \mathbf{b} - \mathbf{e} \cdot \partial_t \mathbf{d} 
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Gli ultimi due termini possono essere manipolati in diverse maniere,
\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{e} \cdot \partial_t \mathbf{d}
    = \mathbf{e} \cdot \partial_t \left( \varepsilon_0 \mathbf{e} + \mathbf{p} \right) 
  & = \partial_t \left( \frac{1}{2} \varepsilon_0 \mathbf{e} \cdot \mathbf{e} \right) + \mathbf{e} \cdot \partial_t \mathbf{p} \\
  & = \partial_t \left( \frac{1}{2} \mathbf{e} \cdot \mathbf{d} \right) + \frac{1}{2} \left( \mathbf{e} \cdot \partial_t \mathbf{p} - \mathbf{p} \cdot \partial_t \mathbf{e} \right) \\
  & = \partial_t \left( \frac{1}{2 \varepsilon_0} \mathbf{d} \cdot \mathbf{d} \right) - \frac{\mathbf{p}}{\varepsilon_0} \cdot \partial_t \mathbf{d} \\
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  \mathbf{h} \cdot \partial_t \mathbf{b}
    = \mathbf{h} \cdot \partial_t \left( \mu_0 \mathbf{h} + \mu_0 \mathbf{m} \right) 
  & = \partial_t \left( \frac{1}{2} \mu_0 \mathbf{h} \cdot \mathbf{h} \right) + \mu_0 \mathbf{h} \cdot \partial_t \mathbf{m} \\
  & = \partial_t \left( \frac{1}{2} \mathbf{b} \cdot \mathbf{h} \right) + \frac{1}{2} \mu_0 \left( \mathbf{h} \cdot \partial_t \mathbf{m} - \mathbf{m} \cdot \partial_t \mathbf{h} \right) \\
  & = \partial_t \left( \frac{1}{2 \mu_0} \mathbf{b} \cdot \mathbf{b} \right) - \mathbf{m} \cdot \partial_t \mathbf{b} \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Nel vuoto o in mezzi lineari \(\mathbf{e} \cdot \partial_t \mathbf{p} - \mathbf{p} \cdot \partial_t \mathbf{e} = \mathbf{0}\), \(\mathbf{h} \cdot \partial_t \mathbf{m} - \mathbf{m} \cdot \partial_t \mathbf{h} = \mathbf{0}\). Usando le seconde espressioni, si può riscrivere l’equazione dell’energia del campo elettromagnetico come
\begin{equation*}
\begin{split}\begin{aligned}
  \partial_t \left( \frac{1}{2} \mathbf{e} \cdot \mathbf{d} + \frac{1}{2} \mathbf{b} \cdot \mathbf{h} \right) + \nabla \cdot \left( \mathbf{e} \times \mathbf{h} \right) & = - \ \mathbf{e} \cdot \mathbf{j} \ + \\
   & \quad - \frac{1}{2} \left[ \mathbf{e} \cdot \partial_t \mathbf{p} - \mathbf{p} \cdot \partial_t \mathbf{e} + \mu_0 \left(  \mathbf{h} \cdot \partial_t \mathbf{m} - \mathbf{m} \cdot \partial_t \mathbf{h} \right) \right]
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
o, usando le definizioni di densità di energia elettromagnetica \(u\) e vettore di Poynting \(\mathbf{s}\),
\begin{equation*}
\begin{split}
  \partial_t u + \nabla \cdot \mathbf{s} =
    - \ \mathbf{e} \cdot \mathbf{j} \
    - \frac{1}{2} \left[ \mathbf{e} \cdot \partial_t \mathbf{p} - \mathbf{p} \cdot \partial_t \mathbf{e} + \mu_0 \left(  \mathbf{h} \cdot \partial_t \mathbf{m} - \mathbf{m} \cdot \partial_t \mathbf{h} \right) \right]
\end{split}
\end{equation*}
\sphinxstepscope


\chapter{Regimes in Electromagnetic systems}
\label{\detokenize{ch/regimes:regimes-in-electromagnetic-systems}}\label{\detokenize{ch/regimes:classical-electromagnetism-regimes}}\label{\detokenize{ch/regimes::doc}}
\sphinxstepscope


\section{Electrostatics}
\label{\detokenize{ch/regimes-electrostatics:electrostatics}}\label{\detokenize{ch/regimes-electrostatics:classical-electromagnetism-electrostatics}}\label{\detokenize{ch/regimes-electrostatics::doc}}

\subsection{Zero electric field inside a conductor}
\label{\detokenize{ch/regimes-electrostatics:zero-electric-field-inside-a-conductor}}
\sphinxAtStartPar
Studying the transient of the electric charge distribution inside a conductor,
\begin{equation*}
\begin{split}\vec{e} = \rho_R \vec{j} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
whose constitutive equation is
\begin{equation*}
\begin{split}\vec{d} = \varepsilon \vec{e} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
with free electric charge continuity equation
\begin{equation*}
\begin{split}\partial_t \rho_f + \nabla \cdot \vec{j}_f = 0 \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and Gauss equation for the displacement field
\begin{equation*}
\begin{split}\nabla \cdot \vec{d} = \rho_f \ .\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  \partial_t \rho_f
  & = - \nabla \cdot \vec{j}_f = \\
  & = - \nabla \cdot \left( \frac{1}{\rho_R} \vec{e} \right) = \\
  & = - \frac{1}{\rho_R \varepsilon} \nabla \cdot \vec{d} = \\
  & = - \frac{1}{\rho_R \varepsilon} \rho_f \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having assumed uniform properties. The differential equation in the volume of the conductor provides the evolution of the electric charge in the volume \(\rho(\mathbf{r},t)\), given the initial condition \(\rho(\mathbf{r},0) = \rho_{f,0}(\mathbf{r})\)
\begin{equation*}
\begin{split}\partial_t \rho_f = - \frac{1}{\rho_R \varepsilon} \rho_f\end{split}
\end{equation*}\begin{equation*}
\begin{split}\rho_f(\mathbf{r},t) = \rho_{f,0}(\mathbf{r}) \exp\left[ - \dfrac{t}{\rho_R \varepsilon} \right] \ .\end{split}
\end{equation*}
\sphinxAtStartPar
For a conductor:
\begin{itemize}
\item {} 
\sphinxAtStartPar
\(\varepsilon \sim \varepsilon_0 = 8.85 \cdot 10^{-12} \text{F} \text{m}^-1\)

\item {} 
\sphinxAtStartPar
\(\rho_R \sim 10^{-7}  \Omega \, \text{m}\)

\end{itemize}

\sphinxAtStartPar
so that the time constant (that can be thought as a characteristic time) of the process is
\begin{equation*}
\begin{split}\tau = \rho_R \varepsilon \sim 8.85 \cdot 10^{-19} \, \text{s} \ , \end{split}
\end{equation*}
\sphinxAtStartPar
and thus, after a very short period of time the volume charge density is approximately zero everywhere in the volume: it accumulates in a very thin surface layer.
\subsubsection*{Proof}
\begin{equation*}
\begin{split}\partial_t \left( \rho_f e^{\frac{t}{\rho_R \varepsilon}} \right) = 0\end{split}
\end{equation*}\begin{equation*}
\begin{split}\rho_f(\mathbf{r},t) e^{\frac{r}{\rho_R \varepsilon}} = a(\mathbf{r})\end{split}
\end{equation*}
\sphinxAtStartPar
and appylying initial conditions in all the points of the domain, \(\rho_{f}(\mathbf{r},0) = \rho_{f,0}(\mathbf{r})\), function \(a(\mathbf{r})\) must be equal to \(\rho_{f,0}(\mathbf{r})\) and the solution reads
\begin{equation*}
\begin{split}\rho_f(\mathbf{r},t) = \rho_{f,0}(\mathbf{r}) \exp \left[ -\dfrac{t}{\rho_R \varepsilon} \right]\end{split}
\end{equation*}
\sphinxstepscope


\section{Steady regime}
\label{\detokenize{ch/regimes-steady:steady-regime}}\label{\detokenize{ch/regimes-steady:classical-electromagnetism-regimes-steady}}\label{\detokenize{ch/regimes-steady::doc}}
\sphinxAtStartPar
Steady regime \sphinxhyphen{} in a Eulerian description \sphinxhyphen{} allows for steady currents.

\sphinxstepscope


\section{Slow…}
\label{\detokenize{ch/regimes-slow:slow}}\label{\detokenize{ch/regimes-slow:classical-electromagnetism-regimes}}\label{\detokenize{ch/regimes-slow::doc}}
\sphinxAtStartPar
leading to circuit approximation

\sphinxstepscope


\part{Electric Engineering}

\sphinxstepscope




\chapter{Approssimazione circuitale}
\label{\detokenize{ch/circuits:approssimazione-circuitale}}\label{\detokenize{ch/circuits:classical-electromagnetism-circuits}}\label{\detokenize{ch/circuits::doc}}
\sphinxAtStartPar
\sphinxstylestrong{Circuiti elettrici.} \sphinxstyleemphasis{Condizioni per la validità dell’approssimazione circuitale; componenti elementari; regimi di utilizzo: stazionario, armonico (alternato), transitorio;}

\sphinxAtStartPar
\sphinxstylestrong{Circuiti elettromagnetici.} \sphinxstyleemphasis{Condizioni per la validità dell’approssimazione circuitale; es. trasformatori}

\sphinxAtStartPar
\sphinxstylestrong{Circuito elettro\sphinxhyphen{}magneto\sphinxhyphen{}meccanici.} \sphinxstyleemphasis{Es. semplici circuiti; motori elettrici e generatori}

\sphinxstepscope




\section{Circuiti elettrici}
\label{\detokenize{ch/circuits-electric:circuiti-elettrici}}\label{\detokenize{ch/circuits-electric:classical-electromagnetism-circuits-electric}}\label{\detokenize{ch/circuits-electric::doc}}
\sphinxAtStartPar
Se il sistema di interesse soddisfa alcune condizioni, è possibile ridurre la teoria di campo dell’elettromagnetismo a una teoria circuitale.
Quando possibile, cioè quando capace di descrivere adeguatamente il comportamento del sistema di interesse, l’approccio circuitale semplifica di molto la descrizione del problema, non richiedendo la soluzione di un sistema di equazioni differenziali alle derivate parziali da risolvere nello spazio, ma la soluzione di equazioni differenziali ordinarie nelle incognite circuitali, che si riduce a un sistema algebrico, spesso lineare, in regime stazionario.

\sphinxAtStartPar
\sphinxstylestrong{Giustificazione dell’approccio circuitale.}

\sphinxAtStartPar
\sphinxstylestrong{Componenti elementari di un circuito elettrico.}

\sphinxstepscope




\subsection{Validità dell’approccio circuitale}
\label{\detokenize{ch/circuits-electric-approximation:validita-dell-approccio-circuitale}}\label{\detokenize{ch/circuits-electric-approximation:classical-electromagnetism-circuits-electric-approximation}}\label{\detokenize{ch/circuits-electric-approximation::doc}}
\sphinxAtStartPar
L’approccio circuitale consente di ridurre il problema elettromagnetico, in generale un problema di campo che richiede la soluzione di PDE, a un approccio “ai morsetti” \sphinxstylestrong{todo}, che richiede la soluzione di ODE.

\sphinxAtStartPar
Una rivisitazione dell’{\hyperref[\detokenize{ch/energy-momentum-balance:classical-electromagnetism-energy}]{\sphinxcrossref{\DUrole{std,std-ref}{equazione dell’energia}}}} permette di valutare i regimi in cui è possibile usare un approccio circuitale a un sistema elettromagnetico.

\sphinxAtStartPar
In particolare, nell’equazione di bilancio dell’energia elettromagnetica
\begin{equation*}
\begin{split}\dfrac{d}{dt} \int_V u = \oint_{\partial V} \mathbf{s} \cdot \hat{\mathbf{n}} - \int_V \mathbf{j} \cdot \mathbf{e} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
viene indagato il termine di flusso alla frontiera, ricordando la definizione di vettore di Poynting \(\mathbf{s} := \mathbf{e} \times \mathbf{h}\), e riscrivendo i campi elettrico e magnetico in funzione dei potenziali elettromagnetici, \(\mathbf{b} = \nabla \times \mathbf{a}\), \(\mathbf{e} = - \nabla \varphi - \partial_t \mathbf{a} \ ,\)
\begin{equation*}
\begin{split}\begin{aligned}
  - \oint_{\partial V} \mathbf{s} \cdot \mathbf{\hat{n}}
  & = - \oint_{\partial V} \left(\mathbf{e} \times \mathbf{h} \right) \cdot \mathbf{\hat{n}} = \\
  & =   \oint_{\partial V} \left(\nabla \varphi + \partial_t \mathbf{a} \right) \times \mathbf{h}  \cdot \mathbf{\hat{n}} = \\
  & = ... \\
  & = \underbrace{\oint_{\partial V} \hat{\mathbf{n}} \cdot \nabla \times ( \varphi \mathbf{h} )}_{=0 \text{ (Stokes'thm **todo** check)}} - \oint_{\partial V} \varphi \hat{\mathbf{n}} \cdot \underbrace{\nabla \times \mathbf{h}}_{\partial_t \mathbf{d} + \mathbf{j}} + \oint_{\partial V} \hat{\mathbf{n}} \cdot \partial_t \mathbf{a} \times \mathbf{h} = \\
  & = - \oint_{\partial V} \varphi \mathbf{j} \cdot \hat{\mathbf{n}} - \oint_{\partial V} \hat{\mathbf{n}} \cdot \left( \partial_t \mathbf{d} + \mathbf{h} \times \partial_t \mathbf{a} \right) \ , 
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
e assumendo che il flusso di carica elettrica avvenga solo in corrispondenza di un numero finito di sezioni \(S_k \in \partial V\) equipotenziali a potenziale \(v_k = -\varphi_k\), costante sulle sezioni, e riconoscento il flusso di carica elettrica attraverso la sezione \(S_k\) come la corrente \(i_k = \int_{S_k} \mathbf{j} \cdot \hat{\mathbf{n}}\), si può scrivere
\begin{equation*}
\begin{split}- \oint_{\partial V} \mathbf{s} \cdot \hat{\mathbf{n}} = \sum_k v_k \, i_k - \oint_{\partial V} \hat{\mathbf{n}} \cdot \left( \partial_t \mathbf{d} + \mathbf{h} \times \partial_t \mathbf{a} \right) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Il bilancio di energia elettromagnetica del sistema può quindi essere riscritto come
\begin{equation*}
\begin{split}\frac{d}{dt} \int_V u = \sum_k v_k \, i_k - \int_{V} \mathbf{j} \cdot \mathbf{e} - \oint_{\partial V} \hat{\mathbf{n}} \cdot \left( \partial_t \mathbf{d} + \mathbf{h} \times \partial_t \mathbf{a} \right) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Nelle condizioni in cui l’ultimo termine è nullo o trascurabile (\sphinxstylestrong{todo} \sphinxstyleemphasis{quali? Spendere due parole sulla validità dell’approssimazione, con analisi dimensionale? Fare esempio in cui l’approssimazione non funziona}), la variazione di energia interna al sistema è dovuta alla differenza della potenza in ingresso ai morsetti, e la dissipazione all’interno del volume (ad esempio dovuta alla conduzione non ideale in conduttori con resistività finita),
\begin{equation*}
\begin{split}\dot{E}^{em} = P^{ext, vi} - \dot{D} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
con \(\dot{D} \ge 0\) per il secondo principio della termodinamica \sphinxstylestrong{todo} \sphinxstyleemphasis{aggiungere riferimento, e discussione.}

\sphinxstepscope




\subsection{Induzione elettromagnetica nell’approssimazione circuitale}
\label{\detokenize{ch/circuits-electric-induction:induzione-elettromagnetica-nell-approssimazione-circuitale}}\label{\detokenize{ch/circuits-electric-induction:classical-electromagnetism-circuits-electric-induction}}\label{\detokenize{ch/circuits-electric-induction::doc}}
\sphinxAtStartPar
E’ possibile applicare l’approssimazione circuitale anche in presenza di regioni in cui non è possibile trascurare il termine \(\partial_t \mathbf{b}\), come ad esempio circuiti elettromagnetici che coinvolgono trasformatori e/o motori o generatori elettrici.

\sphinxAtStartPar
In queste situazioni, se è possibile identificare una regione \(V_0\) dello spazio connessa nella quale il termine \(\partial_t \mathbf{b} = \mathbf{0}\), e quindi \(\nabla \times \mathbf{e} = \mathbf{0}\), in \(V_0\) è possibile definire il campo elettrico in termini di un potenziale \(\varphi\),
\begin{equation*}
\begin{split}\mathbf{e} = - \nabla \varphi \qquad , \qquad \mathbf{r} \in V_0 \ .\end{split}
\end{equation*}
\sphinxAtStartPar
E’ possibile calcolare le differenze di potenziale ai morsetti di un sistema in cui \(\delta_t \mathbf{b} \ne 0\), racchiuso nel volume \(V_k\), con la legge di Faraday,
\begin{equation*}
\begin{split}\oint_{\ell_k} \mathbf{e} \cdot \hat{\mathbf{t}} = - \frac{d}{dt} \int_{S_k} \mathbf{b} \cdot \hat{\mathbf{n}} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
dove il percorso chiuso \(\ell_k = \ell_k^{cond} \cup \ell_k^{mors}\) descrive il conduttore in \(V_k\) chiuso dalla linea geometrica tra i morsetti. Se si può trascurare la resistività del conduttore in \(V_k\), \(\int_{\ell_k^{cond}} \mathbf{e} \cdot \hat{\mathbf{t}} = 0\), la differenza di tensione ai morsetti vale
\begin{equation*}
\begin{split}\Delta v_k = \int_{\ell^{mors}_k} \mathbf{e} \cdot \hat{\mathbf{t}} = - \frac{d}{dt} \int_{S_k} \mathbf{b} \cdot \hat{\mathbf{n}}\end{split}
\end{equation*}
\sphinxstepscope




\subsection{Componenti elementari dei circuiti elettrici}
\label{\detokenize{ch/circuits-electric-components:componenti-elementari-dei-circuiti-elettrici}}\label{\detokenize{ch/circuits-electric-components:classical-electromagnetism-circuits-electric-components}}\label{\detokenize{ch/circuits-electric-components::doc}}

\subsubsection{Resistore ohmico}
\label{\detokenize{ch/circuits-electric-components:resistore-ohmico}}
\sphinxAtStartPar
Un resistore di Ohm risulta dall’approssimazione circuitale di un materiale con equazione costitutiva lineare
\begin{equation*}
\begin{split}\mathbf{e} = \rho_R \, \mathbf{j} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
tra il campo elettrico \(\mathbf{e}\) e la densità di corrente \(\mathbf{j}\), tramite la costante di proporzionalità \(\rho_R\), la \sphinxstylestrong{resistività} del materiale. La corrente elettrica attraverso una sezione del componente è definita come il flusso di carica attraverso una sua sezione
\begin{equation*}
\begin{split}i = \int_S \mathbf{j} \cdot \hat{\mathbf{t}} \simeq j \, A \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
Nell’ipotesi che il vettore densità di corrente si allineato con l’asse del componente e uniforme sulla sezione \(A\), “piccola”.
Se il materiale non è in grado di accumulare carica, il bilancio di carica elettrica si traduce nella continuità della corrente elettrica attraverso le sezioni del conduttore.

\sphinxAtStartPar
Utilizzando l’equazione costitutiva su un elemento di lunghezza elementare \(d\mathbf{r} =\hat{\mathbf{t}} \, d \ell \), e assumendo che il campo elettrico sia allineato con l’asse del componente, \(\mathbf{e} = e \hat{\mathbf{t}}\) si può scrivere il lavoro elementare per unità di carica come
\begin{equation*}
\begin{split}\delta v = \mathbf{e} \cdot d \mathbf{r} =  e \, d\ell = \rho_R \, j \, d\ell =  \frac{\rho_R \, d\ell}{A} i \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Da questa ultima equazione seguono le due leggi di Ohm, per resistori lineari.

\sphinxAtStartPar
\sphinxstylestrong{Prima legge di Ohm.} La differenza di potenziale tra due sezioni di un resistore lineare è proporzionale alla corrente che passa attraverso di esso,
\begin{equation*}
\begin{split}\delta v = dR \, i \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Seconda legge di Ohm.} La costante di proporzionalità che lega la differenza di potenziale e la corrente all’interno di un resistore ohmico, la \sphinxstylestrong{resistenza} del resistore, è proporzionale alla resistività e alla lunghezza del resistore, e inversamente proporzionale alla sua sezione,
\begin{equation*}
\begin{split}dR = \frac{\rho_R \ d\ell}{A} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Se le proprietà sono uniformi nel resistore, si possono integrare le relazioni elementari per ottenere la relazione tra grandezze finite,
\begin{equation*}
\begin{split}\Delta V = R \, i \end{split}
\end{equation*}\begin{equation*}
\begin{split}R = \frac{\rho_R \ \ell}{A}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{todo} (perché si può usare il potenziale? Nelle mie note avevo usato il simbolo \(v^*\), come se fosse una definizione leggermente diversa per incorporare movimento e instazionarietà, che si riduce a \(v\) nel caso stazionario).

\sphinxAtStartPar
\sphinxstylestrong{Condensatore.}

\sphinxAtStartPar
\sphinxstylestrong{Induttore.}

\sphinxAtStartPar
\sphinxstylestrong{Generatore di tensione.}

\sphinxAtStartPar
\sphinxstylestrong{Generatore di corrente.}

\sphinxstepscope




\subsection{Regimi di funzionamento in circuiti elettrici}
\label{\detokenize{ch/circuits-electric-regimes:regimi-di-funzionamento-in-circuiti-elettrici}}\label{\detokenize{ch/circuits-electric-regimes:classical-electromagnetism-circuits-electric-regimes}}\label{\detokenize{ch/circuits-electric-regimes::doc}}
\sphinxstepscope




\section{Circuiti elettromagnetici}
\label{\detokenize{ch/circuits-electromagnetic:circuiti-elettromagnetici}}\label{\detokenize{ch/circuits-electromagnetic:classical-electromagnetism-circuits-electromagnetic}}\label{\detokenize{ch/circuits-electromagnetic::doc}}
\sphinxAtStartPar
Sotto opportune ipotesi è possibile usare un modello circuitale anche per sistemi elettromagnetici, come ad esempio i trasformatori, o i motori elettrici.
\begin{itemize}
\item {} 
\sphinxAtStartPar
legge di Gauss per il campo magnetico
\begin{equation*}
\begin{split}\nabla \cdot \mathbf{b} = 0\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
legge di Ampére\sphinxhyphen{}Maxwell
\begin{equation*}
\begin{split}\nabla \times \mathbf{h} - \partial_t \mathbf{d} = \mathbf{j}\end{split}
\end{equation*}
\end{itemize}

\sphinxAtStartPar
Si aggiungono le seguenti ipotesi:
\begin{itemize}
\item {} 
\sphinxAtStartPar
materiali lineari non\sphinxhyphen{}dissipativi e non\sphinxhyphen{}dispersivi \(\mathbf{b} = \mu \mathbf{h}\) \sphinxstylestrong{todo} discutere questa ipotesi, insieme a isteresi materiali, cicli di magnetizzazione,….

\item {} 
\sphinxAtStartPar
variazioni del campo \(\mathbf{d}\) nel tempo trascurabili, \(\partial_t \mathbf{d} = \mathbf{0}\).

\end{itemize}

\sphinxAtStartPar
La legge di Gauss del campo magnetico in forma integrale permette di scrivere la \sphinxstylestrong{legge ai nodi} del flusso del campo magnetico per i circuiti magnetici,
\begin{equation*}
\begin{split}0 = \oint_{\partial V} \mathbf{b} \cdot \hat{\mathbf{n}} = \sum_k \phi_k \ .\end{split}
\end{equation*}
\sphinxAtStartPar
La legge di Ampére\sphinxhyphen{}Maxwell in forma integrale considerando:
\begin{itemize}
\item {} 
\sphinxAtStartPar
un percorso incatenato con il solo induttore
\begin{equation*}
\begin{split}\int_{\ell_{ind}} \mathbf{h} \cdot \hat{\mathbf{t}} + \int_{\ell_{12}} \mathbf{h} \cdot \hat{\mathbf{t}} = \oint_{\ell_{1}} \mathbf{h} \cdot \hat{\mathbf{t}} = \int_{S^{ind}} \mathbf{j} \cdot \hat{\mathbf{n}} =  N i =: m\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
un percorso incatenato con il traferro, aggirando l’induttore
\begin{equation*}
\begin{split}0 = \int_{\ell_{traf}} \mathbf{h} \cdot \hat{\mathbf{t}} + \int_{\ell_{21}} \hat{h} \cdot \hat{\mathbf{t}} = \sum_{k} h_k \ell_k + \int_{\ell_{21}} \hat{h} \cdot \hat{\mathbf{t}}\end{split}
\end{equation*}
\end{itemize}

\sphinxAtStartPar
e sommando le due equazioni, riconoscendo che i due integrali di linea sullo stesso percorsoin versi opposti si annullano, si ottiene la \sphinxstylestrong{legge alle maglie} per i circuiti magnetici
\begin{equation*}
\begin{split}\begin{aligned}
  m & = \int_{\ell_{ind}} \mathbf{h} \cdot \hat{\mathbf{t}} + \int_{\ell_{traf}} \mathbf{h} \cdot \hat{\mathbf{t}} = \\
    & \approx \sum_{k \in \ell} h_k \, \ell_k 
      = \sum_{k \in \ell} \frac{b_k}{\mu_k} \, \ell_k 
      = \sum_{k \in \ell} \frac{\ell_k}{\mu_k \, A_k} \, \phi_k  \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Le leggi di Kirchhoff per i circuiti magnetici sono quindi
\begin{equation*}
\begin{split}\begin{cases}
  \sum_{k \in N_j} \phi_k = 0 \\ \\
  m_{\ell_i} = \sum_{k \in \ell_i} \theta_k \phi_k \ ,
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
avendo introdotto la riluttanza \(\theta_k = \frac{\ell_k}{\mu_k \, A_k}\), l’inverso della permeanza \(\Lambda_k = \theta_k^{-1}\).

\sphinxstepscope




\subsection{Trasformatore}
\label{\detokenize{ch/circuits-electromagnetic-transformer:trasformatore}}\label{\detokenize{ch/circuits-electromagnetic-transformer:classical-electromagnetism-circuits-electromagnetic-transformer}}\label{\detokenize{ch/circuits-electromagnetic-transformer::doc}}\begin{itemize}
\item {} 
\sphinxAtStartPar
flusso del campo magnetico, nell’ipotesi di campo uniforme, o in termini del campo medio
\begin{equation*}
\begin{split}\phi = b \, A\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
flusso del campo magnetico concatenato a \(N\) avvolgimenti
\begin{equation*}
\begin{split}\psi = N \, \phi\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
relazione tra tensione ai morsetti dell’induttore e flusso concatenato, applicando la {\hyperref[\detokenize{ch/circuits-electric-induction:classical-electromagnetism-circuits-electric-induction}]{\sphinxcrossref{\DUrole{std,std-ref}{legge di Faraday solo in parte irrotazionali}}}}
\begin{equation*}
\begin{split}v = \dot{\psi}\end{split}
\end{equation*}
\end{itemize}


\subsubsection{Trasformatore ideale}
\label{\detokenize{ch/circuits-electromagnetic-transformer:trasformatore-ideale}}
\sphinxAtStartPar
In assenza di flussi dispersi e riluttanza nel traferro, la legge alle maglie nel traferro implica
\begin{equation*}
\begin{split}0 = m_1 + m_2 = N_1 \, i_1 + N_2 \, i_2\end{split}
\end{equation*}
\sphinxAtStartPar
Il flusso del campo magnetico può essere scritto in funzione del flusso concatenato agli avvolgimenti,
\begin{equation*}
\begin{split}\phi = \frac{\psi_1}{N_1} = \frac{\psi_2}{N_2}\end{split}
\end{equation*}
\sphinxAtStartPar
La derivata nel tempo di questa relazione, con numero di avvolgimenti costanti nel tempo, implica
\begin{equation*}
\begin{split}\frac{v_2}{N_2} = \frac{v_1}{N_1} \ .\end{split}
\end{equation*}

\subsubsection{Trasformatore con flussi dispersi}
\label{\detokenize{ch/circuits-electromagnetic-transformer:trasformatore-con-flussi-dispersi}}\begin{equation*}
\begin{split}\begin{cases}
 & \phi_1 - \phi_{1,d} = \phi \\
 & \phi_2 - \phi_{2,d} = \phi \\
 & m_1 = \theta_{1,d} \phi_{1,d} \\
 & m_2 = \theta_{2,d} \phi_{2,d} \\
 & m_1 + m_2 = 0
\end{cases}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\rightarrow \qquad 0 = m_1 + m_2 = N_1 \, i_1 + N_2 \, i_2\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  0 & = \phi_2 - \phi_1 - \phi_{2,d} + \phi_{1,d} \\
    & = \phi_2 - \phi_1 - \frac{m_2}{\theta_{2,d}} + \frac{m_1}{\theta_{1,d}} \\
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\rightarrow \qquad \frac{\psi_2}{N_2} - \frac{m_2}{\theta_{2,d}} = \frac{\psi_1}{N_1} - \frac{m_1}{\theta_{1,d}} \ .\end{split}
\end{equation*}\begin{equation*}
\begin{split}\rightarrow \qquad \frac{1}{N_2} \left( v_2 - \frac{N_2^2}{\theta_{2,d}} \dfrac{d i_2}{d t} \right) =  
                     \frac{1}{N_1} \left( v_1 - \frac{N_1^2}{\theta_{1,d}} \dfrac{d i_1}{d t} \right)  \ .\end{split}
\end{equation*}

\subsubsection{Trasformatore con flussi dispersi e riluttanza \protect\(\theta_{Fe}\protect\) nel traferro}
\label{\detokenize{ch/circuits-electromagnetic-transformer:trasformatore-con-flussi-dispersi-e-riluttanza-theta-fe-nel-traferro}}\begin{equation*}
\begin{split}\begin{cases}
 & \phi_{1} - \phi_{1,d} = \phi \\
 & \phi_{2} - \phi_{2,d} = \phi \\
 & m_{1} = \theta_{1,d} \phi_{1,d} \\
 & m_{2} = \theta_{2,d} \phi_{2,d} \\
 & m_1   + m_{2} = \theta_{Fe} \, \phi
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{todo} finire e controllare i conti; disegnare circuito equivalente



\sphinxstepscope




\section{Circuiti elettromeccanici}
\label{\detokenize{ch/circuits-electromechanic:circuiti-elettromeccanici}}\label{\detokenize{ch/circuits-electromechanic:classical-electromagnetism-circuits-electromechanic}}\label{\detokenize{ch/circuits-electromechanic::doc}}
\sphinxAtStartPar
Alcuni sistemi di interesse e di enorme diffusione nella società moderna sfruttano le interazioni tra componenti fenomeni elettromagnetici e meccanici: un esempio fondamentale sono le macchine elettriche, alcune delle quali possono operare sia come motore (con la potenza fornita dal sistema elettrico e convertita in potenza meccanica) sia come generatore di energia elettrica (convertendo potenza meccanica in potenza elettrica).

\sphinxAtStartPar
In un sistema di induttori con mutua influenza, la differenza di tensione ai capi dell’induttore “potenziato” \(i\) è
\begin{equation*}
\begin{split}v_i = \dot{\psi}_i = \dfrac{d}{dt} \left( N_i \, \phi_i \right) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Il flusso concatenato dipende dall’effetto di tutti gli induttori del sistema (e del campo magnetico generato da eventuali cause esterne al sistema),
\begin{equation*}
\begin{split}\phi_i = \sum_{k} \phi_{ik} = \sum_{k} \frac{1}{\theta_{ik}} \, m_k \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
avendo indicato con \(\theta_{ik}\) la riluttanza del circuito tra l’induttore potenziante \(k\) e l’induttore potenziato \(i\). Usando l’espressione della forza magneto\sphinxhyphen{}motrice \(m_k = N_k \, i_k\), si può riscrivere l’espressione della differenza di tensione
\begin{equation*}
\begin{split}v_i = \sum_k \frac{d}{dt} \left( \frac{N_i \, N_k}{\theta_{ik}} i_k \right) = \sum_k \frac{d}{dt} \left( L_{ik} \, i_k \right) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
In genereale, in circuiti elettromeccanici le riluttanze non sono dei parametri costanti del sistema ma dipendono dallo stato “meccanico” del sistema, descritto qui dalle variabili \(\mathbf{x}\),
\begin{equation*}
\begin{split}v_i = \sum_k \frac{d}{dt} \left( \frac{N_i \, N_k}{\theta_{ik}(\mathbf{x})} i_k \right) = \sum_k \frac{d}{dt} \left( L_{ik} (\mathbf{x}) \, i_k \right) \ .\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{v}(t) = \dfrac{d}{dt} \Big( \mathbf{L}(\mathbf{x}(t)) \, \mathbf{i}(t) \Big) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
La matrice di induttanza \(\mathbf{L}\) è simmetrica \sphinxstylestrong{todo} \sphinxstyleemphasis{Dimostrazione}
\label{ch/circuits-electromechanic:example-0}
\begin{sphinxadmonition}{note}{Example 6.3.1}



\sphinxAtStartPar
Given an constant and uniform magnetic field \(\mathbf{b}(r) = \mathbf{B}\) in a region of space where a simple electric circuit is placed. The electric circuit consists in a simple circuit with a resistance \(R\) as a lumped load, and has a rectangular shape. Three sides are fixed, and the distance between the pair of parallel fixed sides is \(\ell\); the fourth side can move and its distance between the parallel fixed side is \(x\). The unit vector orthogonal to the rectangular surface enclosed in the circuit is \(\hat{\mathbf{n}}\).

\sphinxAtStartPar
A mechanical system provides the prescribed motion \(x(t) = x_0 + \Delta x \sin(\Omega t)\) to the moving side. It’s asked to evaluate and discuss:
\begin{itemize}
\item {} 
\sphinxAtStartPar
voltage at the electric port of the load

\item {} 
\sphinxAtStartPar
energy balance

\end{itemize}


\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|}
\hline

\sphinxAtStartPar
\sphinxincludegraphics{{ex-00-loop}.jpg}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
\sphinxstylestrong{Without considering the inductance of the simple circuit.} Faraday’s law
\begin{equation*}
\begin{split}\Gamma_{\partial s_t}(\mathbf{e}) + \dot{\Phi}_{s_t}(\mathbf{b}) = 0 \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
provides the relation between the time derivative of the magnetic flux though two points of the electric circuit on opposite sides of the moving side of the circuit, corresponding to the voltage at the electric port of the load
\begin{equation*}
\begin{split}v = - \int_{\ell_0} \mathbf{e} \cdot \hat{t} = - \dot{\Phi}_{s_t}(\mathbf{b}) = - \dfrac{d}{dt} \left( N B A \right) = - B \ell \dot{x} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
being \(N = 1\), and \(B\) constant and uniform if self\sphinxhyphen{}inductance is not considered.
If the inductance of the circuit is neglected, from the constitutive equation of the resistance, \(v = R i\), and voltage Kirchhoff law, it follows that the current in the simple circuit is
\begin{equation*}
\begin{split}i = \frac{v}{R} = - \dot{\Phi}_{s_t}(\mathbf{b}) = - \frac{B_n \dot{A}}{R} = - \frac{B_n \, \ell \dot{x}}{R} = - \frac{B_n \, \ell \, \Delta x}{R} \, \Omega \cos(\Omega t) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
The force acting on a wire conducting electric current \(i\) in a uniform magnetic field \(\mathbf{B}\) is
\begin{equation*}
\begin{split}\mathbf{F} = - i \mathbf{B} \times \mathbf{l} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Calling \(y\) the “positive” direction of the moving side, and assuming \(\mathbf{B} = B \hat{\mathbf{z}}\), with \(\hat{\mathbf{z}} = \hat{\mathbf{x}} \times \hat{\mathbf{y}}\),
\begin{equation*}
\begin{split}\mathbf{F} = i B \ell \hat{\mathbf{x}} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Assuming negligible mass of the moving wire, the second principle of dynamics reduces to force equilibrium, so that the external force provided to the wire must be opposite to the force acting on the wire due to the EM field
\begin{equation*}
\begin{split}\mathbf{F}^e = - \mathbf{F} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and the external power reads
\begin{equation*}
\begin{split}P^e = \dot{\mathbf{x}} \cdot \mathbf{F}^e = - i B \ell \dot{x} = \frac{B^2 \ell^2 \dot{x}^2}{R} = \frac{B^2 \ell^2 \left(\Delta x\right)^2}{R} \Omega^2 \cos^2(\Omega t) \ .\end{split}
\end{equation*}

\begin{savenotes}\sphinxattablestart
\centering
\begin{tabular}[t]{|\X{38}{100}|\X{62}{100}|}
\hline

\sphinxAtStartPar
\sphinxincludegraphics{{ex-00-circuit}.jpg}
&
\sphinxAtStartPar
\sphinxincludegraphics{{ex-00-force-em}.jpg}
\\
\hline
\end{tabular}
\par
\sphinxattableend\end{savenotes}

\sphinxAtStartPar
\sphinxstylestrong{Considering the inductance of the circuit and inertia of the wire.} Considering the self\sphinxhyphen{}induced magnetic flux \(\phi\),
\begin{equation*}
\begin{split}v = - \dfrac{d}{dt} \left( N \left( \phi + B A \right) \right) \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
with \(\phi = \dfrac{m}{\theta} = \dfrac{N}{\theta} i\). The expression of the voltage a the port of the circuit can be recast as
\begin{equation*}
\begin{split}v = - \dfrac{d}{dt} \left( N B A \right) - \dfrac{d}{dt} \left( \frac{N^2}{\theta} i \right) = - \dfrac{d}{dt} \left( N B \ell x \right) - \dfrac{d}{dt} \left( L i \right) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Now, assuming everything constant except for the \(x\) and \(i\), and connecting this circuit to the load with constitutive equation, \(v = R i\), the dynamical equation of the electric circuit becomes
\begin{equation*}
\begin{split}L \dfrac{d i}{d t} + R i = - N B \ell \dfrac{d x}{d t} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
The dynamical equation of the wire is
\begin{equation*}
\begin{split}\begin{aligned}
 m \dfrac{d^2 x}{d t^2} 
 & = F^{ext} + F^{EM} = \\
 & = F^{ext} + i B \ell \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Energy balance} immidiately follows after multiplying the circuit equation by \(i\), the dynamical equation by \(\dot{x}\) and summing,
\begin{equation*}
\begin{split}\dfrac{d}{dt} \underbrace{\left( \dfrac{1}{2} m |\dot{x}|^2 + \dfrac{1}{2} L i^2 \right)}_{\text{energy: kin.+em.}} + \underbrace{R i^2}_{\text{dissipation}} = \underbrace{F^{ext} \dot{x}}_{\text{ext. power done on the sys}} \ .\end{split}
\end{equation*}\end{sphinxadmonition}


\subsection{Sistemi elettromeccanici conservativi}
\label{\detokenize{ch/circuits-electromechanic:sistemi-elettromeccanici-conservativi}}
\sphinxAtStartPar
Le equazioni che governano il sistema elettromeccanico, senza condensatori, in generale possono essere scritte come
\begin{equation*}
\begin{split}\begin{cases}
 \mathbf{M} \ddot{\mathbf{x}} + \mathbf{D} \dot{\mathbf{x}} + \mathbf{K} \mathbf{x} = \mathbf{f}^{ext} + \mathbf{f}^{em} \\
 \dfrac{d}{dt} \left( \mathbf{L} \mathbf{i} \right) + \mathbf{R} \mathbf{i} = \mathbf{e}
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
In termini di energia,
\begin{equation*}
\begin{split}
0 = \dot{\mathbf{x}}^T \left[ \mathbf{M} \ddot{\mathbf{x}} + \mathbf{D} \dot{\mathbf{x}} + \mathbf{K} \mathbf{x} - \mathbf{f}^{ext} - \mathbf{f}^{em} \right] + \mathbf{i}^T \left[ \dfrac{d}{dt} \left( \mathbf{L} \mathbf{i} \right) + \mathbf{R} \mathbf{i} - \mathbf{e} \right]
\end{split}
\end{equation*}
\sphinxAtStartPar
Nel caso di matrici di massa, smorzamento e rigidzza costanti, e usando la derivata del prodotto per ottenere un termine di derivata dell’energia degli induttori sfruttando la simmetria di \(\mathbf{L}\),
\begin{equation}\label{equation:ch/circuits-electromechanic:classical-electromagnetism:circuits-electromechanic:energy-mech-0}
\begin{split} \begin{aligned}
\dfrac{d}{dt} \left[ \frac{1}{2} \mathbf{i}^T \mathbf{L} \mathbf{i} \right] 
  & = \mathbf{i}^T \dfrac{d}{dt} \left( \mathbf{L} \, \mathbf{i} \right) + \frac{1}{2} \mathbf{i}^T \dfrac{d \mathbf{L}}{dt} \mathbf{i} = \\
  & = \mathbf{i}^T \dfrac{d}{dt} \left( \mathbf{L} \, \mathbf{i} \right) + \sum_{a} \frac{1}{2} \mathbf{i}^T \dfrac{\partial \mathbf{L}}{\partial x_a} \mathbf{i} \, \dot{x}_a = \\
  & = \mathbf{i}^T \dfrac{d}{dt} \left( \mathbf{L} \, \mathbf{i} \right) + \nabla \left( \frac{1}{2} \mathbf{i}^T \mathbf{L} \mathbf{i} \right) \dot{\mathbf{x}}  \ .
\end{aligned}\end{split}
\end{equation}
\sphinxAtStartPar
si può scrivere un’equazione di bilancio dell’energia meccanica macroscopica, \(E^{mec, int}\)
\begin{equation*}
\begin{split}
0 & = \dfrac{d}{dt} \left[ \dfrac{1}{2} \dot{\mathbf{x}}^T \mathbf{M} \dot{\mathbf{x}} + \dfrac{1}{2} \mathbf{x}^T \mathbf{K} \mathbf{x} + \dfrac{1}{2} \mathbf{i}^T \mathbf{L} \mathbf{i} \right] - \dot{\mathbf{x}}^T \left( \mathbf{f}^{em} - \nabla E^{ind}(\mathbf{x}, \mathbf{i})  \right) + \\
  & - \dot{\mathbf{x}}^T \mathbf{f}^{ext} - \mathbf{i}^T \mathbf{e} + \\
  & + \dot{\mathbf{x}}^T \mathbf{C} \dot{\mathbf{x}} + \mathbf{i}^T \mathbf{R} \mathbf{i} \ .
\end{split}
\end{equation*}
\sphinxAtStartPar
Nell’ipotesi che il processo sia conservativo, si ricava la forma delle forze dovute ai fenomeni elettromagnetici,
\begin{equation}\label{equation:ch/circuits-electromechanic:classical-electromagnetism:circuits-electromechanic:f-em}
\begin{split}\mathbf{f}^{em} = \nabla_{\mathbf{x}} E^{ind}(\mathbf{x}, \mathbf{i}) \ .\end{split}
\end{equation}

\subsection{Equazioni di governo}
\label{\detokenize{ch/circuits-electromechanic:equazioni-di-governo}}
\sphinxAtStartPar
Usando l’espressione \eqref{equation:ch/circuits-electromechanic:classical-electromagnetism:circuits-electromechanic:f-em} delle azioni meccaniche dovute agli effetti elettromagnetici, del sistema sono
\begin{equation*}
\begin{split}\begin{cases}
  \mathbf{M} \ddot{\mathbf{x}} + \mathbf{D} \dot{\mathbf{x}} + \mathbf{K} \mathbf{x} - \nabla_{\mathbf{x}} E^{ind}(\mathbf{x}, \mathbf{i})  = \mathbf{f}^{ext} \\
  \frac{d}{dt} \left( \mathbf{L}(\mathbf{x}) \mathbf{i} \right) + \mathbf{R} \mathbf{i} = \mathbf{e}
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
o nel caso generale
\begin{equation*}
\begin{split}\begin{cases}
  \mathbf{M} \ddot{\mathbf{x}} - \nabla_{\mathbf{x}} E^{ind} ( \mathbf{x}, \mathbf{i}) = \mathbf{f}^{ext} \\
  \frac{d}{dt} \left( \mathbf{L}(\mathbf{x}) \mathbf{i} \right) + \mathbf{R} \mathbf{i} = \mathbf{e}
\end{cases}\end{split}
\end{equation*}

\subsection{Bilancio energetico}
\label{\detokenize{ch/circuits-electromechanic:bilancio-energetico}}

\subsubsection{Energia meccanica macroscopica}
\label{\detokenize{ch/circuits-electromechanic:energia-meccanica-macroscopica}}
\sphinxAtStartPar
Usando l’espressione \eqref{equation:ch/circuits-electromechanic:classical-electromagnetism:circuits-electromechanic:f-em} delle azioni meccaniche dovute ai fenomeni elettromagnetici, si può riscrivere la relazione \eqref{equation:ch/circuits-electromechanic:classical-electromagnetism:circuits-electromechanic:energy-mech-0}, come un bilancio di energia meccanica macroscopica del sistema,
\begin{equation*}
\begin{split}\dfrac{d}{dt} \left[ \dfrac{1}{2} \dot{\mathbf{x}}^T \mathbf{M} \dot{\mathbf{x}} + \dfrac{1}{2} \mathbf{x}^T \mathbf{K} \mathbf{x} + \dfrac{1}{2} \mathbf{i}^T \mathbf{L} \mathbf{i} \right] = \dot{\mathbf{x}}^T \mathbf{f}^{ext} + \mathbf{i}^T \mathbf{e} - \dot{\mathbf{x}}^T \mathbf{D} \dot{\mathbf{x}} - \mathbf{i}^T \mathbf{R} \mathbf{i} \ , \end{split}
\end{equation*}
\sphinxAtStartPar
e quindi
\begin{equation*}
\begin{split}\dot{E}^{mec} = P^{ext} - \dot{D} \ .\end{split}
\end{equation*}

\subsubsection{Energia cinetica}
\label{\detokenize{ch/circuits-electromechanic:energia-cinetica}}
\sphinxAtStartPar
L’energia meccanica macroscopica può essere scritta come la somma dell’energia cinetica e dell’energia potenziale interna del sistema, \(E^{mec} = K + V^{int}\). La derivata nel tempo dell’energia potenziale delle azioni interne è l’opposto della potenza delle azioni interne conservative, \(P^{int, c} = - \dot{V}^{int}\); la dissipazione è l’opposto della potenza delle azioni interne non\sphinxhyphen{}conservative, \(P^{int, nc} = - \dot{D}\). La potenza complessiva delle azioni interne può quindi essere scritta come
\begin{equation*}
\begin{split}P^{int} = P^{int, c} + P^{int, nc} = - \dot{V}^{int} - \dot{D} \ ,\end{split}
\end{equation*}\begin{equation*}
\begin{split}\dot{K} = \dot{E}^{mec} - \dot{V}^{int} = P^{ext} \underbrace{- \dot{D} - \dot{V}^{int}}_{=P^{int}} \  \end{split}
\end{equation*}

\subsubsection{Energia totale}
\label{\detokenize{ch/circuits-electromechanic:energia-totale}}
\sphinxAtStartPar
Il primo principio della termodinamica fornisce l’equazione di bilancio dell’energia totale di un sistema chiuso,
\begin{equation*}
\begin{split}\dot{E}^{tot} = P^{ext} + \dot{Q}^{ext} \ .\end{split}
\end{equation*}

\subsubsection{Energia interna}
\label{\detokenize{ch/circuits-electromechanic:energia-interna}}
\sphinxAtStartPar
L’energia interna di un sistema è definita come la differenza dell’energia totale e dell’energia cinetica macroscopica, \(E := E^{tot} - K\). L’equazione di bilancio dell’energia interna di un sistema chiuso è
\begin{equation*}
\begin{split}\dot{E} = Q^{ext} - P^{int} \ .\end{split}
\end{equation*}

\subsubsection{Energia interna termica (microscopica)}
\label{\detokenize{ch/circuits-electromechanic:energia-interna-termica-microscopica}}
\sphinxAtStartPar
Se si definisce l’energia interna termica, corrispondente all’energia cinetica associata alle dinamiche microscopiche, come differenza tra energia interna e energia potenziale interna, o differenza di energia totale ed energia meccanica macrsocopica,
\begin{equation*}
\begin{split}\begin{aligned}
  E^{th} & = E - V^{int} = \\
         & = E^{tot} - E^{mec} \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
l’equazione di bilancio dell’energia interna termica è
\begin{equation*}
\begin{split}   \dot{E}^{th} = \dot{Q}^{ext} + \dot{D} \ . \end{split}
\end{equation*}\subsubsection*{Dimostrazione}
\begin{equation*}
\begin{split}\begin{aligned}
  \dot{E}^{th} = \dot{E} - V^{int}
    & = \dot{Q}^{ext} - P^{int} - V^{int} = \\
    & = \dot{Q}^{ext} + \dot{D} + \dot{V}^{int} - \dot{V}^{int} = \\
    & = \dot{Q}^{ext} + \dot{D} \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Con condensatori.} \sphinxstylestrong{todo}
\subsubsection*{Equazioni}
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Leggi ai nodi.}
\begin{equation*}
\begin{split}0 = \sum_{k \in B_j} \alpha_{jk} \, i_{jk}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{A} \mathbf{i} = \mathbf{0}\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Differenza di potenziale nodi\sphinxhyphen{}lati.}
\begin{equation*}
\begin{split}\mathbf{A}^T \mathbf{v}_{n} = \mathbf{v}\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Nodo a terra.}
\begin{equation*}
\begin{split}\mathbf{v}_{\perp} = \mathbf{v}_0 \ .\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Equazioni costitutive.}
\begin{equation*}
\begin{split}\begin{aligned}
    \mathbf{0} & = \mathbf{v}_R - \mathbf{R} \mathbf{i}_R & \text{resistenze} \\
    \mathbf{0} & = \mathbf{v}_L - \frac{d}{dt} \left( \mathbf{L} \mathbf{i}_L \right) & \text{induttanze} \\
    \mathbf{0} & = \frac{d}{dt} \left( C \mathbf{v}_C \right) - \mathbf{i}_C & \text{condensatori} \\
  \end{aligned}\end{split}
\end{equation*}
\end{itemize}

\sphinxstepscope


\section{Network analysis of linear circuits}
\label{\detokenize{ch/electrical-engineering-networks:network-analysis-of-linear-circuits}}\label{\detokenize{ch/electrical-engineering-networks:classical-electromagnetism-electrical-engineering-newtork-analysis}}\label{\detokenize{ch/electrical-engineering-networks::doc}}
\sphinxAtStartPar
Dynamical equations of a linear circuit can be written as a general linear state\sphinxhyphen{}space model
\begin{equation*}
\begin{split}\begin{cases}
  \mathbf{M} \dot{\mathbf{x}} = \mathbf{A} \mathbf{x} + \mathbf{B} \mathbf{u} \\
  \mathbf{y} = \mathbf{C} \mathbf{x} + \mathbf{D} \mathbf{u} \\
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
The mathematical problem is a system of DAE (dynamical\sphinxhyphen{}algebraic equations), as it includes:
\begin{itemize}
\item {} 
\sphinxAtStartPar
constitutive equations of the linear components

\item {} 
\sphinxAtStartPar
Kirchhoff laws for current at nodes and voltage in loops

\end{itemize}

\sphinxAtStartPar
Thus matrix \(\mathbf{M}\) is likely to be singular, here vector \(\mathbf{x}\) contains both dynamical (like voltage across a capacitor or current through an inductor) and algebraic grid variables, current and voltages whose time derivative doesn’t appear explicitly in the system of DAE.

\sphinxAtStartPar
\sphinxstylestrong{Different representations.} Possible choices of the unknowns:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
current through any side, voltage at any node

\item {} 
\sphinxAtStartPar
loop currents, voltage drops across any side.

\item {} 
\sphinxAtStartPar
… \sphinxstyleemphasis{any other (linear) combination on the physical quantities}

\end{enumerate}


\subsection{Thevenin equivalent}
\label{\detokenize{ch/electrical-engineering-networks:thevenin-equivalent}}\label{\detokenize{ch/electrical-engineering-networks:classical-electromagnetism-electrical-engineering-newtork-analysis-thevenin}}
\sphinxAtStartPar
\sphinxstylestrong{One\sphinxhyphen{}port.} Thevenin’s theorem states that any linear circuit can be reduced to a single voltage source and a single impedance in series.


\subsubsection{One\sphinxhyphen{}port circuit}
\label{\detokenize{ch/electrical-engineering-networks:one-port-circuit}}\label{\detokenize{ch/electrical-engineering-networks:classical-electromagnetism-electrical-engineering-newtork-analysis-thevenin-1-port}}
\sphinxAtStartPar
As the goal of Thevenin’s theorem is to find the constitutive equation of the network as \(v(i)\), the network is connected to an external current generator that prescribes \(i\) and the voltage \(v\) at the port is evaluated.

\sphinxAtStartPar
The input of the extended network is
\begin{equation*}
\begin{split}\mathbf{u} = ( \mathbf{u}_{gen}, i ) \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
while the output is, or at least contains, the voltage \(v\)
\begin{equation*}
\begin{split}\mathbf{y} = \mathbf{C} \mathbf{x} + \mathbf{D} \mathbf{u} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
The linear system can be written in Laplace domain as
\begin{equation*}
\begin{split}\begin{cases}
  s \mathbf{M} \mathbf{x} - \mathbf{M} \mathbf{x}_0  = \mathbf{A} \mathbf{x} + \mathbf{B} \mathbf{u} \\
  \mathbf{y} = \mathbf{C} \mathbf{x} + \mathbf{D} \mathbf{u} \\
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
The state and the output are the sum of the free response to non\sphinxhyphen{}zero initial conditions and forced response,
\begin{equation*}
\begin{split}\begin{cases}
  \mathbf{x} = (s \mathbf{M} - \mathbf{A})^{-1} \mathbf{M} \mathbf{x}_0 + (s \mathbf{M} - \mathbf{A})^{-1} \mathbf{B} \mathbf{u} \\
  \mathbf{y} = \mathbf{C} (s \mathbf{M} - \mathbf{A})^{-1} \mathbf{M} \mathbf{x}_0 + \left[ \mathbf{C} (s \mathbf{M} - \mathbf{A})^{-1} \mathbf{B} + \mathbf{D} \right] \mathbf{u} \\
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
Forced response can be further manipulated exploiting PSCE, evaluating the effect of one input at a time, setting all the other inputs equal to zero.
\begin{itemize}
\item {} 
\sphinxAtStartPar
the effect of setting the input of the external current generator, \(i = 0\), is equivalent to evaluate the system with an open circuit at the port

\item {} 
\sphinxAtStartPar
the effect of setting equal to zero a tension generator, \(e = 0\), is equivalent to a short\sphinxhyphen{}circuit on the same side

\item {} 
\sphinxAtStartPar
the effect of setting equal to zero a current generator, \(a = 0\), is equivalent to an open circuit on the same side

\end{itemize}

\sphinxAtStartPar
If the system is \sphinxstylestrong{asymptotically stable}, the free response is approximately zero when the \sphinxstylestrong{transient dynamics is over}, and the output equals the forced output. Introducing the transfer function
\begin{equation*}
\begin{split}\mathbf{G}(s) = [ \ \mathbf{G}_{gen}(s) \quad \mathbf{G}_i(s) \ ] \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
the input\sphinxhyphen{}output relation reads
\begin{equation*}
\begin{split}\begin{aligned}
   v = \mathbf{G}(s) \mathbf{u}
   & = \mathbf{G}_{gen}(s) \mathbf{u}_{gen} + G_i(s) \, i = \\
   & = v_{Th}(s) - Z_{Th}(s) i(s) \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having recast it as Thevenin’s theorem defining the voltage \(v_{Th}\) and the impedance \(Z_{Th}\) of the equivalent circuit,
\begin{equation*}
\begin{split}\begin{aligned}
   v_{Th} & := \mathbf{G}_{gen}(s) \mathbf{u}_{gen}(s) \\
   Z_{Th}(s) & := - G_i(s)
\end{aligned}\end{split}
\end{equation*}

\subsubsection{Many\sphinxhyphen{}port circuit}
\label{\detokenize{ch/electrical-engineering-networks:many-port-circuit}}\label{\detokenize{ch/electrical-engineering-networks:classical-electromagnetism-electrical-engineering-newtork-analysis-thevenin-n-port}}\begin{equation*}
\begin{split}\mathbf{v} = \mathbf{G}_{gen}(s) \mathbf{u}_{gen} + \mathbf{G}_i(s) \mathbf{i} = \mathbf{v}_{Th} - \mathbf{Z}_{Th} \mathbf{i} \ .\end{split}
\end{equation*}

\subsection{Norton equivalent}
\label{\detokenize{ch/electrical-engineering-networks:norton-equivalent}}\label{\detokenize{ch/electrical-engineering-networks:classical-electromagnetism-electrical-engineering-newtork-analysis-norton}}
\sphinxstepscope


\section{Network analysis of linear circuits \sphinxhyphen{} harmonic regime}
\label{\detokenize{ch/electrical-engineering-networks-harmonic:network-analysis-of-linear-circuits-harmonic-regime}}\label{\detokenize{ch/electrical-engineering-networks-harmonic:classical-electromagnetism-electrical-engineering-newtork-analysis-harmonic}}\label{\detokenize{ch/electrical-engineering-networks-harmonic::doc}}
\sphinxAtStartPar
The harmonic dynamics of a linear circuit can be evaluated in Fourier domain, or using complex numbers to represent harmonic functions,
\begin{equation*}
\begin{split}\begin{aligned}
  v(t) & = V_{max} \cos (\Omega t + \varphi_v) = \text{re} \{ V_{max} e^{i (\Omega t + \varphi_v)} \} = \\
       & = \sqrt{2} V \cos (\Omega t + \varphi_v) = \sqrt{2} \, \text{re} \{ V e^{i (\Omega t + \varphi_v)} \} = \sqrt{2} \, \text{re} \{ v e^{i \Omega t} \} \\
  i(t) & = I_{max} \cos (\Omega t + \varphi_i) = \text{re} \{ I_{max} e^{j (\Omega t + \varphi_i)} \} = \\
       & = \sqrt{2} I \cos (\Omega t + \varphi_i) = \sqrt{2} \, \text{re} \{ I e^{j (\Omega t + \varphi_i)} \} = \sqrt{2} \, \text{re} \{ i e^{j \Omega t} \} \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having anticipated the definition {\hyperref[\detokenize{ch/electrical-engineering-networks-harmonic:harmonic:effective-values}]{\sphinxcrossref{Definition 6.5.1}}} of effective tension \(V\) and current \(I\).


\subsection{Power}
\label{\detokenize{ch/electrical-engineering-networks-harmonic:power}}\label{\detokenize{ch/electrical-engineering-networks-harmonic:classical-electromagnetism-electrical-engineering-newtork-analysis-harmonic-power}}
\sphinxAtStartPar
\sphinxstylestrong{Instantaneous power.}
\begin{equation}\label{equation:ch/electrical-engineering-networks-harmonic:eq:harmonic:power:instantaneous}
\begin{split}\begin{aligned}
  P(t) 
  & = v(t) i(t) = \\
  & = V_{max} I_{max}  \cos (\Omega t )  \cos (\Omega t - \varphi_i) = \\ 
  & = \frac{1}{2} V_{max} I_{max} \left[ \cos \varphi_i +  \cos ( 2 \Omega t ) \right]  \\ 
\end{aligned}\end{split}
\end{equation}
\sphinxAtStartPar
having used \sphinxhref{https://basics2022.github.io/bbooks-math-miscellanea-hs/ch/trigonometry.html\#werner}{Werner’s formula},
\begin{equation*}
\begin{split}\cos x \cos y = \frac{1}{2} \left[ \cos(x-y) + \cos(x+y) \right] \ .\end{split}
\end{equation*}
\sphinxAtStartPar
and the property \(\cos(-x) = \cos x\).

\sphinxAtStartPar
\sphinxstylestrong{Average power on a period.} Over a period \(T = \frac{1}{f} = \frac{2 \pi}{\Omega}\)
\begin{equation*}
\begin{split}\overline{P} = \frac{1}{T} \int_{t=t_0}^{t_0+T} P(t) \, dt = \frac{V_{max} I_{max}}{2} = V I\ ,\end{split}
\end{equation*}
\sphinxAtStartPar
as the integral of the harmonic term with period \(\frac{T}{2}\) of the instantaneous power \eqref{equation:ch/electrical-engineering-networks-harmonic:eq:harmonic:power:instantaneous} is identically zero, and with the definition of the \sphinxstylestrong{effective voltage and current}
\label{ch/electrical-engineering-networks-harmonic:harmonic:effective-values}
\begin{sphinxadmonition}{note}{Definition 6.5.1 (Effective voltage and current in AC)}



\sphinxAtStartPar
Effective voltage and currents
\begin{equation*}
\begin{split}V := \frac{V_{max}}{\sqrt{2}} \quad , \quad I := \frac{I_{max}}{\sqrt{2}} \ , \end{split}
\end{equation*}
\sphinxAtStartPar
are defined as those voltage and current in DC providing the same value of average power.
\end{sphinxadmonition}

\sphinxAtStartPar
\sphinxstylestrong{Complex power.} Complex power of a dipole with impedence \(Z\), \(v =  Z i\)
\begin{equation*}
\begin{split}\begin{aligned}
  S 
  & := v i^* = |v|e^{j \varphi_v} |i| e^{-j \varphi_i} = |v| |i| e^{j(\varphi_v - \varphi_i)} = \\
  & = Z i i^* = Z |i|^2 = (R + j X ) |i|^2 = |Z||i|^2 e^{j \varphi_Z} = P + j Q \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
with the active power \(P\) and the reactive power \(Q\)
\begin{equation*}
\begin{split}\begin{aligned}
  P & = \text{re}\{ S \} && = && |S| \cos \varphi_Z && = && \dots \\
  Q & = \text{im}\{ S \} && = && |S| \sin \varphi_Z && = && \dots \\
\end{aligned}\end{split}
\end{equation*}


\sphinxstepscope


\section{Three\sphinxhyphen{}phase circuits}
\label{\detokenize{ch/electrical-engineering-three-phase:three-phase-circuits}}\label{\detokenize{ch/electrical-engineering-three-phase:classical-electromagnetism-electrical-engineering-three-phase}}\label{\detokenize{ch/electrical-engineering-three-phase::doc}}

\subsection{Star\sphinxhyphen{}star network}
\label{\detokenize{ch/electrical-engineering-three-phase:star-star-network}}\label{\detokenize{ch/electrical-engineering-three-phase:classical-electromagnetism-electrical-engineering-three-phase-star-star}}

\begin{savenotes}\sphinxattablestart
\centering
\begin{tabulary}{\linewidth}[t]{|T|T|}
\hline

\sphinxAtStartPar
\sphinxincludegraphics{{star-star}.png}
&
\sphinxAtStartPar
\sphinxincludegraphics{{star-star-e1}.png}
\\
\hline
\end{tabulary}
\par
\sphinxattableend\end{savenotes}


\subsubsection{General solution}
\label{\detokenize{ch/electrical-engineering-three-phase:general-solution}}
\sphinxAtStartPar
Tension \(v_{AB}\) between the centers of the stars \(A\), \(B\)
\begin{equation*}
\begin{split}v_{AB} = \dfrac{\sum_{g=1}^{3} Y_g e_g}{\sum_{i=1}^{4} Y_i} \ .\end{split}
\end{equation*}\subsubsection*{Proof.}

\sphinxAtStartPar
PSCE is used on the linear network, leaving only one tension generator on at a time, and then combining the results.

\sphinxAtStartPar
\sphinxstylestrong{Tension generator \(e_1\) on, \(e_2 = e_3 = 0\) off.} Leaving \(e_1\) on, and switching off \(e_2 = e_3 = 0\), tension generator sees an equivalent impedance
\begin{equation*}
\begin{split}\begin{aligned}
  Z_{eq,1}
  & = Z_1 + (Z_2 \parallel Z_3 \parallel Z_4) \\
  & = \dfrac{1}{Y_1} + \dfrac{1}{Y_2 + Y_3 + Y_4} = \dfrac{Y_{1234}}{Y_1 Y_{234}}  \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
so that:
\begin{itemize}
\item {} 
\sphinxAtStartPar
the current through the generator reads
\begin{equation*}
\begin{split}i_{1,1} = \dfrac{e_1}{Z_{eq,1}} = \frac{Y_1 Y_{234}}{Y_{1234}} e_1\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
the currents through the other sides (acting as current dividers are):
\begin{equation*}
\begin{split}\begin{aligned}
      i_{2,1} & = -     \frac{Y_2}{Y_{234}} \, i_{1,1} = -     \frac{Y_1 Y_2}{Y_{1234}} e_1  \\
      i_{3,1} & = -     \frac{Y_3}{Y_{234}} \, i_{1,1} = -     \frac{Y_1 Y_3}{Y_{1234}} e_1  \\
      i_{4,1} & = \ \ \ \frac{Y_4}{Y_{234}} \, i_{1,1} = \ \ \ \frac{Y_1 Y_4}{Y_{1234}} e_1  \\
   \end{aligned}\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
tension \(v_{AB}\)
\begin{equation*}
\begin{split}v_{AB,1} = e_1 - Z_1 i_{1,1} = \left( 1 - \frac{Y_{234}}{Y_{1234}} \right) e_1 = \frac{Y_1 e_1}{\sum_{k=1}^4 Y_k} \ . \end{split}
\end{equation*}
\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{PSCE.} Exploiting the PSCE and the symmetry of the system, the expressions of currents in the phases, in the neutral and the center\sphinxhyphen{}center voltage seamlessly follow
\begin{equation*}
\begin{split}\begin{aligned}
  i_1    & = \frac{Y_1 Y_{234}}{Y_{1234}} e_1 - \frac{Y_1 Y_2}{Y_{1234}} e_2 - \frac{Y_1 Y_3}{Y_{1234}} e_3 = \\
         & = Y_1 e_1 - \frac{Y_1}{Y_{1234}} \sum_{g=1}^{3} Y_g \, e_g \\
  i_2    & = Y_2 e_2 - \frac{Y_2}{Y_{1234}} \sum_{g=1}^{3} Y_g \, e_g \\
  i_3    & = Y_3 e_3 - \frac{Y_3}{Y_{1234}} \sum_{g=1}^{3} Y_g \, e_g \\
  i_4    & = \frac{Y_4}{Y_{1234}} \sum_{g=1}^{3} Y_g \, e_g \\
  v_{AB} & =  \frac{\sum_{g=1}^{3} Y_g \, e_g}{\sum_{k=1}^4 Y_k} \\
\end{aligned}\end{split}
\end{equation*}

\subsubsection{Equilibrated generation and loads}
\label{\detokenize{ch/electrical-engineering-three-phase:equilibrated-generation-and-loads}}

\subsubsection{Extra connections}
\label{\detokenize{ch/electrical-engineering-three-phase:extra-connections}}

\paragraph{Phase\sphinxhyphen{}neutral connections}
\label{\detokenize{ch/electrical-engineering-three-phase:phase-neutral-connections}}
\sphinxAtStartPar
Connections of a phase with the neutral result in parallel impedence with the generators and/or the loads

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{star-star-parallel-connections}.png}
\end{figure}


\paragraph{Phase\sphinxhyphen{}phase connections}
\label{\detokenize{ch/electrical-engineering-three-phase:phase-phase-connections}}
\sphinxAtStartPar
Phase\sphinxhyphen{}phase connections don’t influence the voltage \(v_{AB}\) between the centers \(A\), \(B\).

\sphinxAtStartPar
\sphinxstylestrong{todo} \sphinxstyleemphasis{Write the proof.}

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{star-star-extra-connections}.png}
\end{figure}

\sphinxstepscope


\section{Exercises}
\label{\detokenize{ch/electrical-engineering-exercises:exercises}}\label{\detokenize{ch/electrical-engineering-exercises:classical-electromagnetism-electrical-engineering-exercises}}\label{\detokenize{ch/electrical-engineering-exercises::doc}}
\sphinxAtStartPar
\sphinxstylestrong{Topics}: Thevenin and Norton equivalent;…

\sphinxAtStartPar
\sphinxstylestrong{Electric circuits}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Type a: transient dynamics of systems with 1 dynamic component (either capacitor or inductor);

\item {} 
\sphinxAtStartPar
Type b: harmonic dynamics of linear systems: phasor algebra, complex power,…

\item {} 
\sphinxAtStartPar
Type c: three\sphinxhyphen{}phase circuits, triangles and stars,…

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Electromagnetic circuits}:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Type d: circuit approximation of magnetic circuit,…

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Exams.}
\subsubsection*{2025\sphinxhyphen{}02\sphinxhyphen{}11}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Type a. \hyperref[\detokenize{ch/electrical-engineering-exercises-transient-1-dynamic:exam-25-02-11-exe-01}]{Exercise \ref{\detokenize{ch/electrical-engineering-exercises-transient-1-dynamic:exam-25-02-11-exe-01}}}

\item {} 
\sphinxAtStartPar
Type b. \hyperref[\detokenize{ch/electrical-engineering-exercises-harmonic:exam-25-02-11-exe-02}]{Exercise \ref{\detokenize{ch/electrical-engineering-exercises-harmonic:exam-25-02-11-exe-02}}}

\item {} 
\sphinxAtStartPar
Type b. \hyperref[\detokenize{ch/electrical-engineering-exercises-harmonic:exam-25-02-11-exe-03}]{Exercise \ref{\detokenize{ch/electrical-engineering-exercises-harmonic:exam-25-02-11-exe-03}}}

\item {} 
\sphinxAtStartPar
Theory: electrical line. Electro\sphinxhyphen{}thermal model of the cable,…

\end{enumerate}
\subsubsection*{2025\sphinxhyphen{}01\sphinxhyphen{}22}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Type a. \hyperref[\detokenize{ch/electrical-engineering-exercises-transient-1-dynamic:exam-25-01-22-exe-01}]{Exercise \ref{\detokenize{ch/electrical-engineering-exercises-transient-1-dynamic:exam-25-01-22-exe-01}}}

\item {} 
\sphinxAtStartPar
Type b. \hyperref[\detokenize{ch/electrical-engineering-exercises-harmonic:exam-25-01-22-exe-02}]{Exercise \ref{\detokenize{ch/electrical-engineering-exercises-harmonic:exam-25-01-22-exe-02}}}

\item {} 
\sphinxAtStartPar
Type d. \hyperref[\detokenize{ch/electrical-engineering-exercises-electromagnetic:exam-25-01-22-exe-03}]{Exercise \ref{\detokenize{ch/electrical-engineering-exercises-electromagnetic:exam-25-01-22-exe-03}}}

\item {} 
\sphinxAtStartPar
Theory: transformer

\end{enumerate}
\subsubsection*{2024\sphinxhyphen{}09\sphinxhyphen{}06}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Type a. \hyperref[\detokenize{ch/electrical-engineering-exercises-transient-1-dynamic:exam-24-09-06-exe-01}]{Exercise \ref{\detokenize{ch/electrical-engineering-exercises-transient-1-dynamic:exam-24-09-06-exe-01}}}

\item {} 
\sphinxAtStartPar
Type b. \hyperref[\detokenize{ch/electrical-engineering-exercises-harmonic:exam-24-09-06-exe-02}]{Exercise \ref{\detokenize{ch/electrical-engineering-exercises-harmonic:exam-24-09-06-exe-02}}}

\item {} 
\sphinxAtStartPar
Type c. \hyperref[\detokenize{ch/electrical-engineering-exercises-three-phase:exam-24-09-06-exe-03}]{Exercise \ref{\detokenize{ch/electrical-engineering-exercises-three-phase:exam-24-09-06-exe-03}}}

\item {} 
\sphinxAtStartPar
Theory: overload in cables

\end{enumerate}
\subsubsection*{2024\sphinxhyphen{}07\sphinxhyphen{}22}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Type a. \hyperref[\detokenize{ch/electrical-engineering-exercises-transient-1-dynamic:exam-24-07-22-exe-01}]{Exercise \ref{\detokenize{ch/electrical-engineering-exercises-transient-1-dynamic:exam-24-07-22-exe-01}}}

\item {} 
\sphinxAtStartPar
Type b. \hyperref[\detokenize{ch/electrical-engineering-exercises-harmonic:exam-24-07-22-exe-02}]{Exercise \ref{\detokenize{ch/electrical-engineering-exercises-harmonic:exam-24-07-22-exe-02}}}

\item {} 
\sphinxAtStartPar
Type c. \hyperref[\detokenize{ch/electrical-engineering-exercises-three-phase:exam-24-07-22-exe-03}]{Exercise \ref{\detokenize{ch/electrical-engineering-exercises-three-phase:exam-24-07-22-exe-03}}}

\end{enumerate}
\subsubsection*{2024\sphinxhyphen{}06\sphinxhyphen{}19}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Type c. \hyperref[\detokenize{ch/electrical-engineering-exercises-three-phase:exam-24-06-19-exe-01}]{Exercise \ref{\detokenize{ch/electrical-engineering-exercises-three-phase:exam-24-06-19-exe-01}}}

\item {} 
\sphinxAtStartPar
Type d. \hyperref[\detokenize{ch/electrical-engineering-exercises-electromagnetic:exam-24-06-19-exe-02}]{Exercise \ref{\detokenize{ch/electrical-engineering-exercises-electromagnetic:exam-24-06-19-exe-02}}}

\end{enumerate}
\subsubsection*{2024\sphinxhyphen{}02\sphinxhyphen{}13}
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Type d.+a. \hyperref[\detokenize{ch/electrical-engineering-exercises-electromagnetic:exam-24-02-13-exe-01-a}]{Exercise \ref{\detokenize{ch/electrical-engineering-exercises-electromagnetic:exam-24-02-13-exe-01-a}}}

\item {} 
\sphinxAtStartPar
Type a.    \hyperref[\detokenize{ch/electrical-engineering-exercises-transient-1-dynamic:exam-24-02-13-exe-01-b}]{Exercise \ref{\detokenize{ch/electrical-engineering-exercises-transient-1-dynamic:exam-24-02-13-exe-01-b}}}

\item {} 
\sphinxAtStartPar
Type c.    \hyperref[\detokenize{ch/electrical-engineering-exercises-three-phase:exam-24-02-13-exe-02}]{Exercise \ref{\detokenize{ch/electrical-engineering-exercises-three-phase:exam-24-02-13-exe-02}}}

\end{enumerate}

\sphinxstepscope


\subsection{Transient dynamics of linear electrical grids with one dynamic component}
\label{\detokenize{ch/electrical-engineering-exercises-transient-1-dynamic:transient-dynamics-of-linear-electrical-grids-with-one-dynamic-component}}\label{\detokenize{ch/electrical-engineering-exercises-transient-1-dynamic:classical-electromagnetism-electrical-engineering-exercises-transient-1-dynamic}}\label{\detokenize{ch/electrical-engineering-exercises-transient-1-dynamic::doc}}
\begin{sphinxadmonition}{note}{Guidelines for solution}

\sphinxAtStartPar
Breaking down the solution:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
Find the \sphinxstylestrong{many\sphinxhyphen{}port equivalent} of the \sphinxstylestrong{linear algebraic part of the network} (resistor, and prescribed generators), using PSCE. Find the relation between port voltage and currents and all the required variables of the network,
\begin{equation*}
\begin{split}\begin{aligned}
     \mathbf{v}_{port} & = \mathbf{v}_0(\mathbf{e}, \mathbf{a}) + \mathbf{R} \mathbf{i}_{port} \\
     \mathbf{z}        & = \mathbf{z}_0(\mathbf{e}, \mathbf{a}) + \mathbf{z}_{/i_{port}} \mathbf{i}_{port}
   \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
If 2 ports exist and port \(A\) is connected to a dynamical linear component and port \(B\) is connected to an ideal switch, the equations become to
\begin{equation*}
\begin{split}\begin{aligned}
     v_A & = v_{0,A}(\mathbf{e},\mathbf{a}) + R_{AA} i_A + R_{AB} i_B \\
     v_B & = v_{0,B}(\mathbf{e},\mathbf{a}) + R_{BA} i_A + R_{BB} i_B \\
     \mathbf{z} & = \mathbf{z}_0(\mathbf{e}, \mathbf{a}) + \mathbf{z}_{/i_{port}} \mathbf{i}_{port}
   \end{aligned}\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
Evaluate the \sphinxstylestrong{steady conditions} for \(t \le 0^-\), with the given state of the switch (\(i_B = 0\) if it’s open, \(v_B = 0\) if it’s closed), and using the constitutive equation of the dynamical element (a capacitor acts as an open circuit in steady conditions, \(i_A = 0\) as \(i_A = C \frac{d v_A}{dt}\); an inductor acts as a short\sphinxhyphen{}circuit in steady conditions, \(v_A = 0\), as \(v_A = L \frac{d i_A}{d t}\)).

\sphinxAtStartPar
In the first two equations of the system, two of the four varaibles \(i_{A,B}\), \(v_{A,B}\) are thus known, and this system can be solved to find the other two quantities. Once \(\mathbf{i}_{port}\) is known, grid variables \(\mathbf{z}\) can be evaluated.

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Transient dynamics} is then evaluated using the change of state in the switch
\begin{equation*}
\begin{split}\begin{aligned}
     \text{open to close: } & \begin{cases} v_{A}(t) = ( 1 - h(t) ) \, v_{A,0^-} \\
                                            i_{A}(t) =  h(t) \, i_{A,t\ge 0}(t) \end{cases} \\ \\
     \text{close to open: } & \begin{cases} v_{A}(t) = h(t) \, v_{A,t\ge 0}(t) \\
                                            i_{A}(t) = ( 1 - h(t) ) \, i_{A,0^-} \end{cases} \\ \\
   \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and using the conditions for \(t \ge 0\) in the equations of the equivalent network to find the equivalent resistance \(R_{eq}\) of the algebraic part of the network to be used in the constitutive equations of the dynamical component,
\begin{equation*}
\begin{split}\begin{aligned}
     \text{capacitor} &: && 0 = i_A +  C \frac{d v_A}{d t} && \rightarrow \quad  f(\mathbf{x}_{B}) = v_A + R_{eq} C \frac{d v_A}{d t} \\
     \text{inductor } &: && 0 = v_A +  L \frac{d i_A}{d t} && \rightarrow \quad  f(\mathbf{x}_{B}) = i_A + R_{eq} L \frac{d i_A}{d t} \\
   \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
with \(f(\mathbf{x}_{B})\) a forcing term depending on the state of the switch, and the initial conditions for the state variable of the dynamical components equal to the steady conditions, as there’s no jump in state variables without impulsive forces.

\item {} 
\sphinxAtStartPar
Once the state variables of the dynamical equations are known. it’s possible to evaluate all the other required variables.

\end{enumerate}


\end{sphinxadmonition}


\phantomsection \label{exercise:exam-25-02-11-exe-01}

\begin{sphinxadmonition}{note}{Exercise 6.7.1 (Exam 2025\sphinxhyphen{}02\sphinxhyphen{}11, Exercise 1.)}



\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2025-02-11-ese-01}.png}
\end{figure}
\subsubsection*{Solution}

\sphinxAtStartPar
Following the \sphinxstylestrong{guidelines for the solution}, a {\hyperref[\detokenize{ch/electrical-engineering-networks:classical-electromagnetism-electrical-engineering-newtork-analysis-thevenin-n-port}]{\sphinxcrossref{\DUrole{std,std-ref}{many\sphinxhyphen{}port Thevenin equivalent circuit}}}} of the resistive part of the circuit is found, with two ports for interfacing with the capacitor (A) and with the switch. The dynamical equation of the system is written in state\sphinxhyphen{}space representation, writing the voltage at the ports and the unknown variable \(i(t)\) as outputs; the capacitor contitutive equation is used to find the time evolution of the system once the switch is closed

\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2025-02-11-ese-01-b}.png}
\end{figure}
\subsubsection*{Internal generators on, open circuit}

\sphinxAtStartPar
Solution using two loop currents, \(i_1\) in the upper part of the circuit and \(i_2\) in the lower triangle. Using KVL
\begin{equation*}
\begin{split}\begin{aligned}
  0 & = e_1 - R_2 i_{1,0} - R_1 (a + i_{1,0}) \\
  \rightarrow \quad i_{1,0} & = \dfrac{1}{R_1+R_2} e_1 - \frac{R_1}{R_1 + R_2} a \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
so that the desired variables read
\begin{equation*}
\begin{split}\begin{cases}
  v_{A,0} & = R_3 a - R_2 i_{1,0} = \left[ R_3 + \dfrac{R_1 R_2}{R_1 + R_2} \right] a - \dfrac{R_2}{R_1+R_2} e_1 \\
  v_{B,0} & = e_2 - (R_3 + R_4) a \\
  i_{0} & = a
\end{cases}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{cases}
 v_{A,0} & = \quad\ 7.67 \, V \\
 v_{B,0} & =      -13.00 \, V \\
   i_{0} & = \quad\ 3.00 \, A \\
\end{cases}\end{split}
\end{equation*}
\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2025-02-11-ese-01-c}.png}
\end{figure}
\subsubsection*{Internal generators off, current generators at the ports}

\sphinxAtStartPar
Callling \(i_A\) and \(i_B\) the current passing through the current generators connected at the ports. The solution is found powering one generation at a time and then exploiting PSCE

\sphinxAtStartPar
\sphinxstyleemphasis{Powering A} …

\sphinxAtStartPar
\sphinxstyleemphasis{Powering B.} …



\sphinxAtStartPar
Currents in the two parallel branches in the upper part of the circuit (current dividers) read
\begin{equation*}
\begin{split}\begin{cases}
  i   & = i_A \\
  v_A & = \left[ R_3 + \dfrac{R_1 R_2}{R_1 + R_2} \right] \, i_A - R_3 \, i_B \\
  v_B & = -R_3 \, i_A + (R_3 + R_4) \, i_B
\end{cases}\end{split}
\end{equation*}
\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2025-02-11-ese-01-a}.png}
\end{figure}

\sphinxAtStartPar
The equations of the equivalent algebraic system are
\begin{equation*}
\begin{split}\begin{cases}
 v_A & = v_{A,0} + R_{AA}   \, i_A + R_{AB}   \, i_B \\
 v_B & = v_{B,0} + R_{BA}   \, i_A + R_{BB}   \, i_B \\
 i   & = i_{ ,0} + i_{/i_A} \, i_A + i_{/i_B} \, i_B \\
\end{cases}\end{split}
\end{equation*}\begin{equation*}
\begin{split}
\begin{bmatrix} v_A(t) \\ v_B(t) \end{bmatrix} & =
\begin{bmatrix} v_{A0} \\ v_{B0} \end{bmatrix} + 
\begin{bmatrix}
  R_3 + \frac{R_1 R_2}{R_1 + R_2} & -R_3 \\ -R_3 & R_3 + R_4
\end{bmatrix}
\begin{bmatrix} i_A(t) \\ i_B(t) \end{bmatrix} \\
i(t) & = i_0 + i_A(t)
\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  \det \mathbf{R}
  & = \left( R_3 + \frac{R_1 R_2}{R_1 + R_2}  \right) \left( R_3 + R_4 \right) - R_3^2 = \\
  & = ( R_3 + R_4 ) \left( R_3 + \frac{R_1 R_2}{R_1 + R_2} - \dfrac{R_3^2}{R_3 + R_4} \right) = \\
  & = ( R_3 + R_4 ) \left( \frac{R_1 R_2}{R_1 + R_2} + \dfrac{R_3 R_4}{R_3 + R_4} \right) \ .
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Steady solution for \(t \le 0^-\).} With switch open \(i_B = 0\) and steady conditions \(i_A = C \dot{v}_A = 0\),
\begin{equation*}
\begin{split}\begin{cases}
  v_A(0^-) & = v_{A,0} = \quad\ 7.67 \, V \\
  v_B(0^-) & = v_{B,0} =      -13.00 \, V \\
    i(0^-) & = i_{ ,0} = \quad\ 3.00 \, A \\
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Transient dynamics}, when the switch closes \(v_B(t \ge 0^+) = 0\),
\begin{equation*}
\begin{split}i_A(t) = \dfrac{R_3 + R_4}{\det \mathbf{R}} \Delta v_A(t) + \dfrac{R_3}{\det \mathbf{R}} \Delta v_B(t)\end{split}
\end{equation*}\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Tension across the switch}
\begin{equation*}
\begin{split}\begin{aligned}
     v_{B}(t) & = v_{B,0} \, h(-t) \\
     \Delta v_{B}(t) & = v_B(t) - v_{B,0} = - v_{B,0} \, h(t) \ . 
   \end{aligned}\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Tension across the capacitor.} The dynamical equation for the difference of the state variable reads
\begin{equation*}
\begin{split}\begin{aligned}
     0 & = i_A + C \dot{v}_A = \\
       & = \dfrac{R_3 + R_4}{\det \mathbf{R}} \Delta v_A(t) + \dfrac{R_3}{\det \mathbf{R}} \Delta v_B(t) + C \dot{v}_A \ .
   \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
As \(v_{A}(t=0) = v_{A,0}\) (no jump in state variables without impulsive forcing), \(\Delta v_A = v_A - v_{A,0}\), and \(\frac{d}{dt} \Delta v_A = \frac{d}{dt} v_A\), the dynamical equation reads
\begin{equation*}
\begin{split}\begin{cases}
     \dfrac{\det \mathbf{R}}{R_3 + R_4} C  \dfrac{d}{dt}\Delta v_A + \Delta v_{A} = - \dfrac{R_3}{R_3 + R_4} \Delta v_{B}(t) = \dfrac{R_3}{R_3 + R_4} \, v_{B,0} \, h(t) \\ \\
     \Delta v_A(0^-) = 0 \ .
   \end{cases}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
     \Delta v_A(t)
     & = \frac{R_3}{R_3 + R_4} v_{B,0} \left[ 1 - \exp\left( - \dfrac{t}{\tau} \right) \right] \, h(t) \ ,
   \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
having defined the time constant and the equivalent reistence seen by the capacitor
\begin{equation*}
\begin{split}\begin{aligned}
     R_{eq} & := \dfrac{\det \mathbf{R}}{R_3+R_4} = \dfrac{R_1 R_2}{R_1 + R_2} + \dfrac{R_3 R_4}{R_3 + R_4} = \frac{50}{21} \, V = 2.381 \, V  \\ \\
     \tau   & := R_{eq} C = 1.1905 \, s 
   \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Tension through the capacitor reads
\begin{equation*}
\begin{split}\begin{aligned}
     v_A(t) 
     & = v_{A,0} + \delta v_A(t) = \\
     & = v_{A,0} + \Delta v_{A,+\infty} \, \left[ 1 - \exp\left( - \dfrac{t}{\tau} \right) \right] \, h(t) \ , 
   \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
so that the values
\begin{equation*}
\begin{split}\begin{aligned} 
     v_A(0^+)     & = v_{A,0} = 7.67 \, V \\
     v_A(+\infty) & = v_{A,0} + \Delta v_{A,+\infty} = ( 7.667 - 5.571 ) \, V = 2.095 \, V \ .
   \end{aligned}\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Current through the capacitor.}
\begin{equation*}
\begin{split}\begin{aligned}
     i_A(t)
     & = \dfrac{R_3+R_4}{\det \mathbf{R}} \Delta v_A(t) + \dfrac{R_3}{\det \mathbf{R}} \Delta v_B(t) = \\
     & = \dfrac{R_3+R_4}{\det \mathbf{R}} \frac{R_3}{R_3 + R_4} v_{B,0} \left[ 1 - \exp\left( - \dfrac{t}{\tau} \right) \right] \, h(t) - \dfrac{R_3}{\det \mathbf{R}} v_{B,0} \, h(t) = \\
     & = - \dfrac{R_3}{\det \mathbf{R}} v_{B,0} \exp\left( - \dfrac{t}{\tau} \right) \, h(t) \\
     & = 2.34 \, A \, \exp\left( - \dfrac{t}{\tau} \right) \, h(t) \ .
   \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
so that the values
\begin{equation*}
\begin{split}\begin{aligned}
     i_A(0^+)     & = 2.34 \, A \\
     i_A(+\infty) & = 0.00 \, A
   \end{aligned}\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Current \(i(t)\)}
\begin{equation*}
\begin{split}\begin{aligned}
     i(t) 
     & = i_{,0} + i_A(t) = \\
     & = a - \dfrac{R_3}{\det \mathbf{R}} v_{B,0} \exp\left( - \dfrac{t}{\tau} \right) \, h(t) \\
     & = 3.00 \, A + 2.34 \, A \, e^{-\frac{t}{\tau}} h(t) \ ,
   \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
so that the values
\begin{equation*}
\begin{split}\begin{aligned}
     i(0^+)     & = 5.35 \, A \\
     i(+\infty) & = 3.00 \, A
   \end{aligned}\end{split}
\end{equation*}
\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Energy stored in the capacitor at \(t = 0\).} Energy in the capacitor reads
\begin{equation*}
\begin{split}E_C(t) = \dfrac{1}{2} C v_A^2(t) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
At \(t = 0\), \(v_A(0) = 7.667 \, V\) and \(E_C(0) = 14.694 \, J \).
\end{sphinxadmonition}


\phantomsection \label{exercise:exam-25-01-22-exe-01}

\begin{sphinxadmonition}{note}{Exercise 6.7.2 (Exam 2025\sphinxhyphen{}01\sphinxhyphen{}22, Exercise 1.)}



\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2025-01-22-ese-01}.png}
\end{figure}
\subsubsection*{Solution}

\sphinxAtStartPar
Following the \sphinxstylestrong{guidelines for the solution}, a {\hyperref[\detokenize{ch/electrical-engineering-networks:classical-electromagnetism-electrical-engineering-newtork-analysis-thevenin-n-port}]{\sphinxcrossref{\DUrole{std,std-ref}{many\sphinxhyphen{}port Thevenin equivalent circuit}}}} of the resistive part of the circuit is found, with two ports for interfacing with the capacitor (A) and with the switch. The dynamical equation of the system is written in state\sphinxhyphen{}space representation, writing the voltage at the ports and the unknown variable \(i(t)\) as outputs; the capacitor contitutive equation is used to find the time evolution of the system once the switch is closed



\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2025-01-22-ese-01-b}.png}
\end{figure}
\subsubsection*{Internal generators on, open circuit}

\sphinxAtStartPar
Solution using two loop currents, \(i_1\) in the upper part of the circuit and \(i_2\) in the lower triangle. Using KVL
\begin{equation*}
\begin{split}\begin{aligned}
  0 & = e_2 - (R_7+R_8+R_1+R_4+R_6) i_{2,0} \\
  0 & = e_1 - (R_2+R_3) i_{1,0} \\
\end{aligned}
\end{split}
\end{equation*}\begin{equation*}
\begin{split}
\begin{aligned}
  i_{2,0} & = \dfrac{1}{R_{14678}} \, e_2 \\
  i_{1,0} & = \dfrac{1}{R_{23}} \, e_1 \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
with \(R_{14678} = R_1+R_4+R_6+R_7+R_8\), and \(R_{23} = R_2 + R_3\). The desired physical quantities are
\begin{equation*}
\begin{split}\begin{cases}
  v_{A,0} & = - R_8 i_{2,0} = -\dfrac{R_8}{R_{14678}} e_2 \\ 
  v_{B,0} & = - R_4 i_{2,0} + R_3 i_{1,0} = - \dfrac{R_4}{R_{14678}} e_2 + \dfrac{R_3}{R_{23}} e_1 \\
  i_{0} & = - i_{2,0} = - \dfrac{1}{R_{14678}} e_2
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
and their values
\begin{equation*}
\begin{split}\begin{cases}
 v_{A,0} & =     - 20.6900 \, V \\
 v_{B,0} & = \ \ \ 12.4750 \, V \\
   i_{0} & = \    - 1.7241 \, A \\
\end{cases}\end{split}
\end{equation*}
\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2025-01-22-ese-01-c}.png}
\end{figure}
\subsubsection*{Internal generators off, current generators at the ports}

\sphinxAtStartPar
Callling \(i_A\) and \(i_B\) the current passing through the current generators connected at the ports. The solution is found powering one generation at a time and then exploiting PSCE

\sphinxAtStartPar
\sphinxstyleemphasis{Powering A}
\begin{equation*}
\begin{split}\begin{aligned}
  0 & = (i_2 - i_A) R_8 + i_2 (R_{14678}) \\
\rightarrow \quad 
 i_2 & = \frac{R_8}{R_{14678}} i_A
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  v_{A,A} & =  -R_8 ( i_2 - i_A ) & = \dfrac{R_8 R_{1467}}{R_{14678}} i_A \\
  v_{B,A} & = - R_4 i_2 & = - \dfrac{R_4 R_8}{R_{14678}} i_A \\
    i_{,A}& = - i_2 & = - \dfrac{R_8}{R_{14678}} i_A \\
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
 v_{A,A} & = R_{AA}   \, i_A && = \ \ \ 7.0345  \, \Omega \, i_A \\ 
 v_{B,A} & = R_{BA}   \, i_A && = - 1.2414  \, \Omega \, i_A \\
   i_{,A} & = i_{/i_A}\, i_A && = - 0.4138 \ \  i_A \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstyleemphasis{Powering B.}



\sphinxAtStartPar
Currents in the two parallel branches in the upper part of the circuit (current dividers) read
\begin{equation*}
\begin{split}\begin{aligned}
  i_{2,B} & = \frac{R_4}{R_{14678}} i_B \\
  i_{3,B} & = \frac{R_2}{R_{23}} i_B \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and the desired variables
\begin{equation*}
\begin{split}\begin{aligned}
  i_{,B}  & = i_{4,B} & = \dfrac{R_{1678}}{R_{14678}} i_B \\
  v_{A,B} & = - R_8 i_{2,B} & = - \dfrac{R_4 R_8}{R_{14678}} i_B  \\
  v_{B,B} & = R_4 i_{4,B} + R_3 i_{3,B} & = \left[ \dfrac{R_4(R_{1678})}{R_{14678}} + \dfrac{R_2 R_3}{R_{23}} \right] i_B \\
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
 v_{A,B} & = R_{AB}   \, i_B & =     - 1.2414  \, \Omega \, i_B \\ 
 v_{B,B} & = R_{BB}   \, i_B & = \ \ \ 6.8073  \, \Omega \, i_B \\
   i_{,B}& = i_{/i_B} \, i_B & = \ \ \ 0.8966 \ \          i_B \\
\end{aligned}\end{split}
\end{equation*}
\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2025-01-22-ese-01-a}.png}
\end{figure}

\sphinxAtStartPar
The equations of the equivalent algebraic system are
\begin{equation*}
\begin{split}\begin{cases}
 v_A & = v_{A,0} + R_{AA}   \, i_A + R_{AB}   \, i_B \\
 v_B & = v_{B,0} + R_{BA}   \, i_A + R_{BB}   \, i_B \\
 i   & = i_{ ,0} + i_{/i_A} \, i_A + i_{/i_B} \, i_B \\
\end{cases}\end{split}
\end{equation*}


\sphinxAtStartPar
and they can be used to write the currents as a function of the tensions
\begin{equation*}
\begin{split}\begin{aligned}
  i_A & = \dfrac{1}{\det \mathbf{R}} \left( R_{BB} \, \Delta v_A(t) - R_{AB} \, \Delta v_B(t) \right) \\
  i_B & = \dfrac{1}{\det \mathbf{R}} \left(-R_{BA} \, \Delta v_A(t) + R_{AA} \, \Delta v_B(t) \right) \\
\end{aligned}\end{split}
\end{equation*}


\sphinxAtStartPar
The switch command is off for \(t \le 0^-\), on for \(t > 0\),
\begin{equation*}
\begin{split}i_B(t \le 0^{-}) = 0 \qquad , \qquad v_B (t \ge 0^+) = 0 \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Steady solution for \(t \le 0^-\).} With switch open \(i_B = 0\) and steady conditions \(i_A = C \dot{v}_A = 0\),
\begin{equation*}
\begin{split}\begin{cases}
  v_A(0^-) & = v_{A,0} =     - 20.6900 \, V \\
  v_B(0^-) & = v_{B,0} = \ \ \ 12.4750 \, V \\
    i(0^-) & = i_{ ,0} = \    - 1.7241 \, A \\
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Transient dynamics}. For \(t \ge 0\), the switch is closed and thus \(v_B(t\ge 0^+) = 0\).
\begin{itemize}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Tension across the switch} as a function of time
\begin{equation*}
\begin{split}\begin{aligned}
     v_{B}(t) & = v_{B,0} \, h(-t) = v_{B,0} ( 1 - h(t) ) \\
     \Delta v_B(t) & = v_{B}(t) - v_{B,0} = - v_{B,0} \,  h(t) \ . 
   \end{aligned}\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Tension across the capacitor.} Writing \(i_A\) across the capacitor as a function of the tensions, the constitutive equation of the capacitor becomes
\begin{equation*}
\begin{split}\begin{aligned}
  0 & = C \dfrac{d \Delta v_A}{d t} + i_A = \\
    & = C \dfrac{d \Delta v_A}{d t} + \dfrac{1}{\det \mathbf{R}} \left( R_{BB} \, \Delta v_A - R_{AB} \, \Delta v_B \right)  \\ \\
   \end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{cases}
      R_{eq} C \dfrac{d \Delta v_A}{d t} + \Delta v_A = \dfrac{ R_{AB} }{ R_{BB} } \, \Delta v_B(t) = - \dfrac{ R_{AB} }{ R_{BB} } v_{B,0} \, h(t)  \\ \\
      \Delta v_A(0) = 0 \ ,
   \end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
with
\begin{equation*}
\begin{split}\begin{aligned}
     R_{eq} & = \frac{\det \mathbf{R}}{R_{BB}} = 6.8081 \, \Omega \\
     \tau & = R_{eq} C = 3.4041 \cdot 10^{-3} \, s \\
     \det \mathbf{R} & = 46.345 \, \Omega^2 \\
   \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
The solution of the differential equation provides the difference of the tension through the capacitor w.r.t. the initial steady condition
\begin{equation*}
\begin{split}\Delta v_A(t) = \Delta v_{A,+\infty} \left( 1 - e^{-\frac{t}{\tau}} \right) \, h(t) \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
with \(\Delta v_{A,+\infty} = -\frac{R_{AB}}{R_{BB}} v_{B,0} = 2.2742 \, V\). The voltage across the capacitor as a function of time \(t\) thus reads
\begin{equation*}
\begin{split}\begin{aligned}
     v_A(t) 
     & = v_{A,0} + \Delta v_A(t) = \\
     & = v_{A,0} + \Delta v_{A,+\infty} \left( 1 - e^{-\frac{t}{\tau}} \right) \, h(t) \ ,
   \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
so that the values
\begin{equation*}
\begin{split}\begin{aligned} 
     v_A(0^+) & = v_{A,0}  && = -20.69 \, V \\
     v_A(+\infty) & = v_{A,0} + \Delta V = -20.69 \, V + 2.2742 \, V && = -18.4158 \, V
   \end{aligned}\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Current through the capacitor.}
\begin{equation*}
\begin{split}\begin{aligned}
      i_A(t)
      & = \dfrac{1}{\det \mathbf{R}} \left( R_{BB} \, \Delta v_A(t) - R_{AB} \, \Delta v_B(t) \right) = \\
      & = \dfrac{1}{\det \mathbf{R}} \left[ R_{BB} \, \left( -\frac{R_{AB}}{R_{BB}} v_{B,0} \right) \left( 1 - e^{-\frac{t}{\tau}} \right) \, h(t)  + R_{AB} \, v_{B,0} \, h(t) \right] = \\
      & = \frac{R_{AB}}{\det \mathbf{R}} v_{B,0} e^{-\frac{t}{\tau}} \, h(t) \ .
   \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
so that the values
\begin{equation*}
\begin{split}\begin{aligned} 
     i_A(0^+) & = \frac{R_{AB}}{\det \mathbf{R}} v_{B,0} = \frac{-1.2414 \, \Omega}{46.908 \, \Omega^2} \, 12.475 \, V = -0.334 \, A \\
     i_A(+\infty) & = v_{A,0} + \Delta V = -20.69 \, V + 2.2742 \, V && = 0.0 \, A
   \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
or with \(i_A = - C \frac{d \Delta v_A}{dt}\)…

\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Current across the switch}
\begin{equation*}
\begin{split}\begin{aligned}
     i_B(t) 
     & = \frac{1}{R_{BB}} \bigg[ v_B(t) - v_{B,0} - R_{BA} i_A(t) \bigg] = \\
     & = \frac{1}{R_{BB}} \bigg[ - v_{B,0} - R_{BA} \frac{R_{AB}}{\det \mathbf{R}} v_{B,0} e^{-\frac{t}{\tau}} \bigg] \, h(t) = \\
     & = - \frac{v_{B,0}}{R_{BB}} \bigg[ 1 + \frac{R_{BA} R_{AB}}{\det \mathbf{R}} \, e^{-\frac{t}{\tau}} \bigg] \, h(t) \ .
   \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
so that the values
\begin{equation*}
\begin{split}\begin{aligned}
     i_B(0^+)     & = -\frac{v_{B,0}}{R_{BB}} \left[ 1 + \frac{R_{BA} R_{AB}}{\det \mathbf{R}} \right] = -\frac{v_{B,0} R_{AA}}{\det \mathbf{R}} =  - \frac{7.0345 \, \Omega}{46.345 \, \Omega^2} \, 12.475 \, V = - 1.8929 \, A \\
     i_B(+\infty) & = -\frac{v_{B,0}}{R_{BB}} = - \dfrac{12.475 \, V}{6.8073 \, \Omega} = -1.8320 \, A \ .
   \end{aligned}\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
\sphinxstylestrong{Current \(i(t)\)}
\begin{equation*}
\begin{split}\begin{aligned}
     i(t)
     & = i_{0} - 0.4138 \, i_A(t) + 0.8966 \, i_B(t) = \\
     & = i_{0} + \left[ - 0.4138 \, i_{A,0^+} e^{-\frac{t}{\tau}}  + 0.8966 \, \left( i_{B,+\infty} + (i_{B,0^+} - i_{B,+\infty}) e^{-\frac{t}{\tau}} \right) \right] \, h(t) \ ,
   \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
so that
\begin{equation*}
\begin{split}\begin{aligned}
     i(0^+)     & = i_{0} - 0.4138 \, i_{A,0^+} + 0.8966 \, i_{B,0^+} = \\
                & = -1.7214 \, A - 0.4138 \, (-0.334 \, A) + 0.8966 \, (-1.8929 \, A) = -3.2831 \, A \\
     i(+\infty) & = i_{0} + 0.8966 \, i_{B,+\infty} = \\ 
                & = -1.7214 \, A + 0.8966 \, (-1.8320 \, A) = - 3.3671 \, A 
   \end{aligned}\end{split}
\end{equation*}
\end{itemize}



\sphinxAtStartPar
\sphinxstylestrong{Energy stored in the capacitor.}
\begin{equation*}
\begin{split}E_C(t) = \frac{1}{2} C v_A^2(t) \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and for \(t = \tau\),
\begin{equation*}
\begin{split}\begin{aligned}
  v_A(t)
  & = v_{A,0} + \Delta v_{A,+\infty} \left( 1 - e^{-\frac{t}{\tau}} \right) \, h(t) = \\
  & = -20.69 \, V + 2.2742 \, V \left( 1 - e^{-\frac{t}{\tau}} \right) \, h(t) \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and thus \(v_A(\tau) = -19.25 \, V\)
\begin{equation*}
\begin{split}E_C(\tau) = 0.5 \cdot 5 \cdot 10^{-4} \, F \cdot ( 19.25 \, V )^2 = 9.26 \cdot 10^{-2} \, J \ .\end{split}
\end{equation*}\end{sphinxadmonition}
\phantomsection \label{exercise:exam-24-09-06-exe-01}

\begin{sphinxadmonition}{note}{Exercise 6.7.3 (Exam 2024\sphinxhyphen{}09\sphinxhyphen{}06, Exercise 1.)}



\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2024-09-06-ese-01}.png}
\end{figure}
\subsubsection*{Solution}
\end{sphinxadmonition}
\phantomsection \label{exercise:exam-24-07-22-exe-01}

\begin{sphinxadmonition}{note}{Exercise 6.7.4 (Exam 2024\sphinxhyphen{}07\sphinxhyphen{}22, Exercise 1.)}



\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2024-07-22-ese-01}.png}
\end{figure}
\subsubsection*{Solution}
\end{sphinxadmonition}
\phantomsection \label{exercise:exam-24-02-13-exe-01-b}

\begin{sphinxadmonition}{note}{Exercise 6.7.5 (Exam 2024\sphinxhyphen{}02\sphinxhyphen{}13, Exercise 1.)}



\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2024-02-13-ese-01-b}.png}
\end{figure}
\subsubsection*{Solution}
\end{sphinxadmonition}

\sphinxstepscope


\subsection{Harmonic regime of linear electrical grids}
\label{\detokenize{ch/electrical-engineering-exercises-harmonic:harmonic-regime-of-linear-electrical-grids}}\label{\detokenize{ch/electrical-engineering-exercises-harmonic:classical-electromagnetism-electrical-engineering-exercises-harmonic}}\label{\detokenize{ch/electrical-engineering-exercises-harmonic::doc}}\phantomsection \label{exercise:exam-25-02-11-exe-02}

\begin{sphinxadmonition}{note}{Exercise 6.7.6 (Exam 2025\sphinxhyphen{}02\sphinxhyphen{}11, Exercise 2.)}



\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2025-02-11-ese-02}.png}
\end{figure}
\subsubsection*{Solution}

\sphinxAtStartPar
First {\hyperref[\detokenize{ch/electrical-engineering-networks:classical-electromagnetism-electrical-engineering-newtork-analysis-thevenin-1-port}]{\sphinxcrossref{\DUrole{std,std-ref}{one\sphinxhyphen{}port equivalent Thevenin circuit}}}} of the circuit with port \(A-B\) is evaluated, then {\hyperref[\detokenize{ch/electrical-engineering-networks-harmonic:classical-electromagnetism-electrical-engineering-newtork-analysis-harmonic-power}]{\sphinxcrossref{\DUrole{std,std-ref}{power flow in harmonic regime}}}} is discussed.

\sphinxAtStartPar
\sphinxstylestrong{Thevenin equivalent: voltage.} With open circuit in \(A-B\), current \(a\) flows in the lower branch and in impedence \(Z_1\). Clockwise loop currents \(i_1\) and \(i_2\) flows in the left and right loop respectively. Kirchhoff voltage laws in the left and right loops give
\begin{equation*}
\begin{split}\begin{aligned}
  0 & = e_1 - Z_L (i_1 + a) - (R_1 + Z_C) i_1 \\
  0 & = -e_2 - Z_2 (i_2 + a) - Z_3 i_2 \\
\end{aligned}
\quad \rightarrow \quad
\begin{aligned}
  i_1 & = \frac{e_1 - Z_L a}{Z_L + Z_C + R_1} \\
  i_2 & = -\frac{e_2 + Z_2 a}{Z_2 + Z_3} \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and thus using Kirchhoff voltage law on the loop with nodes \(A-B\) and closing through \(Z_1\) and \(R_1\),
\begin{equation*}
\begin{split}V_{Th} = R_1 i_1 + Z_1 a = \dots\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Thevenin equivalent: impedence.} Opening circuit at the current generator, and replace tension generators with short circuits, the equivalent impedence is
\begin{equation*}
\begin{split}Z_{Th} = ( (Z_C + Z_L) \parallel R_1) + Z_1 \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Equivalent circuit.} Kirchhoff voltage law on the equivalent circuit reads
\begin{equation*}
\begin{split}0 = V_{Th} - Z_{Th} i - Z_{x} i = 0 \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
and thus
\begin{equation*}
\begin{split}I = \frac{V_{Th}}{Z_{Th} + Z_{x}} = \dots\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Power.} Complex power reads
\begin{equation*}
\begin{split}S = V I^* = Z_x |I|^2 = \frac{Z_x}{|Z_{Th} + Z_x|^2} |V_{th}|^2 \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
Writing the impedence as \(Z_x = R_x + i X_x\), the active power reads
\begin{equation*}
\begin{split}P = \frac{ R_x }{ (R_{Th} + R_x)^2 + (X_{Th} + X_x)^2} |V_{Th}|^2 \ .\end{split}
\end{equation*}
\sphinxAtStartPar
With the physical constraints \(R \ge 0\), the problem is a constrained optimization problem of finding the maximum value of the function \(P(R_x, X_x)\) subject to the constraint \(R_x \ge 0\),
\begin{equation*}
\begin{split}\text{find } \ \max_{R_x, X_x} P(R_x, X_x) \qquad \text{s.t.} \qquad R_x \ge 0 \ .\end{split}
\end{equation*}
\sphinxAtStartPar
The denominator is the sum of two non negative terms, one function of \(R_x\) and one function of \(X_x\). The independent variable \(X_x\) only appears in this term at the denominator, so that this term must vanish at the solution of the optimization problem, and thus
\begin{equation*}
\begin{split}\widetilde{X}_x = - X_{Th} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
The remaining term is a function of \(R_x\) only and proportional to
\begin{equation*}
\begin{split}f(R_x) = \frac{R_x}{(R_{Th} + R_x)^2} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Local extremes of this function is attained where
\begin{equation*}
\begin{split}\begin{aligned}
  0 = f'(R_x) 
  & = \frac{(R_{Th} + R_x)^2 - 2 R_x (R_{Th} + R_x))}{(R_{Th} + R_x)^4} = \\
  & = \frac{R_{Th}^2 - R_x^2 }{(R_{Th} + R_x)^4} \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and thus, within the physical limit of the problem, the local and global maximum of the function (check that \(f''(\widetilde{R}_x) < 0\)), is attained for
\begin{equation*}
\begin{split}\begin{aligned}
  \widetilde{R}_{x} & = R_{Th} \\
  \widetilde{Z}_{x} & = R_{Th} - i X_{Th}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and the maximum active power is
\begin{equation*}
\begin{split}P_{max} = P(\widetilde{Z}_x) = \frac{|V_{Th}|^2}{4 R_{Th} } \ .\end{split}
\end{equation*}
\sphinxAtStartPar
while the reactive power in this condition reads
\begin{equation*}
\begin{split}Q = - \frac{ X_{Th} }{4 R^2_{Th}} |V_{Th}|^2 \ .\end{split}
\end{equation*}\end{sphinxadmonition}
\phantomsection \label{exercise:exam-25-02-11-exe-03}

\begin{sphinxadmonition}{note}{Exercise 6.7.7 (Exam 2025\sphinxhyphen{}02\sphinxhyphen{}11, Exercise 3.)}



\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2025-02-11-ese-03}.png}
\end{figure}
\subsubsection*{Solution}

\sphinxAtStartPar
First {\hyperref[\detokenize{ch/electrical-engineering-networks-harmonic:classical-electromagnetism-electrical-engineering-newtork-analysis-harmonic-power}]{\sphinxcrossref{\DUrole{std,std-ref}{power flow in harmonic regime}}}} is used to calculate load impedence, then the electrical circuit is solved, and the power on the tension generator is computed.

\sphinxAtStartPar
\sphinxstylestrong{Load impedence \(Z_L\)}. Load impedence appears in the load constitutive equation \(V_L = Z_L I_L\), and can be evalauted from data about complex power,
\begin{equation*}
\begin{split}
   S_L  & = |S_L| e^{i \phi_L} = V_L I_L^* = Z_L |I|^2 = \frac{1}{Z_L^*} |V_L|^2 \\ 
\end{split}
\end{equation*}\begin{equation*}
\begin{split}Z_L = \frac{|V_L|^2}{|S_L|} e^{i \varphi_L}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Current \(I_s\).} From data of load power, it’s possible to evaluate the current \(I_s\). The current \(I_L\) through the load reads
\begin{equation*}
\begin{split}S_L = V_L I_L^* \qquad \rightarrow \qquad I_L = \frac{S_L^*}{V_L^*} = \frac{|S_L|}{|V_L|} e^{i(-\phi_L + \phi_V)}\end{split}
\end{equation*}
\sphinxAtStartPar
The three parallel sides act as current divider so that
\begin{equation*}
\begin{split}I_L = \frac{(R_3+Z_L)^{-1}}{(R_3+Z_L)^{-1} + ( (i X_1 ) \parallel (R_2 + i X_2) )^{-1}} I_s\end{split}
\end{equation*}
\sphinxAtStartPar
and thus
\begin{equation*}
\begin{split}I_s = |I_s| e^{i \varphi_{I_s}} = \dots\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Equivalent circuit.} The impedence of the circuit powered by the tension generatore is
\begin{equation*}
\begin{split}Z_{eq} = R_1 + ( i X_1 \parallel (R_2 + i X_2) \parallel (R_3 + Z_L) ) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Given the equivalent impedance, and the current \(I_s\) the voltage across the tension generator is
\begin{equation*}
\begin{split}E_s = Z_{eq} I_s = |E_s| e^{i \varphi_{E_s}} \dots \ .\end{split}
\end{equation*}
\sphinxAtStartPar
and the power factor is \(\cos \varphi_s = \dots\), where
\begin{equation*}
\begin{split}\varphi_s = \varphi_{E_s} - \varphi_{I_s} = \dots \ . \end{split}
\end{equation*}\end{sphinxadmonition}
\phantomsection \label{exercise:exam-25-01-22-exe-02}

\begin{sphinxadmonition}{note}{Exercise 6.7.8 (Exam 2025\sphinxhyphen{}01\sphinxhyphen{}22, Exercise 2.)}



\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2025-01-22-ese-02}.png}
\end{figure}
\subsubsection*{Solution}

\sphinxAtStartPar
First {\hyperref[\detokenize{ch/electrical-engineering-networks:classical-electromagnetism-electrical-engineering-newtork-analysis-thevenin-1-port}]{\sphinxcrossref{\DUrole{std,std-ref}{one\sphinxhyphen{}port equivalent Thevenin circuit}}}} of the circuit with port \(A-B\) is evaluated, then the equivalent circuit is solved to find the tension \(v(t)\) across the current generator, and {\hyperref[\detokenize{ch/electrical-engineering-networks-harmonic:classical-electromagnetism-electrical-engineering-newtork-analysis-harmonic-power}]{\sphinxcrossref{\DUrole{std,std-ref}{power flow in harmonic regime}}}} is discussed.

\sphinxAtStartPar
\sphinxstylestrong{Thevenin equivalent: voltage.} With an open circuit, the network can be split into two parts: the triangle in the upper\sphinxhyphen{}left side and the section in the right part.

\sphinxAtStartPar
In the triangular part, a current \(I_{a}\) flows in counter\sphinxhyphen{}clockwise direction, while current \(I_b\) flows in the right part in clockwise direction,
\begin{equation*}
\begin{split}\begin{aligned}
  I_a & = \frac{E_1}{Z_1 + Z_2} \\
  I_b & = \frac{E_2 + i \Omega L_5 A_2}{Z_4 + Z_5 + Z_3} \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
as
\begin{equation*}
\begin{split}E_2 + \bigg( Z_4 + Z_3 \underbrace{- i \frac{1}{\Omega C_5} + i \Omega L_5}_{=Z_5} \bigg) I_b + i \Omega L_5 A_2 = 0 \ . \end{split}
\end{equation*}
\sphinxAtStartPar
with \(Z_k\) being the impedence of the \(k\)\sphinxhyphen{}th side. Thevenin voltage thus reads
\begin{equation*}
\begin{split}\begin{aligned}
  V_{Th} & = E_2 - Z_3 I_b + Z_2 I_a \\ 
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Thevenin equivalent: impedence.} Equivalent impedence reads
\begin{equation*}
\begin{split}Z_{Th} = (Z_1 \parallel Z_2 + ( Z_3 \parallel (Z_4 + Z_5)))\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Equivalent circuit.} Prescribed current \(A_1\) flows in the equivalent circuit, and the voltage across the current generator is evaluated with Krichhoff voltage law
\begin{equation*}
\begin{split}V_{A_1} - V_{Th} - Z_{Th} A_1 = 0 \ ,\end{split}
\end{equation*}\begin{equation*}
\begin{split}V_{A_1} = V_{Th} + Z_{Th} A_1 = |V_A| e^{i \varphi_{V_{A_1}}} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
Signal in time is reconstructed using using the relation between effective and maximum amplitude of the oscillation and evaluating the real part of the signal \(|V_{A_1}| e^{i(\Omega t + \varphi_{V_{A_1}})}\)
\begin{equation*}
\begin{split}v_{A_1}(t) = \sqrt{2} |V_{A_1}| \cos(\Omega t + \varphi_{V_{A_1}}) \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Poer.} Using definitions of {\hyperref[\detokenize{ch/electrical-engineering-networks-harmonic:classical-electromagnetism-electrical-engineering-newtork-analysis-harmonic-power}]{\sphinxcrossref{\DUrole{std,std-ref}{power in circuits in harmonic regime}}}},
\begin{equation*}
\begin{split}\begin{aligned}
   S_{A_1}  & = V_{A_1} I_{A_1}^* \\
  |S_{A_1}| & = |V_{A_1}| |I_{A_1}| \\
   P_{A_1}  & = \text{re} \{ S_{A_1} \} \\
   Q_{A_1}  & = \text{im} \{ S_{A_1} \} \\
\end{aligned}\end{split}
\end{equation*}\end{sphinxadmonition}
\phantomsection \label{exercise:exam-24-09-06-exe-02}

\begin{sphinxadmonition}{note}{Exercise 6.7.9 (Exam 2024\sphinxhyphen{}09\sphinxhyphen{}06, Exercise 2.)}



\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2024-09-06-ese-02}.png}
\end{figure}
\subsubsection*{Solution}
\end{sphinxadmonition}
\phantomsection \label{exercise:exam-24-07-22-exe-02}

\begin{sphinxadmonition}{note}{Exercise 6.7.10 (Exam 2024\sphinxhyphen{}07\sphinxhyphen{}22, Exercise 2.)}



\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2024-07-22-ese-02}.png}
\end{figure}
\subsubsection*{Solution}
\end{sphinxadmonition}

\sphinxstepscope


\subsection{Three\sphinxhyphen{}phase electrical circuits in harmonic regime}
\label{\detokenize{ch/electrical-engineering-exercises-three-phase:three-phase-electrical-circuits-in-harmonic-regime}}\label{\detokenize{ch/electrical-engineering-exercises-three-phase:classical-electromagnetism-electrical-engineering-exercises-three-phase}}\label{\detokenize{ch/electrical-engineering-exercises-three-phase::doc}}
\begin{sphinxadmonition}{note}{Guidelines for solution}

\sphinxAtStartPar
Analyse the network as a standard configuration of a three\sphinxhyphen{}phase network ({\hyperref[\detokenize{ch/electrical-engineering-three-phase:classical-electromagnetism-electrical-engineering-three-phase-star-star}]{\sphinxcrossref{\DUrole{std,std-ref}{star\sphinxhyphen{}star}}}},…) and rely on results derived for {\hyperref[\detokenize{ch/electrical-engineering-three-phase:classical-electromagnetism-electrical-engineering-three-phase}]{\sphinxcrossref{\DUrole{std,std-ref}{three\sphinxhyphen{}phase circuits}}}}.

\sphinxAtStartPar
As an example, for a \sphinxstylestrong{star\sphinxhyphen{}star configuration}:
\begin{enumerate}
\sphinxsetlistlabels{\arabic}{enumi}{enumii}{}{.}%
\item {} 
\sphinxAtStartPar
evaluate load impedances, impedances in parallel with the generators, interconnections between phases

\item {} 
\sphinxAtStartPar
evaluate voltage difference across the centers of the stars, \(v_{AB}\)

\item {} 
\sphinxAtStartPar
once \(v_{AB}\) is known, it should be easier to evaluate currents and voltages in the grid with KCL and KVL

\item {} 
\sphinxAtStartPar
use relations of {\hyperref[\detokenize{ch/electrical-engineering-networks-harmonic:classical-electromagnetism-electrical-engineering-newtork-analysis-harmonic-power}]{\sphinxcrossref{\DUrole{std,std-ref}{power in harmonic regime}}}}, to answer the questions about power: just remember the difference between maximum and effective values, and that a wattmeter measures the active power

\end{enumerate}
\end{sphinxadmonition}
\phantomsection \label{exercise:exam-24-09-06-exe-03}

\begin{sphinxadmonition}{note}{Exercise 6.7.11 (Exam 2024\sphinxhyphen{}09\sphinxhyphen{}06, Exercise 3.)}



\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2024-09-06-ese-03}.png}
\end{figure}
\subsubsection*{Solution}

\sphinxAtStartPar
This network is a star\sphinxhyphen{}star connection with impedances
\begin{equation*}
\begin{split}\begin{aligned}
  Z_g & = ( R_1 + s L_1 ) \parallel \frac{1}{s C_1} \qquad g = 1:3 \\
  Z_4 & = R_2 + \frac{1}{s C_2}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and inter\sphinxhyphen{}connection between phases \(2\) and \(3\) with impedance \(Z_4\).



\sphinxAtStartPar
\sphinxstylestrong{Voltage \(v_{AB}\).}
\begin{equation*}
\begin{split}v_{AB} = \dfrac{ \sum_{g=1}^{3} Y_g \, e_g }{\sum_{k=1}^{4} Y_4}\end{split}
\end{equation*}
\sphinxAtStartPar
Generation and loads are equilibrated, and thus \(\sum_{g=1}^{3} Y_g \, e_g = 0\), and \(v_{AB} = 0\).

\sphinxAtStartPar
\sphinxstylestrong{Current \(i_{Z_2}\).} As \(v_{AB}=0\), then \(i_{Z_2} = 0\), as in general it whould be \(i_{Z_2} = \frac{v_{AB}}{R_2 + \frac{1}{sC_2}}\).

\sphinxAtStartPar
\sphinxstylestrong{Current \(i_{Z_4}\).} With KVL on the loop with the two tension generators \(e_2\), \(e_3\) closed with \(Z_4\)
\begin{equation*}
\begin{split}\begin{aligned}
  0 & = e_3 + Z_4 i_{Z_4} - e_2 \\
  \rightarrow \quad i_{Z_4} & = \frac{e_2 - e_3}{Z_4}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Currents \(i_{e_2}\).} Current \(i_{e_2}\) through the generator are evaluated through KVL between the centers of the stars,
\begin{equation*}
\begin{split}\begin{aligned}
  0
  & = e_2 - \dfrac{1}{\frac{1}{R_1 + s L_1} + s C_1 } i_{e_2} - v_{AB} \\
  \rightarrow \quad i_{e_2} & = \left[ \frac{1}{R_1 + s L_1} + s C_1 \right] e_2 \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Powers of generator \(2\).}
\begin{equation*}
\begin{split}\begin{aligned}
  S_2 & = V_2 I_2^* \\
  A_2 & = |S_2| \\
  P_2 & = \text{re} \{ S_2 \} \\
  Q_2 & = \text{im} \{ S_2 \} \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
using the effective values of tension and current \(V_2\), \(I_2\).
\end{sphinxadmonition}
\phantomsection \label{exercise:exam-24-07-22-exe-03}

\begin{sphinxadmonition}{note}{Exercise 6.7.12 (Exam 2024\sphinxhyphen{}07\sphinxhyphen{}22, Exercise 3.)}



\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2024-07-22-ese-03}.png}
\end{figure}
\subsubsection*{Solution}

\sphinxAtStartPar
This network is a star\sphinxhyphen{}star connection with impedances
\begin{equation*}
\begin{split}\begin{aligned}
  Z_1 & = ( R_1 + j X_{C_1} ) \parallel R_2 \\
  Z_2 & = 0 \\
  Z_3 & = ( R_3 + j X_{L_2} ) \parallel j X_{L_1} \\
  Z_4 & = j X_{C_2}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and inter\sphinxhyphen{}connection between phase \(3\) and the netural with \sphinxstylestrong{resistance \(R_4\)}, before \(Z_4\), and thus \sphinxstylestrong{in parallel with the generator \(3\)}.

\sphinxAtStartPar
\sphinxstylestrong{Voltage \(v_{AB}\).} As \(Z_2 = 0\), it’s not possible to directly use
\begin{equation*}
\begin{split}v_{AB} = \dfrac{ \sum_{g=1}^{3} Y_g \, e_g }{\sum_{k=1}^{4} Y_4} \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
or this must be used with the limit \(Y_2 \rightarrow + \infty\), and thus
\begin{equation*}
\begin{split}v_{AB} = e_2 \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Wattmeter tension \(v_W\).} KVL with the generators \(2\) and \(3\),
\begin{equation*}
\begin{split}v_W = e_2 - e_3 \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Wattmeter current \(i_w = i_{e_2}\).} KCL on the center of generation star, \(0 = i_{e_1} + i_{e_2} + i_{3} + i_{4}\), with
\begin{equation*}
\begin{split}\begin{aligned}
  i_{e_1} & =  \frac{1}{Z_1} ( e_1 - v_{AB} ) \\
  i_{3}   & =  \frac{1}{Z_3} ( e_3 - v_{AB} ) \\
  i_{4}   & = -\frac{1}{Z_4}   v_{AB}   \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
being \(i_3 = i_{e_3} + i_{R_4}\) the sum of the current in the parallel connection on the branch \(3\) of the generation. Thus, current \(i_{e_2}\) reads
\begin{equation*}
\begin{split}\begin{aligned}
  i_{e_2} 
  & = - i_{e_1} - i_{3} - i_{4} = \\
  & = - \frac{e_1}{Z_1} - \frac{e_3}{Z_3} + \left(  \frac{1}{Z_1} + \frac{1}{Z_3} + \frac{1}{Z_4}  \right) v_{AB}
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Wattmeter.} Wattmeter reading provides the active power
\begin{equation*}
\begin{split}P_w = \text{re} \{ S_w \} = \text{re} \{ v_w i_w^* \} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Power on \(C_2\).} Current and voltage across \(C_2\) are
\begin{equation*}
\begin{split}\begin{aligned}
  i_{C_2} & = i_4 \\
  v_{C_2} & = Z_{C_2} i_{C_2} = \frac{1}{s C_2} i_{C_2} \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and the complex power is
\begin{equation*}
\begin{split}s = V_{C_2} I_{C_2}^* \ .\end{split}
\end{equation*}\end{sphinxadmonition}
\phantomsection \label{exercise:exam-24-06-19-exe-01}

\begin{sphinxadmonition}{note}{Exercise 6.7.13 (Exam 2024\sphinxhyphen{}06\sphinxhyphen{}19, Exercise 1.)}



\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2024-06-19-ese-01}.png}
\end{figure}
\subsubsection*{Solution}

\sphinxAtStartPar
This network is a star\sphinxhyphen{}star connection with impedances
\begin{equation*}
\begin{split}\begin{aligned}
  Z_1 & = ( R_2 + j X_{L_2} ) \parallel ( j X_{C_1} ) \\
  Z_2 & = ( R_1 \parallel 0 ) \\
  Z_3 & = ( R_3 + j X_{C_2} ) \parallel j X_{L_1} \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
with \(L_2\) and \(R_4\) in parallel with generator \(e_2\). As \(R_1\) is in parallel with a short\sphinxhyphen{}circuit in \(Z_2\), this impedance is zero and as it is the current through \(R_1\). There’s no neutral.

\sphinxAtStartPar
\sphinxstylestrong{Voltage \(v_{AB}\).} As \(Z_2 = 0\) (see previous exercise), the voltage between the centers of the stars is
\begin{equation*}
\begin{split}v_{AB} = e_2 \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Wattmeter tension \(v_W\).} KVL with the generators \(2\) and \(3\),
\begin{equation*}
\begin{split}v_W = e_1 - e_3 \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Wattmeter current \(i_w = i_{2}\).} KCL on the center of generation star, \(0 = i_{e_1} + i_{2} + i_{e_3}\), with
\begin{equation*}
\begin{split}\begin{aligned}
  i_{e_1} & =  \frac{1}{Z_1} ( e_1 - e_2 ) \\
  i_{e_3} & =  \frac{1}{Z_3} ( e_3 - e_2 ) \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
being \(i_2 = i_{e_2} + i_{L_1} + i_{R_4}\) the sum of the current in the parallel connection on the branch \(2\) of the generation. Thus, current \(i_{w}\) reads
\begin{equation*}
\begin{split}\begin{aligned}
  i_w = i_{2} 
  & = - i_{e_1} - i_{e_3} = \\
  & = \frac{1}{Z_1} ( e_2 - e_1 ) + \frac{1}{Z_3} ( e_2 - e_3 ) \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Wattmeter.} Wattmeter reading provides the active power
\begin{equation*}
\begin{split}P_w = \text{re} \{ S_w \} = \text{re} \{ v_w i_w^* \} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
\sphinxstylestrong{Power of tension generator \(e_1\).}
\begin{equation*}
\begin{split}s_{e_1} = e_{2} i_{e_2}^* \ .\end{split}
\end{equation*}
\sphinxAtStartPar
…
\end{sphinxadmonition}
\phantomsection \label{exercise:exam-24-02-13-exe-02}

\begin{sphinxadmonition}{note}{Exercise 6.7.14 (Exam 2024\sphinxhyphen{}02\sphinxhyphen{}13, Exercise 2.)}



\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2024-02-13-ese-02}.png}
\end{figure}
\subsubsection*{Solution}
\end{sphinxadmonition}

\sphinxstepscope

\sphinxAtStartPar
1classical\sphinxhyphen{}electromagnetism:electrical\sphinxhyphen{}engineering\sphinxhyphen{}exercises:electromagnetic)=


\subsection{Electromagnetic circuits}
\label{\detokenize{ch/electrical-engineering-exercises-electromagnetic:electromagnetic-circuits}}\label{\detokenize{ch/electrical-engineering-exercises-electromagnetic::doc}}\phantomsection \label{exercise:exam-25-01-22-exe-03}

\begin{sphinxadmonition}{note}{Exercise 6.7.15 (Exam 2025\sphinxhyphen{}01\sphinxhyphen{}22, Exercise 3.)}



\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2025-01-22-ese-03}.png}
\end{figure}
\end{sphinxadmonition}
\phantomsection \label{exercise:exam-24-06-19-exe-02}

\begin{sphinxadmonition}{note}{Exercise 6.7.16 (Exam 2024\sphinxhyphen{}06\sphinxhyphen{}19, Exercise 2.)}



\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2025-01-22-ese-03}.png}
\end{figure}
\end{sphinxadmonition}
\phantomsection \label{exercise:exam-24-02-13-exe-01-a}

\begin{sphinxadmonition}{note}{Exercise 6.7.17 (Exam 2024\sphinxhyphen{}02\sphinxhyphen{}13, Exercise 1a.)}



\begin{figure}[htbp]
\centering

\noindent\sphinxincludegraphics{{exam-2024-02-13-ese-01-a}.png}
\end{figure}
\end{sphinxadmonition}

\sphinxstepscope


\part{Numerical Methods}

\sphinxstepscope

\begin{sphinxuseclass}{sd-container-fluid}
\begin{sphinxuseclass}{sd-sphinx-override}
\begin{sphinxuseclass}{sd-p-0}
\begin{sphinxuseclass}{sd-mt-2}
\begin{sphinxuseclass}{sd-mb-4}
\begin{sphinxuseclass}{sd-row}
\begin{sphinxuseclass}{sd-row-cols-2}
\begin{sphinxuseclass}{sd-gx-2}
\begin{sphinxuseclass}{sd-gy-1}
\begin{sphinxuseclass}{sd-col}
\begin{sphinxuseclass}{sd-d-flex-row}
\begin{sphinxuseclass}{sd-align-minor-center}
\begin{sphinxuseclass}{sd-container-fluid}
\begin{sphinxuseclass}{sd-sphinx-override}
\begin{sphinxuseclass}{sd-row}
\begin{sphinxuseclass}{sd-row-cols-2}
\begin{sphinxuseclass}{sd-row-cols-xs-2}
\begin{sphinxuseclass}{sd-row-cols-sm-3}
\begin{sphinxuseclass}{sd-row-cols-md-3}
\begin{sphinxuseclass}{sd-row-cols-lg-3}
\begin{sphinxuseclass}{sd-gx-3}
\begin{sphinxuseclass}{sd-gy-1}
\begin{sphinxuseclass}{sd-col}
\begin{sphinxuseclass}{sd-col-auto}
\begin{sphinxuseclass}{sd-d-flex-row}
\begin{sphinxuseclass}{sd-align-minor-center}
\sphinxAtStartPar
basics

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{sd-col}
\begin{sphinxuseclass}{sd-col-auto}
\begin{sphinxuseclass}{sd-d-flex-row}
\begin{sphinxuseclass}{sd-align-minor-center}
\sphinxAtStartPar
Apr 28, 2025

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{sd-col}
\begin{sphinxuseclass}{sd-col-auto}
\begin{sphinxuseclass}{sd-d-flex-row}
\begin{sphinxuseclass}{sd-align-minor-center}
\sphinxAtStartPar
1 min read

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}

\chapter{Green’s function method}
\label{\detokenize{ch/green-function:green-s-function-method}}\label{\detokenize{ch/green-function:classical-electromagnetism-green-function}}\label{\detokenize{ch/green-function::doc}}

\section{Poisson equation}
\label{\detokenize{ch/green-function:poisson-equation}}
\sphinxAtStartPar
General Poisson’s problem
\begin{equation*}
\begin{split}\begin{cases}
  - \nabla^2 \mathbf{u}(\mathbf{r}, t) = \mathbf{f}(\mathbf{r},t) \\
  \text{+ b.c.}
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
with common boundary conditions
\begin{equation*}
\begin{split}\begin{cases}
\mathbf{u} = \mathbf{g} & \quad \text{on $S_D$} \\
\hat{\mathbf{n}} \cdot \nabla \mathbf{u} = \mathbf{h} & \quad \text{on $S_N$}
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
over Dirichlet and Neumann regions of the boundary.

\sphinxAtStartPar
Poisson’s problem for Green’s function, in infinite domain
\begin{equation*}
\begin{split}
  - \nabla_{\mathbf{r}}^2 G(\mathbf{r}; \mathbf{r}_0) = \delta(\mathbf{r} - \mathbf{r}_0) \\
\end{split}
\end{equation*}
\sphinxAtStartPar
Green’s function method
\begin{equation*}
\begin{split}\begin{aligned}
  E(\mathbf{r}_0, t) u_i(\mathbf{r}_0, t) 
  & =   \int_{\mathbf{r} \in \Omega} u_i(\mathbf{r},t) \delta(\mathbf{r}-\mathbf{r}_0) = \\
  & = - \int_{\mathbf{r} \in \Omega} u_i(\mathbf{r},t) \nabla_{\mathbf{r}}^2 G(\mathbf{r}-\mathbf{r}_0) = \\
  & = - \int_{\mathbf{r} \in \Omega} \nabla_{\mathbf{r}} \cdot ( u_i \nabla_{\mathbf{r}} G - G \nabla_{\mathbf{r}} u_i) - \int_{\mathbf{r} \in \Omega} G \nabla^2 u_i= \\
  & = - \oint_{\mathbf{r} \in \partial \Omega} \hat{\mathbf{n}} \cdot ( u_i \nabla_{\mathbf{r}} G - G \nabla_{\mathbf{r}} u_i) + \int_{\mathbf{r} \in \Omega} G(\mathbf{r}-\mathbf{r}_0) f_i(\mathbf{r}, t) . \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
An integro\sphinxhyphen{}differential boundary problem can be written using boundary conditions. As an example, using Dirichlet and Neumann boundary conditions, the integro\sphinxhyphen{}differential problem reads
\begin{equation*}
\begin{split}\begin{aligned}
&  E(\mathbf{r}_0, t) \mathbf{u}(\mathbf{r}_0, t) 
+ \int_{\mathbf{r} \in S_N} \mathbf{u}(\mathbf{r},t) \, \hat{\mathbf{n}} \cdot \nabla_{\mathbf{r}} G(\mathbf{r}-\mathbf{r}_0)
- \int_{\mathbf{r} \in S_D} G(\mathbf{r}-\mathbf{r}_0) \, \hat{\mathbf{n}} \cdot \nabla_{\mathbf{r}} \mathbf{u}(\mathbf{r},t) = \\ 
& =
- \int_{\mathbf{r} \in S_D} \mathbf{g}(\mathbf{r},t) \, \hat{\mathbf{n}} \cdot \nabla_{\mathbf{r}} G(\mathbf{r}-\mathbf{r}_0)
+ \int_{\mathbf{r} \in S_N} G(\mathbf{r}-\mathbf{r}_0) \, \mathbf{h}(\mathbf{r},t)  
+ \int_{\mathbf{r} \in \Omega} G(\mathbf{r}-\mathbf{r}_0) \, \mathbf{f}(\mathbf{r}, t) . \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Green’s function of the Poisson\sphinxhyphen{}Laplace equation reads
\begin{equation*}
\begin{split}G(\mathbf{r};\mathbf{r}_0) = \frac{1}{4 \pi} \frac{1}{\left| \mathbf{r}-\mathbf{r}_0 \right|} \ .\end{split}
\end{equation*}\subsubsection*{Green’s function of the Laplace equation}
\begin{equation*}
\begin{split}-\nabla^2 G = 0 \qquad \text{for $\mathbf{r} \ne \mathbf{r}_0$}\end{split}
\end{equation*}
\sphinxAtStartPar
Solutions with spherical symmetry,
\begin{equation*}
\begin{split}0 = \nabla^2 G = \frac{1}{r^2} \left( r^2 G' \right)'
\quad \rightarrow \quad
G'(r) = \frac{A}{r^2} \quad \rightarrow \quad G(r) = - \frac{A}{r} + B
\end{split}
\end{equation*}
\sphinxAtStartPar
Choosing \(B = 0\) s.t. \(G(r) \rightarrow 0\) as \(r \rightarrow \infty\), and integrating over a sphere centered in \(r=0\) to get \(A = -\frac{1}{4 \pi}\),
\begin{equation*}
\begin{split}1 = \int_{V} \delta(r) = - \int_{V} \nabla^2 G = - \oint_{\partial V} \hat{\mathbf{n}} \cdot \nabla G
= -\oint_{\partial V} \hat{\mathbf{r}} \cdot \hat{\mathbf{r}} \frac{A}{r^2} = - 4 \pi \, A \end{split}
\end{equation*}

\section{Helmholtz equation}
\label{\detokenize{ch/green-function:helmholtz-equation}}
\sphinxAtStartPar
\sphinxstylestrong{todo} from Fourier to Laplace trasnform in the first lines of this section

\sphinxAtStartPar
A Helmholtz’s equation can be thouoght as the time Fourier transform of a wave equation,
\begin{equation*}
\begin{split}\begin{cases}
  \dfrac{1}{c^2} \partial_{tt} \mathbf{u}(\mathbf{r},t) - \nabla^2 \mathbf{u}(\mathbf{r},t) = \mathbf{f}(\mathbf{r},t) \\
  \text{+ b.c.} \\
  \text{+ i.c.} \ ,
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
Fourier transform in time of field \(\mathbf{u}(\mathbf{r},t)\) reads
\begin{equation*}
\begin{split}\tilde{\mathbf{u}}(\mathbf{r}, \omega) = \mathscr{F}\{ \mathbf{u}(\mathbf{r},t) \} = \int_{t=-\infty}^{+\infty} \mathbf{u}(\mathbf{r},t) e^{-i \omega t} \, d \omega\end{split}
\end{equation*}
\sphinxAtStartPar
and, if \(\mathbf{u}(\mathbf{r},t)\) is compact in time, Fourier transform of its time partial derivatives read
\begin{equation*}
\begin{split}\begin{aligned}
  \mathscr{F}\{ \dot{\mathbf{u}}(\mathbf{r},t) \} 
  & = \int_{t=-\infty}^{+\infty} \dot{\mathbf{u}}(\mathbf{r},t) e^{-i \omega t} \, d \omega = \\
  & = \mathbf{u}(\mathbf{r},t) e^{-i \omega t} \big|_{t=-\infty}^{+\infty} + i \omega \int_{t=-\infty}^{+\infty} \mathbf{u}(\mathbf{r},t) e^{-i \omega t} \, d \omega = \\
  & = i \omega \mathscr{F}\{  \mathbf{u}(\mathbf{r},t) \}
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathscr{F}\{ \partial_t^n \mathbf{u}(\mathbf{r},t) \} = (i \omega)^n \tilde{\mathbf{u}} \ .\end{split}
\end{equation*}
\sphinxAtStartPar
The differential problem in the transformed domain thus reads
\begin{equation*}
\begin{split}- \frac{\omega^2}{c^2} \tilde{\mathbf{u}} - \nabla^2 \tilde{\mathbf{u}} = \tilde{\mathbf{f}}\end{split}
\end{equation*}
\sphinxAtStartPar
Green’s function of Helmholtz’e equation reads
\begin{equation*}
\begin{split}G(\mathbf{r}, s) =
  \alpha^+ \frac{e^{ \frac{s|\mathbf{r} - \mathbf{r}_0|}{c}}}{|\mathbf{r} - \mathbf{r}_0|} +
  \alpha^- \frac{e^{-\frac{s|\mathbf{r} - \mathbf{r}_0|}{c}}}{|\mathbf{r} - \mathbf{r}_0|}
\end{split}
\end{equation*}
\sphinxAtStartPar
with \(\alpha^+ + \alpha^- = \frac{1}{4 \pi}\).

\sphinxAtStartPar
Being the Laplace transform,
\begin{equation*}
\begin{split}\mathscr{L}\{ f(t) \} = \int_{t=0^-}^{+\infty} f(t) e^{-st} dt \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
the Laplace transform of a causal function with time delay \(\tau \ge 0\) reads
\begin{equation*}
\begin{split}\mathscr{L}\{ f(t-\tau) \} = \int_{t=0^-}^{+\infty} f(t-\tau) e^{-st} dt = \int_{z = - \tau}^{+\infty} f(z) e^{-s(z+\tau)} \, dz = e^{-s\tau} \, \int_{z = 0}^{+\infty} f(z) e^{-s z} \, dz = e^{-s \tau} \, \mathscr{L}\{ f(t) \}\end{split}
\end{equation*}
\sphinxAtStartPar
having used causality \(f(t) = 0\) for \(t < 0\). Laplace transform of Dirac’s delta \(\delta(t)\) reads
\begin{equation*}
\begin{split}\mathscr{L}\{ \delta(t) \} = \int_{t=0^-}^{+\infty} \delta(t) \, dt = 1 \ ,\end{split}
\end{equation*}
\sphinxAtStartPar
so that \(e^{-s \tau} = e^{- s \tau} \, 1 = \mathscr{L}\{ \delta(t-\tau) \}\).

\sphinxAtStartPar
Thus, Green’s function for the wave equation reads
\begin{equation*}
\begin{split}G(\mathbf{r},t; \mathbf{r}_0, t_0) = 
  \alpha^+ \frac{ \delta \left( t - t_0 + \frac{|\mathbf{r}-\mathbf{r}_0|}{c} \right)}{|\mathbf{r} - \mathbf{r}_0|} +
  \alpha^- \frac{ \delta \left( t - t_0 - \frac{|\mathbf{r}-\mathbf{r}_0|}{c} \right)}{|\mathbf{r} - \mathbf{r}_0|}
\end{split}
\end{equation*}
\sphinxAtStartPar
If \(t \ge t_0\), and \(G(\mathbf{r}, t; \mathbf{r}_0, t_0)\) connects the past \(t_0\) with the future \(t\), the first term is not causal, and thus \(\alpha^+ = 0\) and
\begin{equation*}
\begin{split}G(\mathbf{r},t; \mathbf{r}_0, t_0) = \frac{1}{4 \pi} \frac{ \delta \left( t - t_0 - \frac{|\mathbf{r}-\mathbf{r}_0|}{c} \right)}{|\mathbf{r} - \mathbf{r}_0|} \ .\end{split}
\end{equation*}\subsubsection*{Green’s function of Helmholtz’s equation}
\begin{equation*}
\begin{split}\frac{s^2}{c^2} G - \nabla^2 G = \delta(r)\end{split}
\end{equation*}\begin{equation*}
\begin{split}G(r) = \frac{\alpha e^{k r} + \beta e^{-kr}}{r}\end{split}
\end{equation*}
\sphinxAtStartPar
Proof:
\begin{itemize}
\item {} 
\sphinxAtStartPar
Gradient
\begin{equation*}
\begin{split}\nabla G(r) = \hat{\mathbf{r}} \partial_r G = \hat{\mathbf{r}} \frac{\alpha (k r - 1) e^{kr} + \beta(-k r - 1)e^{-kr}}{r^2}\end{split}
\end{equation*}
\item {} 
\sphinxAtStartPar
Laplacian
\begin{equation*}
\begin{split}\begin{aligned}
    \nabla^2 G(r) & = \frac{1}{r^2} \left( r^2 G'(r) \right)' = \\
    & = \frac{1}{r^2} \left(  \alpha (k r - 1) e^{kr} + \beta(-k r - 1)e^{-kr}\right)' = \\
    & = \frac{1}{r^2} \left( \alpha k e^{kr} + \alpha k^2 r  e^{kr} - \alpha k e^{kr} - \beta k e^{-kr} + \beta k^2 r e^{-kr} + \beta k e^{-kr}  \right) = \\
    & = \frac{1}{r} \left( \alpha e^{kr} + \beta e^{-kr} \right) k^2 = k^2 G(r) \ .
  \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
and thus \(k^2 G(r) - \nabla^2 G = 0\), for \(r \ne 0\);

\item {} 
\sphinxAtStartPar
Unity
\begin{equation*}
\begin{split}1 = \int_{V} \delta(r) = \int_V \left( k^2 G - \nabla^2 G \right) = \int_V k^2 G - \oint_{\partial V} \hat{\mathbf{n}} \cdot \nabla G \end{split}
\end{equation*}
\sphinxAtStartPar
the second term is the sum of two contributions of the form
\begin{equation*}
\begin{split}\oint_{\partial V} \hat{\mathbf{n}} \cdot \nabla G^{\pm} = \oint_{\partial V} \frac{\alpha^{\pm}(\pm k r - 1) e^{\pm k r}}{r^2} = 4 \pi \alpha^{\pm} (\pm k r - 1) e^{\pm k r}\end{split}
\end{equation*}
\sphinxAtStartPar
the first term is the sum of two contributions of the form
\begin{equation*}
\begin{split}\begin{aligned}
    k^2 \int_{V} G(r)
      & = k^2 \int_{V} \frac{\alpha^{\pm} e^{\pm k r}}{r} = \\
      & = k^2 \alpha^{\pm} \int_{R = 0}^{r} \int_{\phi=0}^{\pi} \int_{\theta=0}^{2 \pi} \frac{e^{\pm k R}}{R} R^2 \sin \phi \, dR \, d \phi \, d \theta = \\
      & = k^2 \alpha^{\pm} \, 4 \pi \int_{R = 0}^{r} R \, e^{\pm k R} \, dR \ .
  \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
the last integral can be evaluated with integration by parts
\begin{equation*}
\begin{split}\begin{aligned}
    \int_{R = 0}^{r} R \, e^{\pm k R} \, dR
    & = \left.\left[ \frac{1}{\pm k} e^{\pm k R } R \right]\right|_{R=0}^{r} \mp \frac{1}{k} \int_{R=0}^{r} e^{\pm k R} \, dR = \\
    & = \frac{1}{\pm k} e^{\pm k r } r  - \frac{1}{k^2} e^{\pm k R} + \frac{1}{k^2} = \\
  \end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
Thus summing everything together,
\begin{equation*}
\begin{split}\begin{aligned}
    1 & = \alpha^+ \left[ 4 \pi k^2 \left( \frac{r}{k} e^{k r} - \frac{1}{k^2} e^{kr} + \frac{1}{k^2} \right) - 4 \pi \left( k r - 1 \right) e^{kr} \right] + \alpha^- \left[ \dots \right] = \\
      & = 4 \pi \left( \alpha^+ + \alpha^- \right) \ .
  \end{aligned}\end{split}
\end{equation*}
\end{itemize}


\section{Wave equation}
\label{\detokenize{ch/green-function:wave-equation}}
\sphinxAtStartPar
Wave equation general problem
\begin{equation*}
\begin{split}\begin{cases}
  \dfrac{1}{c^2} \partial_{tt} \mathbf{u}(\mathbf{r},t) - \nabla^2 \mathbf{u}(\mathbf{r},t) = \mathbf{f}(\mathbf{r},t) \\
  \text{+ b.c.} \\
  \text{+ i.c.} \\
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
Green’s problem of the wave equation
\begin{equation*}
\begin{split}\frac{1}{c^2} \partial_{tt} G(\mathbf{r},t;\mathbf{r}_0,t_0) - \nabla_{\mathbf{r}}^2 G(\mathbf{r},t;\mathbf{r}_0,t_0) = \delta(\mathbf{r}-\mathbf{r}_0) \delta(t-t_0)\end{split}
\end{equation*}
\sphinxAtStartPar
Integration by parts
\begin{equation*}
\begin{split}\begin{aligned}
  E(\mathbf{r}_{\alpha}, t_{\alpha}) \mathbf{u}(\mathbf{r}_{\alpha},t_{\alpha}) & = \int_{t \in T} \int_{\mathbf{r} \in V} \delta(t-t_{\alpha}) \delta(\mathbf{r}-\mathbf{r}_{\alpha}) \mathbf{u}(\mathbf{r},t) = \\
  & = \int_{t \in T} \int_{\mathbf{r} \in V} \left\{ \frac{1}{c^2} \partial_{tt} G - \nabla^2_{\mathbf{r}} G \right\} \mathbf{u} = \\
  & = \int_{t \in T} \int_{\mathbf{r} \in V} \left\{ \frac{1}{c^2} \left[ \partial_t \left( \mathbf{u} \partial_t G - G \partial_t \mathbf{u} \right) + G \partial_{tt} \mathbf{u} \right] - \nabla_{\mathbf{r}} \cdot \left( \nabla_{\mathbf{r}} G \, \mathbf{u} - G \nabla_{\mathbf{r}} \mathbf{u} \right) - G \, \nabla^2_{\mathbf{r}} \mathbf{u} \right\} = \\
  & = \int_{\mathbf{r} \in V} \frac{1}{c^2} \left[ \mathbf{u}(\mathbf{r},t) \partial_t G(\mathbf{r},t; \mathbf{r}_{\alpha},t_{\alpha}) - G(\mathbf{r},t; \mathbf{r}_{\alpha},t_{\alpha}) \partial_t \mathbf{u}(\mathbf{r},t) \right] \bigg|_{t_0}^{t_1} + \\
  & \quad + \int_{t \in T} \oint_{\mathbf{r} \in \partial V} \left\{ - \hat{\mathbf{n}}(\mathbf{r},t) \cdot \nabla_{\mathbf{r}} G(\mathbf{r},t; \mathbf{r}_{\alpha},t_{\alpha}) \, \mathbf{u}(\mathbf{r},t) + G(\mathbf{r},t; \mathbf{r}_{\alpha},t_{\alpha}) \, \hat{\mathbf{n}}(\mathbf{r},t) \cdot \nabla_{\mathbf{r}} \mathbf{u}(\mathbf{r},t) \right\} + \\
  & \quad + \int_{t \in T}  \int_{\mathbf{r} \in V} G(\mathbf{r},t; \mathbf{r}_{\alpha},t_{\alpha}) \underbrace{ \left\{ \frac{1}{c^2} \partial_{tt} \mathbf{u}(\mathbf{r},t) - \nabla^2_{\mathbf{r}} \mathbf{u}(\mathbf{r},t) \right\}}_{= \mathbf{f}(\mathbf{r},t)} \\
\end{aligned}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
  \int_{t \in T} \int_{\mathbf{r} \in V} \frac{1}{4 \pi}\frac{\delta\left( t-t_{\alpha} + \frac{|\mathbf{r} - \mathbf{r}_{\alpha}|}{c} \right)}{|\mathbf{r} - \mathbf{r}_{\alpha}|} \, \mathbf{f}(\mathbf{r},t) 
  & = \int_{\mathbf{r} \in V \cap B_{|\mathbf{r} - \mathbf{r}_{\alpha}| \le c (t_\alpha - t)}} \frac{1}{4 \pi |\mathbf{r} - \mathbf{r}_{\alpha}|} \mathbf{f}\left(\mathbf{r}, t_{\alpha} - \frac{|\mathbf{r}-\mathbf{r}_{\alpha}|}{c}\right)
\end{aligned}\end{split}
\end{equation*}
\sphinxstepscope

\begin{sphinxuseclass}{sd-container-fluid}
\begin{sphinxuseclass}{sd-sphinx-override}
\begin{sphinxuseclass}{sd-p-0}
\begin{sphinxuseclass}{sd-mt-2}
\begin{sphinxuseclass}{sd-mb-4}
\begin{sphinxuseclass}{sd-row}
\begin{sphinxuseclass}{sd-row-cols-2}
\begin{sphinxuseclass}{sd-gx-2}
\begin{sphinxuseclass}{sd-gy-1}
\begin{sphinxuseclass}{sd-col}
\begin{sphinxuseclass}{sd-d-flex-row}
\begin{sphinxuseclass}{sd-align-minor-center}
\begin{sphinxuseclass}{sd-container-fluid}
\begin{sphinxuseclass}{sd-sphinx-override}
\begin{sphinxuseclass}{sd-row}
\begin{sphinxuseclass}{sd-row-cols-2}
\begin{sphinxuseclass}{sd-row-cols-xs-2}
\begin{sphinxuseclass}{sd-row-cols-sm-3}
\begin{sphinxuseclass}{sd-row-cols-md-3}
\begin{sphinxuseclass}{sd-row-cols-lg-3}
\begin{sphinxuseclass}{sd-gx-3}
\begin{sphinxuseclass}{sd-gy-1}
\begin{sphinxuseclass}{sd-col}
\begin{sphinxuseclass}{sd-col-auto}
\begin{sphinxuseclass}{sd-d-flex-row}
\begin{sphinxuseclass}{sd-align-minor-center}
\sphinxAtStartPar
basics

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{sd-col}
\begin{sphinxuseclass}{sd-col-auto}
\begin{sphinxuseclass}{sd-d-flex-row}
\begin{sphinxuseclass}{sd-align-minor-center}
\sphinxAtStartPar
Apr 28, 2025

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\begin{sphinxuseclass}{sd-col}
\begin{sphinxuseclass}{sd-col-auto}
\begin{sphinxuseclass}{sd-d-flex-row}
\begin{sphinxuseclass}{sd-align-minor-center}
\sphinxAtStartPar
1 min read

\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}
\end{sphinxuseclass}

\chapter{Metodi numerici}
\label{\detokenize{ch/numerical-methods:metodi-numerici}}\label{\detokenize{ch/numerical-methods:classical-electromagnetism-numerics}}\label{\detokenize{ch/numerical-methods::doc}}

\section{Elettrostatica}
\label{\detokenize{ch/numerical-methods:elettrostatica}}
\sphinxAtStartPar
I problemi dell’elettrostatica sono governate dalle due equazioni di Maxwell per i campi \(\mathbf{e}\), \(\mathbf{d}\),
\begin{equation*}
\begin{split}\begin{cases}
  \nabla \cdot \mathbf{d} = \rho \\ \\
  \nabla \times \mathbf{e} = \mathbf{0 \ ,}
\end{cases}\end{split}
\end{equation*}
\sphinxAtStartPar
dotate delle opportune condizioni al contorno ed equazioni costitutive. Per un materiale lineare isotropo, ad esempio, \(\mathbf{d} = \varepsilon \mathbf{e}\). La condizione di irrotazionalità del campo elettrico, permette di scriverlo come gradiente di un potenziale scalare, \(\mathbf{e} = - \nabla v\), e di ottenere l’equazione di Poisson,
\begin{equation*}
\begin{split}-\nabla \cdot (\varepsilon \nabla v ) = \rho \ .\end{split}
\end{equation*}

\subsection{Sorgente}
\label{\detokenize{ch/numerical-methods:sorgente}}\begin{equation*}
\begin{split}\mathbf{e}(r) = \frac{q_i}{4 \pi \varepsilon}\frac{\mathbf{r} - \mathbf{r}_i}{|\mathbf{r} - \mathbf{r}_i|^3}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\mathbf{e}(\mathbf{r}) = - \nabla_{\mathbf{r}} v(\mathbf{r})\end{split}
\end{equation*}\begin{equation*}
\begin{split}\varepsilon \, v(\mathbf{r}) = \frac{q_i}{4 \pi}\frac{1}{|\mathbf{r} - \mathbf{r}_i|}\end{split}
\end{equation*}

\subsection{Dipolo}
\label{\detokenize{ch/numerical-methods:dipolo}}
\sphinxAtStartPar
Un dipolo è definito come due cariche di intensità uguale e contraria \(-q_2 = q_1 = q > 0\), nei punti dello spazio \(P_1\), \(P_2 = P_1 + \mathbf{l}\), nelle condizioni limite \(|\mathbf{l}| \rightarrow 0\), \(q \rightarrow \infty\), in modo tale da avere \(q |\mathbf{l}|\) finito, \(\mathbf{p} = q \mathbf{l}\).

\sphinxAtStartPar
Il potenziale del dipolo è dato dal principio di sovrapposizione delle cause e degli effetti,
\begin{equation*}
\begin{split}\begin{aligned}
  \varepsilon \, v(\mathbf{r})
  & = - \frac{q}{4 \pi }\frac{1}{\left|\mathbf{r} - \mathbf{r}_0 + \frac{\mathbf{l}}{2} \right|} 
      + \frac{q}{4 \pi }\frac{1}{\left|\mathbf{r} - \mathbf{r}_0 - \frac{\mathbf{l}}{2} \right|} = \\
  & = \ ... \\
  & = \frac{q}{4 \pi} \left( 
  - \frac{1}{\left|\mathbf{r} - \mathbf{r}_0 \right|} + \frac{\mathbf{r} - \mathbf{r}_0}{\left|\mathbf{r} - \mathbf{r}_0 \right|^3} \cdot \frac{\mathbf{l}}{2}
  + \frac{1}{\left|\mathbf{r} - \mathbf{r}_0 \right|} + \frac{\mathbf{r} - \mathbf{r}_0}{\left|\mathbf{r} - \mathbf{r}_0 \right|^3} \cdot \frac{\mathbf{l}}{2} + o(|\mathbf{l}|) \right) = \\
  & = \ ... \\
  & = \frac{1}{4 \pi}
 \frac{\mathbf{r} - \mathbf{r}_0}{\left|\mathbf{r} - \mathbf{r}_0 \right|^3} \cdot \mathbf{P} \ ,
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
avendo definito il vettore momento dipolo \(\mathbf{P} = q \mathbf{l}\).

\sphinxAtStartPar
\sphinxstylestrong{Polariazazione \sphinxhyphen{} Potenziale generato da una distribuzione di dipoli.}
\begin{equation*}
\begin{split}d \mathbf{P} = \mathbf{p} \, \Delta V\end{split}
\end{equation*}\begin{equation*}
\begin{split}\varepsilon v_P(\mathbf{r}) = \int_{\mathbf{r}_0 \in V_0} \frac{1}{4 \pi}
 \frac{\mathbf{r} - \mathbf{r}_0}{\left|\mathbf{r} - \mathbf{r}_0 \right|^3} \cdot \mathbf{p}(\mathbf{r}_0) \, dV_0 \end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
\partial_i |\mathbf{r}|^2 & = 2 x_i \\
                          & = 2 |\mathbf{r}| \partial_i |\mathbf{r}|
\end{aligned}
\qquad \rightarrow \qquad \partial_i |\mathbf{r}| = \frac{x_i}{|\mathbf{r}|}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\partial_i |\mathbf{r}|^n = n |\mathbf{r}|^{n-1} \, \partial_i |\mathbf{r}| = n x_i |\mathbf{r}|^{n-2}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\frac{\mathbf{r}-\mathbf{r}_0}{|\mathbf{r}-\mathbf{r}_0|^3} = \nabla_{\mathbf{r}_0} \frac{1}{|\mathbf{r}-\mathbf{r}_0|}\end{split}
\end{equation*}\begin{equation*}
\begin{split}\begin{aligned}
\frac{\mathbf{r}- \mathbf{r}_0}{|\mathbf{r}- \mathbf{r}_0|^3} \cdot \mathbf{p}(\mathbf{r}_0) 
 & = \nabla_{\mathbf{r}_0} \frac{1}{|\mathbf{r}-\mathbf{r}_0|} \cdot \mathbf{p}(\mathbf{r}_0) = \\
 & = \nabla_{\mathbf{r}_0} \cdot \left( \frac{1}{|\mathbf{r}-\mathbf{r}_0|} \mathbf{p}(\mathbf{r}_0) \right) - \frac{1}{|\mathbf{r}- \mathbf{r}_0|} \nabla_{\mathbf{r}_0} \cdot \mathbf{p}(\mathbf{r}_0) = \\
\end{aligned}\end{split}
\end{equation*}
\sphinxAtStartPar
e quindi
\begin{equation*}
\begin{split}4 \, \pi \, \varepsilon v_P(\mathbf{r}) = \oint_{\mathbf{r}_0 \in \partial V_0} \frac{\hat{\mathbf{n}}(\mathbf{r}_0) \cdot \mathbf{p}(\mathbf{r}_0)}{|\mathbf{r}-\mathbf{r}_0|} - \oint_{\mathbf{r}_0 \in V_0} \frac{\nabla_{\mathbf{r}_0} \cdot \mathbf{p}(\mathbf{r}_0)}{|\mathbf{r} - \mathbf{r}_0|}\end{split}
\end{equation*}
\sphinxAtStartPar
I due contributi hanno la forma di sorgenti, essendo termini proporzionali a \(\frac{1}{|\mathbf{r}-\mathbf{r}_0|}\).
Il potenziale dovuto alla densità di volume di dipoli equivale alla somma dei due contributi delle cariche di:
\begin{itemize}
\item {} 
\sphinxAtStartPar
polarizzazione di superficie \(\sigma_p =   \hat{\mathbf{n}} \cdot \mathbf{p}\)

\item {} 
\sphinxAtStartPar
polarizzazione di volume     \(\rho_p   = - \nabla \cdot \mathbf{p}\)

\end{itemize}

\sphinxAtStartPar
\sphinxstylestrong{Oss.} Se la polarizzazione è uniforme nel volume, il contributo della polarizzazione nel volume si annulla e rimane solo il contributo della polarizzazione sul contorno del volume.

\sphinxAtStartPar
\sphinxstylestrong{Oss.} Legge di Gauss per il campo elettrico,
\begin{equation*}
\begin{split}\begin{aligned}
  \nabla \cdot \mathbf{e} & = \frac{1}{\varepsilon_0} \rho = \\
                          & = \frac{1}{\varepsilon_0} \left( \rho_l + \rho_p \right) = \\
                          & = \frac{1}{\varepsilon_0} \left( \rho_l - \nabla \cdot \mathbf{p} \right) \\
  \nabla \cdot \left( \varepsilon_0 \mathbf{e} + \mathbf{p} \right) & = \rho_l \\
  \nabla \cdot  \mathbf{d} & = \rho_l
\end{aligned}\end{split}
\end{equation*}
\sphinxstepscope


\part{Appendices}

\sphinxstepscope




\chapter{todo: appendices}
\label{\detokenize{ch/appendix-list:todo-appendices}}\label{\detokenize{ch/appendix-list:classical-electromagnetism-appendices}}\label{\detokenize{ch/appendix-list::doc}}\begin{itemize}
\item {} 
\sphinxAtStartPar
Optics

\item {} 
\sphinxAtStartPar
Einstein’s relativity

\item {} 
\sphinxAtStartPar
Quantum

\item {} 
\sphinxAtStartPar
…

\end{itemize}






\renewcommand{\indexname}{Proof Index}
\begin{sphinxtheindex}
\let\bigletter\sphinxstyleindexlettergroup
\bigletter{example\sphinxhyphen{}0}
\item\relax\sphinxstyleindexentry{example\sphinxhyphen{}0}\sphinxstyleindexextra{ch/circuits\sphinxhyphen{}electromechanic}\sphinxstyleindexpageref{ch/circuits-electromechanic:\detokenize{example-0}}
\indexspace
\bigletter{harmonic:effective\sphinxhyphen{}values}
\item\relax\sphinxstyleindexentry{harmonic:effective\sphinxhyphen{}values}\sphinxstyleindexextra{ch/electrical\sphinxhyphen{}engineering\sphinxhyphen{}networks\sphinxhyphen{}harmonic}\sphinxstyleindexpageref{ch/electrical-engineering-networks-harmonic:\detokenize{harmonic:effective-values}}
\end{sphinxtheindex}

\renewcommand{\indexname}{Index}
\printindex
\end{document}